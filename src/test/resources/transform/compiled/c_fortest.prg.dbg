117	.$818	TSX
118	.$819	STX SP_SAVE
120	.$81c	PROGRAMSTART:
121	.$81c	JSR START
123	.$81f	LINE_0:
125	.$81f	JMP LINE_10
127	.$822	LINE_5:
129	.$822	LDA #0
130	.$824	STA A_REG
131	.$827	STA A_REG+1
132	.$82a	JSR NEXT
134	.$82d	LDA A_REG
135	.$830	BNE RBEQ_0
136	.$832	JMP (JUMP_TARGET)
138	.$835	RBEQ_0:
140	.$835	LINE_6:
142	.$835	LDA #<CONST_1R
143	.$837	LDY #>CONST_1R
144	.$839	JSR REALFAC
145	.$83c	LDA #<VAR_I
146	.$83e	LDY #>VAR_I
147	.$840	JSR CMPFAC
149	.$843	ROL
150	.$844	BCS GT_GT0
151	.$846	LDA #0
152	.$848	JMP GT_SKIP0
153	.$84b	GT_GT0:
154	.$84b	LDA #$1
155	.$84d	GT_SKIP0:
156	.$84d	COMP_SKP1:
157	.$84d	BEQ LINE_SKIP3
160	.$84f	LINE_NSKIP3:
162	.$84f	JSR END
163	.$852	RTS
165	.$853	LINE_SKIP3:
168	.$853	LINE_7:
170	.$853	LDX #4
171	.$855	dcloop567_1:
172	.$855	LDA VAR_K,X
173	.$858	STA VAR_I,X
174	.$85b	DEX
175	.$85c	BPL dcloop567_1
177	.$85e	JMP RETURN
179	.$861	LINE_10:
181	.$861	LDA #0
182	.$863	STA VAR_I
183	.$866	STA VAR_I+1
184	.$869	STA VAR_I+2
185	.$86c	STA VAR_I+3
186	.$86f	STA VAR_I+4
188	.$872	LDA #<CONST_2R
189	.$874	LDY #>CONST_2R
190	.$876	JSR REALFACPUSH
192	.$879	LDA #<CONST_3R
193	.$87b	LDY #>CONST_3R
194	.$87d	JSR REALFACPUSH
196	.$880	LDA #<VAR_I
197	.$882	LDY #>VAR_I
198	.$884	STA A_REG
199	.$887	STY A_REG+1
200	.$88a	LDA #<FORLOOP0
201	.$88c	STA JUMP_TARGET
202	.$88e	LDA #>FORLOOP0
203	.$890	STA JUMP_TARGET+1
204	.$892	JSR INITFOR
205	.$895	FORLOOP0:
207	.$895	LINE_20:
209	.$895	JSR ONETOFAC
211	.$898	LDA #<VAR_I
212	.$89a	LDY #>VAR_I
213	.$89c	JSR MEMARG
214	.$89f	JSR FASTAND
220	.$8a2	JSR NEG
222	.$8a5	LDX #<VAR_P
223	.$8a7	LDY #>VAR_P
225	.$8a9	JSR FACMEM
227	.$8ac	LINE_25:
229	.$8ac	LDA #<VAR_P
230	.$8ae	LDY #>VAR_P
231	.$8b0	JSR REALFAC
234	.$8b3	JSR FACNOT
235	.$8b6	JSR FACXREG
237	.$8b9	LDA X_REG
238	.$8bb	COMP_SKP2:
239	.$8bb	BEQ LINE_SKIP4
242	.$8bd	LINE_NSKIP4:
244	.$8bd	JMP LINE_100
246	.$8c0	LINE_SKIP4:
249	.$8c0	LINE_30:
251	.$8c0	JSR GOSUB
252	.$8c3	JSR LINE_90
254	.$8c6	LINE_40:
256	.$8c6	JMP LINE_5
258	.$8c9	LINE_90:
260	.$8c9	LDX #4
261	.$8cb	dcloop1397_1:
262	.$8cb	LDA VAR_I,X
263	.$8ce	STA VAR_K,X
264	.$8d1	DEX
265	.$8d2	BPL dcloop1397_1
267	.$8d4	LDA #<CONST_4R
268	.$8d6	LDY #>CONST_4R
269	.$8d8	JSR REALFAC
270	.$8db	LDA #<VAR_I
271	.$8dd	LDY #>VAR_I
272	.$8df	JSR FASTFADDMEM
277	.$8e2	JSR PUSHREAL
278	.$8e5	LDA #<CONST_3R
279	.$8e7	LDY #>CONST_3R
280	.$8e9	JSR REALFACPUSH
282	.$8ec	LDA #<VAR_K
283	.$8ee	LDY #>VAR_K
284	.$8f0	STA A_REG
285	.$8f3	STY A_REG+1
286	.$8f6	LDA #<FORLOOP1
287	.$8f8	STA JUMP_TARGET
288	.$8fa	LDA #>FORLOOP1
289	.$8fc	STA JUMP_TARGET+1
290	.$8fe	JSR INITFOR
291	.$901	FORLOOP1:
293	.$901	LINE_100:
295	.$901	LDA #<CONST_5
296	.$903	LDY #>CONST_5
297	.$905	JSR REALFAC
298	.$908	LDA #<VAR_I
299	.$90a	LDY #>VAR_I
300	.$90c	JSR FASTFADDMEM
305	.$90f	LDX #<VAR_J
306	.$911	LDY #>VAR_J
308	.$913	JSR FACMEM
309	.$916	LDA #<VAR_I
310	.$918	LDY #>VAR_I
311	.$91a	JSR COPY2_XYA_XREG
315	.$91d	JSR REALOUT
316	.$920	JSR CRSRRIGHT
317	.$923	JSR TABOUT
318	.$926	LDA #<VAR_J
319	.$928	LDY #>VAR_J
320	.$92a	JSR COPY2_XYA_XREG
324	.$92d	JSR REALOUTBRK
327	.$930	LINE_110:
329	.$930	LDA #<VAR_P
330	.$932	LDY #>VAR_P
331	.$934	JSR COPY2_XYA_YREG
335	.$937	LDA Y_REG
336	.$93a	COMP_SKP3:
337	.$93a	BNE LINE_NSKIP5
339	.$93c	JMP LINE_SKIP5
341	.$93f	LINE_NSKIP5:
344	.$93f	LDA #<CONST_6R
345	.$941	LDY #>CONST_6R
346	.$943	JSR REALFAC
347	.$946	LDA #<VAR_I
348	.$948	LDY #>VAR_I
349	.$94a	JSR FASTFADDMEM
354	.$94d	JSR PUSHREAL
355	.$950	LDA #<CONST_3R
356	.$952	LDY #>CONST_3R
357	.$954	JSR REALFACPUSH
359	.$957	LDA #<VAR_I
360	.$959	LDY #>VAR_I
361	.$95b	STA A_REG
362	.$95e	STY A_REG+1
363	.$961	LDA #<FORLOOP2
364	.$963	STA JUMP_TARGET
365	.$965	LDA #>FORLOOP2
366	.$967	STA JUMP_TARGET+1
367	.$969	JSR INITFOR
368	.$96c	FORLOOP2:
369	.$96c	LDA #<CONST_7
370	.$96e	LDY #>CONST_7
371	.$970	JSR STROUTWL
373	.$973	LDA #<VAR_I
374	.$975	LDY #>VAR_I
375	.$977	JSR COPY2_XYA_XREG
379	.$97a	JSR REALOUTBRK
382	.$97d	LINE_SKIP5:
385	.$97d	LINE_120:
387	.$97d	JMP LINE_40
388	.$980	JSR END
389	.$983	RTS
392	.$984	END   LDX SP_SAVE
393	.$987	TXS
400	.$988	RTS
403	.$989	START  LDA ENDSTRBUF+1
404	.$98c	BNE ENDGIVEN
405	.$98e	LDA BASICEND
406	.$990	STA ENDSTRBUF
407	.$993	LDA BASICEND+1
408	.$995	STA ENDSTRBUF+1
409	.$998	ENDGIVEN LDA #<FPSTACK
410	.$99a	LDY #>FPSTACK
411	.$99c	STA FPSTACKP
412	.$99f	STY FPSTACKP+1
413	.$9a2	LDA #<FORSTACK
414	.$9a4	LDY #>FORSTACK
415	.$9a6	STA FORSTACKP
416	.$9a9	STY FORSTACKP+1
417	.$9ac	LDA #<STRBUF
418	.$9ae	LDY #>STRBUF
419	.$9b0	STA STRBUFP
420	.$9b3	STY STRBUFP+1
421	.$9b6	STA HIGHP
422	.$9b9	STY HIGHP+1
423	.$9bc	LDA #0
424	.$9be	STA CHLOCKFLAG
425	.$9c1	STA LASTVAR
426	.$9c4	STA LASTVAR+1
427	.$9c7	JSR INITVARS
428	.$9ca	LDA #0
429	.$9cc	STA CMD_NUM
430	.$9cf	STA CHANNEL
431	.$9d2	TAY
432	.$9d3	TAX
436	.$9d4	STA KEYNDX
442	.$9d6	JSR RESTORE
443	.$9d9	CLC
447	.$9da	RTS
450	.$9db	INITNARRAY
451	.$9db	STA TMP_ZP
452	.$9dd	STY TMP_ZP+1
453	.$9df	LDY #0
454	.$9e1	TYA
455	.$9e2	NINITLOOP STA (TMP_ZP),Y
456	.$9e4	INC TMP_ZP
457	.$9e6	BNE NLOOPNOV
458	.$9e8	INC TMP_ZP+1
459	.$9ea	NLOOPNOV LDX TMP2_ZP
460	.$9ec	BNE NLOOPNOV2
461	.$9ee	DEC TMP2_ZP+1
462	.$9f0	NLOOPNOV2 DEC TMP2_ZP
463	.$9f2	BNE NINITLOOP
464	.$9f4	LDX TMP2_ZP+1
465	.$9f6	BNE NINITLOOP
466	.$9f8	RTS
469	.$9f9	INITSTRARRAY
470	.$9f9	STA TMP_ZP
471	.$9fb	STY TMP_ZP+1
472	.$9fd	SINITLOOP LDY #0
473	.$9ff	LDA #<EMPTYSTR
474	.$a01	STA (TMP_ZP),Y
475	.$a03	LDA #>EMPTYSTR
476	.$a05	INY
477	.$a06	STA (TMP_ZP),Y
478	.$a08	CLC
479	.$a09	LDA TMP_ZP
480	.$a0b	ADC #2
481	.$a0d	STA TMP_ZP
482	.$a0f	BCC SLOOPNOV1
483	.$a11	INC TMP_ZP+1
484	.$a13	SLOOPNOV1 SEC
485	.$a14	LDA TMP2_ZP
486	.$a16	SBC #2
487	.$a18	STA TMP2_ZP
488	.$a1a	BCS SLOOPNOV2
489	.$a1c	DEC TMP2_ZP+1
490	.$a1e	SLOOPNOV2 LDA TMP2_ZP
491	.$a20	BNE SINITLOOP
492	.$a22	LDA TMP2_ZP+1
493	.$a24	BNE SINITLOOP
494	.$a26	RTS
497	.$a27	INITSPARAMS STA TMP3_ZP
498	.$a29	STY TMP3_ZP+1
499	.$a2b	SEC
500	.$a2c	SBC #2
501	.$a2e	STA TMP_ZP
502	.$a30	TYA
503	.$a31	SBC #0
504	.$a33	STA TMP_ZP+1
505	.$a35	LDY #0
506	.$a37	LDA (TMP_ZP),Y
507	.$a39	STA TMP2_ZP
508	.$a3b	INY
509	.$a3c	LDA (TMP_ZP),Y
510	.$a3e	STA TMP2_ZP+1
511	.$a40	LDA TMP3_ZP
512	.$a42	LDY TMP3_ZP+1
513	.$a44	RTS
516	.$a45	INITSTRVARS LDA #<STRINGVARS_START  
517	.$a47	LDY #>STRINGVARS_START
518	.$a49	CMP #<STRINGVARS_END
519	.$a4b	BNE INITIT1
520	.$a4d	CPY #>STRINGVARS_END
521	.$a4f	BNE INITIT1
522	.$a51	JMP INITSA2     
523	.$a54	INITIT1  STA TMP_ZP
524	.$a56	STY TMP_ZP+1
525	.$a58	LDY #0
526	.$a5a	INITSTRLOOP LDA #<EMPTYSTR
527	.$a5c	STA (TMP_ZP),Y
528	.$a5e	INY
529	.$a5f	LDA #>EMPTYSTR
530	.$a61	STA (TMP_ZP),Y
531	.$a63	DEY
532	.$a64	LDA TMP_ZP
533	.$a66	CLC
534	.$a67	ADC #2
535	.$a69	STA TMP_ZP
536	.$a6b	LDA TMP_ZP+1
537	.$a6d	ADC #0
538	.$a6f	STA TMP_ZP+1
539	.$a71	CMP #>STRINGVARS_END
540	.$a73	BNE INITSTRLOOP
541	.$a75	LDA TMP_ZP
542	.$a77	CMP #<STRINGVARS_END
543	.$a79	BNE INITSTRLOOP
544	.$a7b	INITSA2  LDA #<STRINGARRAYS_START 
545	.$a7d	LDY #>STRINGARRAYS_START
546	.$a7f	CMP #<STRINGARRAYS_END
547	.$a81	BNE ARRAYLOOP
548	.$a83	CPY #>STRINGARRAYS_END
549	.$a85	BNE ARRAYLOOP
550	.$a87	RTS       
551	.$a88	ARRAYLOOP CLC
552	.$a89	ADC #3
553	.$a8b	BCC ARRAYSKIP1
554	.$a8d	INY
555	.$a8e	ARRAYSKIP1 CPY #>STRINGARRAYS_END
556	.$a90	BEQ ARRAYSC
557	.$a92	BCC ARRAYSKIP2
558	.$a94	JMP ARRAYQUIT
559	.$a97	ARRAYSC  CMP #<STRINGARRAYS_END
560	.$a99	BCS ARRAYQUIT
561	.$a9b	ARRAYSKIP2 STA TMP_REG
562	.$a9d	STY TMP_REG+1
563	.$a9f	JSR INITSPARAMS
564	.$aa2	LDA TMP_REG
565	.$aa4	LDY TMP_REG+1
566	.$aa6	JSR INITSTRARRAY
567	.$aa9	LDA TMP_ZP
568	.$aab	LDY TMP_ZP+1
569	.$aad	JMP ARRAYLOOP
570	.$ab0	ARRAYQUIT RTS
573	.$ab1	RESTORE  LDA #<DATAS
574	.$ab3	LDY #>DATAS
575	.$ab5	STA DATASP
576	.$ab8	STY DATASP+1
577	.$abb	RTS
580	.$abc	TABSPC     BCC DOSPC
581	.$abe	TXA
582	.$abf	SBC $09
583	.$ac1	BCC TABSPCQUIT
584	.$ac3	TAX
585	.$ac4	DOSPC  INX
586	.$ac5	TABSPCLOOP  DEX
587	.$ac6	BNE TABSPCRIGHT
588	.$ac8	TABSPCQUIT RTS
589	.$ac9	TABSPCRIGHT JSR CRSRRIGHT
590	.$acc	JMP TABSPCLOOP
593	.$acf	REROUTE  LDA CMD_NUM  
594	.$ad2	BEQ REROUTECMD
595	.$ad4	TAX
596	.$ad5	STA CHANNEL
597	.$ad8	JMP CHKOUT
598	.$adb	REROUTECMD RTS
601	.$adc	RESETROUTE LDA CMD_NUM  
602	.$adf	BEQ RESETROUTECMD
603	.$ae1	JMP CLRCHNEW
604	.$ae4	RESETROUTECMD
605	.$ae4	RTS
608	.$ae5	INTOUTFASTZ LDX #32    
609	.$ae7	LDA TMP_ZP+1
610	.$ae9	BPL INTISPOS
611	.$aeb	CLC
612	.$aec	LDA TMP_ZP
613	.$aee	EOR #$FF
614	.$af0	ADC #1
615	.$af2	STA TMP_ZP
616	.$af4	LDA TMP_ZP+1
617	.$af6	EOR #$FF
618	.$af8	ADC #0
619	.$afa	STA TMP_ZP+1
620	.$afc	LDX #45    
621	.$afe	INTISPOS
622	.$afe	TXA
623	.$aff	JSR CHROUT
624	.$b02	JSR CONVPOSINT
625	.$b05	LDA NUMFLAG
626	.$b08	BNE ALLINTOUTDONE
627	.$b0a	LDA #48
628	.$b0c	JSR CHROUT
629	.$b0f	ALLINTOUTDONE
630	.$b0f	RTS
633	.$b10	NUMBEROUT
634	.$b10	BEQ NUMZERO
635	.$b12	ORA #$30
636	.$b14	STA NUMFLAG
637	.$b17	JMP CHROUT
638	.$b1a	NUMZERO
639	.$b1a	LDX NUMFLAG
640	.$b1d	BEQ STILLZERO
641	.$b1f	ORA #$30
642	.$b21	JMP CHROUT
643	.$b24	STILLZERO
644	.$b24	RTS
647	.$b25	CONVPOSINT
648	.$b25	JSR INT2BCD
649	.$b28	LDX #0
650	.$b2a	STX NUMFLAG
651	.$b2d	AND #$0F
652	.$b2f	JSR NUMBEROUT
653	.$b32	LDA BCD+1
654	.$b35	LSR
655	.$b36	LSR
656	.$b37	LSR
657	.$b38	LSR
658	.$b39	JSR NUMBEROUT
659	.$b3c	LDA BCD+1
660	.$b3f	AND #$0F
661	.$b41	TAY
662	.$b42	JSR NUMBEROUT
663	.$b45	LDA BCD
664	.$b48	LSR
665	.$b49	LSR
666	.$b4a	LSR
667	.$b4b	LSR
668	.$b4c	JSR NUMBEROUT
669	.$b4f	LDA BCD
670	.$b52	AND #$0F
671	.$b54	JSR NUMBEROUT
672	.$b57	RTS
675	.$b58	INT2BCD
676	.$b58	SED
677	.$b59	LDA #0
678	.$b5b	STA BCD
679	.$b5e	STA BCD+1
680	.$b61	STA BCD+2
681	.$b64	ASL TMP_ZP
682	.$b66	ROL TMP_ZP+1
683	.$b68	LDA BCD
684	.$b6b	ADC BCD
685	.$b6e	STA BCD
686	.$b71	ASL TMP_ZP
687	.$b73	ROL TMP_ZP+1
688	.$b75	ADC BCD
689	.$b78	STA BCD
690	.$b7b	ASL TMP_ZP
691	.$b7d	ROL TMP_ZP+1
692	.$b7f	ADC BCD
693	.$b82	STA BCD
694	.$b85	ASL TMP_ZP
695	.$b87	ROL TMP_ZP+1
696	.$b89	ADC BCD
697	.$b8c	STA BCD
698	.$b8f	ASL TMP_ZP
699	.$b91	ROL TMP_ZP+1
700	.$b93	ADC BCD
701	.$b96	STA BCD
702	.$b99	ASL TMP_ZP
703	.$b9b	ROL TMP_ZP+1
704	.$b9d	ADC BCD
705	.$ba0	STA BCD
706	.$ba3	LDX #7
707	.$ba5	BCDBIT1
708	.$ba5	ASL TMP_ZP
709	.$ba7	ROL TMP_ZP+1
710	.$ba9	LDA BCD
711	.$bac	ADC BCD
712	.$baf	STA BCD
713	.$bb2	LDA BCD+1
714	.$bb5	ADC BCD+1
715	.$bb8	STA BCD+1
716	.$bbb	DEX
717	.$bbc	BNE BCDBIT1
718	.$bbe	LDX #3
719	.$bc0	BCDBIT2
720	.$bc0	ASL TMP_ZP
721	.$bc2	ROL TMP_ZP+1
722	.$bc4	LDA BCD
723	.$bc7	ADC BCD
724	.$bca	STA BCD
725	.$bcd	LDA BCD+1
726	.$bd0	ADC BCD+1
727	.$bd3	STA BCD+1
728	.$bd6	LDA BCD+2
729	.$bd9	ADC BCD+2
730	.$bdc	STA BCD+2
731	.$bdf	DEX
732	.$be0	BNE BCDBIT2
733	.$be2	CLD
734	.$be3	RTS
735	.$be4	BCD
736	.$be4	.WORD 0 0
737	.$be8	NUMFLAG
738	.$be8	.BYTE 0
741	.$be9	REALOUTFAST JSR FACINT
742	.$bec	STA TMP_ZP+1
743	.$bee	STY TMP_ZP
744	.$bf0	JMP INTOUTFASTZ
747	.$bf3	CHECKFORFASTOUT
748	.$bf3	JSR REROUTE
749	.$bf6	JSR XREGFAC
750	.$bf9	LDA FACEXP
751	.$bfb	CMP #$90
752	.$bfd	BCS REALOUTINT
753	.$bff	CMP #$81
754	.$c01	BCC REALOUTINT
755	.$c03	MAYBEREALOUTFAST
756	.$c03	LDA FACEXP+3
757	.$c05	BNE REALOUTINT
758	.$c07	LDA FACEXP+4
759	.$c09	BNE REALOUTINT
760	.$c0b	LDA FACEXP
761	.$c0d	SEC
762	.$c0e	SBC #129
763	.$c10	ASL
764	.$c11	TAX
765	.$c12	LDA FACEXP+1
766	.$c14	AND MANTMASK,X
767	.$c17	BNE REALOUTINT
768	.$c19	INX
769	.$c1a	LDA FACEXP+2
770	.$c1c	AND MANTMASK,X
771	.$c1f	BNE REALOUTINT
772	.$c21	JMP REALOUTFAST
773	.$c24	REALOUTINT LDY #0
774	.$c26	JSR FACSTR
775	.$c29	LDY #0
776	.$c2b	LDA LOFBUF,Y
777	.$c2e	STRLOOPRO JSR CHROUT
778	.$c31	INY
779	.$c32	LDA LOFBUF,Y
780	.$c35	BNE STRLOOPRO
781	.$c37	RTS
782	.$c38	MANTMASK
783	.$c38	.BYTE 127 255 63 255 31 255 15 255 7 255 3 255 1 255 0 255 0 127 0 63 0 31 0 15 0 7 0 3 0 1
786	.$c56	REALOUT  LDA X_REG
787	.$c58	BNE RNOTNULL
788	.$c5a	JMP PRINTNULL
789	.$c5d	RNOTNULL JSR CHECKFORFASTOUT
790	.$c60	JMP RESETROUTE
793	.$c63	REALOUTBRK  LDA X_REG
794	.$c65	BNE RNOTNULLBRK
795	.$c67	JMP PRINTNULLBRK
796	.$c6a	RNOTNULLBRK JSR CHECKFORFASTOUT
797	.$c6d	LDA #$0D
798	.$c6f	JSR CHROUT
799	.$c72	JMP RESETROUTE
802	.$c75	PRINTNULL JSR REROUTE
803	.$c78	LDA #$20
804	.$c7a	JSR CHROUT
805	.$c7d	LDA #$30
806	.$c7f	JSR CHROUT
807	.$c82	JMP RESETROUTE
810	.$c85	PRINTNULLBRK
811	.$c85	JSR REROUTE
812	.$c88	LDA #$20
813	.$c8a	JSR CHROUT
814	.$c8d	LDA #$30
815	.$c8f	JSR CHROUT
816	.$c92	LDA #$0D
817	.$c94	JSR CHROUT
818	.$c97	JMP RESETROUTE
821	.$c9a	STROUTWL STA A_REG
822	.$c9d	STY A_REG+1
823	.$ca0	STROUT  JSR REROUTE
824	.$ca3	LDA A_REG
825	.$ca6	STA INDEX1
826	.$ca8	LDA A_REG+1
827	.$cab	STA INDEX1+1
828	.$cad	LDY #0
829	.$caf	LDA (INDEX1),Y
830	.$cb1	TAX
831	.$cb2	INC INDEX1
832	.$cb4	BNE PRINTSTR
833	.$cb6	INC INDEX1+1
834	.$cb8	PRINTSTR JSR PRINTSTRS
835	.$cbb	LDA HIGHP   
836	.$cbe	STA STRBUFP
837	.$cc1	LDA HIGHP+1
838	.$cc4	STA STRBUFP+1
839	.$cc7	JSR RESETROUTE
840	.$cca	RTS
843	.$ccb	TABOUT  JSR REROUTE
844	.$cce	LDA CMD_NUM
845	.$cd1	BEQ NORMALTABOUT  
846	.$cd3	CMP #3
847	.$cd5	BEQ NORMALTABOUT2  
848	.$cd7	JMP TABOUTCHANNEL2
849	.$cda	NORMALTABOUT2
850	.$cda	JSR CLRCHNEW
851	.$cdd	NORMALTABOUT
852	.$cdd	SEC
853	.$cde	JSR CRSRPOS
854	.$ce1	TYA
855	.$ce2	SEC
856	.$ce3	TABSUB   SBC #$0A
857	.$ce5	BCS TABSUB
858	.$ce7	EOR #$FF
859	.$ce9	ADC #$01
860	.$ceb	TAX
861	.$cec	INX
862	.$ced	TABLOOP  DEX
863	.$cee	BNE TABRIGHT
864	.$cf0	RTS
865	.$cf1	TABRIGHT JSR CRSRRIGHT
866	.$cf4	JMP TABLOOP
869	.$cf7	ADJUSTSTACK LDA FORSTACKP 
870	.$cfa	STA TMP_ZP
871	.$cfc	LDA FORSTACKP+1
872	.$cff	STA TMP_ZP+1
873	.$d01	ADSEARCHFOR LDA TMP_ZP
874	.$d03	CMP #<FORSTACK
875	.$d05	BNE ADJUST2
876	.$d07	LDA TMP_ZP+1
877	.$d09	CMP #>FORSTACK
878	.$d0b	BNE ADJUST2
879	.$d0d	RTS    
880	.$d0e	ADJUST2  LDA TMP_ZP
881	.$d10	SEC
882	.$d11	SBC #2
883	.$d13	STA TMP_ZP
884	.$d15	BCS ADNOPV1N1
885	.$d17	DEC TMP_ZP+1
886	.$d19	ADNOPV1N1 LDY #0
887	.$d1b	LDA (TMP_ZP),Y
888	.$d1d	BNE ADNOGOSUB
889	.$d1f	RTS    
890	.$d20	ADNOGOSUB
891	.$d20	INY
892	.$d21	LDA TMP_ZP
893	.$d23	SEC
894	.$d24	SBC (TMP_ZP),Y
895	.$d26	STA TMP_ZP
896	.$d28	BCS ADNOPV1N2
897	.$d2a	DEC TMP_ZP+1
898	.$d2c	ADNOPV1N2 DEY
899	.$d2d	LDA A_REG
900	.$d30	ADCMPFOR CMP (TMP_ZP),Y
901	.$d32	BNE ADSEARCHFOR
902	.$d34	LDA A_REG+1
903	.$d37	INY
904	.$d38	CMP (TMP_ZP),Y
905	.$d3a	BEQ ADFOUNDFOR
906	.$d3c	JMP ADSEARCHFOR
907	.$d3f	ADLOW0  LDX A_REG+1
908	.$d42	BEQ ADFOUNDFOR
909	.$d44	BNE ADCMPFOR
910	.$d46	ADFOUNDFOR LDA TMP_ZP  
911	.$d48	STA FORSTACKP
912	.$d4b	LDA TMP_ZP+1
913	.$d4d	STA FORSTACKP+1
914	.$d50	RTS
917	.$d51	INITFOR  JSR ADJUSTSTACK
918	.$d54	LDA FORSTACKP
919	.$d57	STA TMP_ZP
920	.$d59	LDA FORSTACKP+1
921	.$d5c	STA TMP_ZP+1
922	.$d5e	LDY #0
923	.$d60	LDA A_REG
924	.$d63	STA (TMP_ZP),Y
925	.$d65	INY
926	.$d66	LDA A_REG+1
927	.$d69	STA (TMP_ZP),Y
928	.$d6b	INY
929	.$d6c	LDA JUMP_TARGET
930	.$d6e	STA (TMP_ZP),Y
931	.$d70	INY
932	.$d71	LDA JUMP_TARGET+1
933	.$d73	STA (TMP_ZP),Y
934	.$d75	INY
935	.$d76	STY TMP3_ZP
936	.$d78	JSR INCTMPZP
937	.$d7b	JSR POPREAL
938	.$d7e	LDX TMP_ZP
939	.$d80	LDY TMP_ZP+1
941	.$d82	JSR FACMEM
942	.$d85	JSR SGNFAC
943	.$d88	STA TMP_FLAG
944	.$d8b	LDY #5
945	.$d8d	STY TMP3_ZP
946	.$d8f	JSR INCTMPZP
947	.$d92	JSR POPREAL
948	.$d95	LDX TMP_ZP
949	.$d97	LDY TMP_ZP+1
951	.$d99	JSR FACMEM
952	.$d9c	LDY #5
953	.$d9e	STY TMP3_ZP
954	.$da0	JSR INCTMPZP
955	.$da3	LDY #0
956	.$da5	LDA TMP_FLAG
957	.$da8	STA (TMP_ZP),Y
958	.$daa	INY
959	.$dab	LDA #1
960	.$dad	STA (TMP_ZP),Y
961	.$daf	INY
962	.$db0	LDA #15
963	.$db2	STA (TMP_ZP),Y
964	.$db4	LDY #3
965	.$db6	STY TMP3_ZP
966	.$db8	JSR INCTMPZP
967	.$dbb	LDA TMP_ZP
968	.$dbd	STA FORSTACKP
969	.$dc0	LDA TMP_ZP+1
970	.$dc2	STA FORSTACKP+1
971	.$dc5	RTS
974	.$dc6	NEXT  LDA FORSTACKP
975	.$dc9	STA TMP_ZP
976	.$dcb	LDA FORSTACKP+1
977	.$dce	STA TMP_ZP+1
978	.$dd0	SEARCHFOR LDA TMP_ZP+1
979	.$dd2	STA TMP3_REG+1
980	.$dd5	LDA TMP_ZP
981	.$dd7	STA TMP3_REG
982	.$dda	SEC
983	.$ddb	SBC #2
984	.$ddd	STA TMP_ZP
985	.$ddf	BCS NOPV1N1
986	.$de1	DEC TMP_ZP+1
987	.$de3	NOPV1N1  LDY #0
988	.$de5	LDA (TMP_ZP),Y
989	.$de7	BNE NOGOSUB
990	.$de9	JMP NEXTWOFOR
991	.$dec	NOGOSUB
992	.$dec	INY
993	.$ded	LDA TMP_ZP
994	.$def	SEC
995	.$df0	SBC (TMP_ZP),Y
996	.$df2	STA TMP_ZP
997	.$df4	BCS NOPV1N2
998	.$df6	DEC TMP_ZP+1
999	.$df8	NOPV1N2  DEY
1000	.$df9	LDA A_REG
1001	.$dfc	BEQ LOW0
1002	.$dfe	CMPFOR  CMP (TMP_ZP),Y
1003	.$e00	BNE SEARCHFOR
1004	.$e02	LDA A_REG+1
1005	.$e05	INY
1006	.$e06	CMP (TMP_ZP),Y
1007	.$e08	BEQ FOUNDFOR
1008	.$e0a	JMP SEARCHFOR
1009	.$e0d	LOW0  LDX A_REG+1
1010	.$e10	BEQ FOUNDFOR
1011	.$e12	BNE CMPFOR
1012	.$e14	FOUNDFOR LDA TMP_ZP
1013	.$e16	STA TMP2_REG
1014	.$e19	LDA TMP_ZP+1
1015	.$e1b	STA TMP2_REG+1
1016	.$e1e	VARREAL
1017	.$e1e	LDY #0
1018	.$e20	STY A_REG+1 
1019	.$e23	LDA (TMP_ZP),Y
1020	.$e25	TAX
1021	.$e26	INY
1022	.$e27	LDA (TMP_ZP),Y
1023	.$e29	TAY
1024	.$e2a	TXA
1025	.$e2b	JSR REALFAC
1026	.$e2e	CALCNEXT LDA TMP_ZP
1027	.$e30	CLC
1028	.$e31	ADC #4
1029	.$e33	STA TMP_ZP
1030	.$e35	BCC NOPV2IN
1031	.$e37	INC TMP_ZP+1
1032	.$e39	NOPV2IN  STA TMP_REG
1033	.$e3b	LDY TMP_ZP+1
1034	.$e3d	STY TMP_REG+1
1035	.$e3f	JSR FASTFADDMEM
1037	.$e42	LDA TMP2_REG
1038	.$e45	STA TMP_ZP
1039	.$e47	LDA TMP2_REG+1
1040	.$e4a	STA TMP_ZP+1
1041	.$e4c	STOREREAL
1042	.$e4c	LDY #0
1043	.$e4e	LDA (TMP_ZP),Y
1044	.$e50	TAX
1045	.$e51	INY
1046	.$e52	LDA (TMP_ZP),Y
1047	.$e54	TAY
1048	.$e55	JSR FACMEM 
1049	.$e58	CMPFORXX LDA #5
1050	.$e5a	STA TMP3_ZP
1051	.$e5c	LDA TMP_REG
1052	.$e5e	CLC
1053	.$e5f	ADC #5
1054	.$e61	STA TMP_REG
1055	.$e63	BCC NOPV3
1056	.$e65	INC TMP_REG+1
1057	.$e67	NOPV3  LDY TMP_REG+1
1058	.$e69	JSR CMPFAC  
1059	.$e6c	BEQ LOOPING
1060	.$e6e	PHA
1061	.$e6f	LDY #14
1062	.$e71	LDA (TMP_ZP),Y
1063	.$e73	BEQ STEPZERO
1064	.$e75	ROL
1065	.$e76	BCC STEPPOS
1066	.$e78	STEPNEG  PLA
1067	.$e79	ROL
1068	.$e7a	BCC LOOPING
1069	.$e7c	BCS EXITLOOP
1070	.$e7e	STEPPOS  PLA
1071	.$e7f	ROL
1072	.$e80	BCC EXITLOOP
1073	.$e82	LOOPING  LDA TMP3_REG
1074	.$e85	STA FORSTACKP
1075	.$e88	LDA TMP3_REG+1
1076	.$e8b	STA FORSTACKP+1
1077	.$e8e	LDA TMP2_REG
1078	.$e91	CLC
1079	.$e92	ADC #2
1080	.$e94	STA TMP2_REG
1081	.$e97	BCC NOPV4IN
1082	.$e99	INC TMP2_REG+1
1083	.$e9c	NOPV4IN  LDY #0
1084	.$e9e	STY A_REG
1085	.$ea1	STA TMP_ZP
1086	.$ea3	LDA TMP2_REG+1
1087	.$ea6	STA TMP_ZP+1
1088	.$ea8	LDA (TMP_ZP),Y
1089	.$eaa	STA JUMP_TARGET
1090	.$eac	INY
1091	.$ead	LDA (TMP_ZP),Y
1092	.$eaf	STA JUMP_TARGET+1
1093	.$eb1	RTS
1094	.$eb2	STEPZERO PLA
1095	.$eb3	JMP LOOPING
1096	.$eb6	EXITLOOP LDA TMP2_REG
1097	.$eb9	STA FORSTACKP
1098	.$ebc	LDA TMP2_REG+1
1099	.$ebf	STA FORSTACKP+1
1100	.$ec2	LDA #1
1101	.$ec4	STA A_REG
1102	.$ec7	RTS
1105	.$ec8	RETURN  LDA FORSTACKP
1106	.$ecb	STA TMP_ZP
1107	.$ecd	LDA FORSTACKP+1
1108	.$ed0	STA TMP_ZP+1
1109	.$ed2	SEARCHGOSUB LDA TMP_ZP
1110	.$ed4	SEC
1111	.$ed5	SBC #2
1112	.$ed7	STA TMP_ZP
1113	.$ed9	BCS NOPV1SG
1114	.$edb	DEC TMP_ZP+1
1115	.$edd	NOPV1SG  LDY #0
1116	.$edf	LDA (TMP_ZP),Y
1117	.$ee1	BEQ FOUNDGOSUB
1118	.$ee3	INY
1119	.$ee4	LDA (TMP_ZP),Y
1120	.$ee6	STA TMP3_ZP
1121	.$ee8	LDA TMP_ZP
1122	.$eea	SEC
1123	.$eeb	SBC (TMP_ZP),Y
1124	.$eed	STA TMP_ZP
1125	.$eef	BCS NOPV1GS
1126	.$ef1	DEC TMP_ZP+1
1127	.$ef3	NOPV1GS  JMP SEARCHGOSUB
1128	.$ef6	FOUNDGOSUB
1129	.$ef6	LDA TMP_ZP
1130	.$ef8	STA FORSTACKP
1131	.$efb	LDA TMP_ZP+1
1132	.$efd	STA FORSTACKP+1
1133	.$f00	RTS
1136	.$f01	GOSUB  LDA FORSTACKP
1137	.$f04	STA TMP_ZP
1138	.$f06	LDA FORSTACKP+1
1139	.$f09	STA TMP_ZP+1
1140	.$f0b	LDY #0
1141	.$f0d	TYA
1142	.$f0e	STA (TMP_ZP),Y
1143	.$f10	INY
1144	.$f11	STA (TMP_ZP),Y
1145	.$f13	INY
1146	.$f14	TYA
1147	.$f15	CLC
1148	.$f16	ADC TMP_ZP
1149	.$f18	STA FORSTACKP
1150	.$f1b	BCC GOSUBNOOV
1151	.$f1d	INC FORSTACKP+1
1152	.$f20	GOSUBNOOV RTS
1155	.$f21	REALFACPUSH STA TMP_ZP
1156	.$f23	STY TMP_ZP+1
1157	.$f25	LDX FPSTACKP
1158	.$f28	LDY FPSTACKP+1
1159	.$f2b	STX TMP2_ZP
1160	.$f2d	STY TMP2_ZP+1
1161	.$f2f	LDY #0
1162	.$f31	LDA (TMP_ZP),Y
1163	.$f33	STA (TMP2_ZP),Y
1164	.$f35	INY
1165	.$f36	LDA (TMP_ZP),Y
1166	.$f38	STA (TMP2_ZP),Y
1167	.$f3a	INY
1168	.$f3b	LDA (TMP_ZP),Y
1169	.$f3d	STA (TMP2_ZP),Y
1170	.$f3f	INY
1171	.$f40	LDA (TMP_ZP),Y
1172	.$f42	STA (TMP2_ZP),Y
1173	.$f44	INY
1174	.$f45	LDA (TMP_ZP),Y
1175	.$f47	STA (TMP2_ZP),Y
1176	.$f49	TXA    
1177	.$f4a	CLC
1178	.$f4b	ADC #5
1179	.$f4d	STA FPSTACKP
1180	.$f50	BCC NOPVRFPXX
1181	.$f52	INC FPSTACKP+1
1182	.$f55	NOPVRFPXX RTS
1185	.$f56	PUSHREAL LDX FPSTACKP
1186	.$f59	LDY FPSTACKP+1
1187	.$f5c	JSR FACMEM
1188	.$f5f	LDA FPSTACKP
1189	.$f62	CLC
1190	.$f63	ADC #5
1191	.$f65	STA FPSTACKP
1192	.$f68	BCC NOPVPUR
1193	.$f6a	INC FPSTACKP+1
1194	.$f6d	NOPVPUR  RTS
1197	.$f6e	POPREAL  LDA FPSTACKP
1198	.$f71	SEC
1199	.$f72	SBC #5
1200	.$f74	STA FPSTACKP
1201	.$f77	BCS NOPVPR
1202	.$f79	DEC FPSTACKP+1
1203	.$f7c	NOPVPR  LDA FPSTACKP
1204	.$f7f	LDY FPSTACKP+1
1205	.$f82	JMP REALFAC
1208	.$f85	NEG   LDA FACSGN
1209	.$f87	EOR #$FF
1210	.$f89	STA FACSGN
1211	.$f8b	RTS
1214	.$f8c	INCTMPZP LDA TMP_ZP
1215	.$f8e	CLC
1216	.$f8f	ADC TMP3_ZP
1217	.$f91	STA TMP_ZP
1218	.$f93	BCC NOPV2
1219	.$f95	INC TMP_ZP+1
1220	.$f97	NOPV2  RTS
1223	.$f98	COPY2_XYA_XREG
1224	.$f98	STA TMP3_ZP
1225	.$f9a	STY TMP3_ZP+1
1226	.$f9c	COPY2_XY_XREG
1227	.$f9c	LDX #<X_REG  
1228	.$f9e	LDY #0
1229	.$fa0	LDA (TMP3_ZP),Y
1230	.$fa2	STA X_REG
1231	.$fa4	INY
1232	.$fa5	LDA (TMP3_ZP),Y
1233	.$fa7	STA X_REG+1
1234	.$fa9	INY
1235	.$faa	LDA (TMP3_ZP),Y
1236	.$fac	STA X_REG+2
1237	.$fae	INY
1238	.$faf	LDA (TMP3_ZP),Y
1239	.$fb1	STA X_REG+3
1240	.$fb3	INY
1241	.$fb4	LDA (TMP3_ZP),Y
1242	.$fb6	STA X_REG+4
1243	.$fb8	RTS
1246	.$fb9	COPY2_XYA_YREG
1247	.$fb9	STA TMP3_ZP
1248	.$fbb	STY TMP3_ZP+1
1249	.$fbd	COPY2_XY_YREG
1250	.$fbd	LDX #<Y_REG  
1251	.$fbf	LDY #0
1252	.$fc1	LDA (TMP3_ZP),Y
1253	.$fc3	STA Y_REG
1254	.$fc6	INY
1255	.$fc7	LDA (TMP3_ZP),Y
1256	.$fc9	STA Y_REG+1
1257	.$fcc	INY
1258	.$fcd	LDA (TMP3_ZP),Y
1259	.$fcf	STA Y_REG+2
1260	.$fd2	INY
1261	.$fd3	LDA (TMP3_ZP),Y
1262	.$fd5	STA Y_REG+3
1263	.$fd8	INY
1264	.$fd9	LDA (TMP3_ZP),Y
1265	.$fdb	STA Y_REG+4
1266	.$fde	RTS
1270	.$fdf	FACWORD
1271	.$fdf	LDA FACEXP   
1272	.$fe1	BNE DOFACWORD
1273	.$fe3	STA FACSGN   
1274	.$fe5	DOFACWORD:
1275	.$fe5	JMP XFACWORD
1279	.$fe8	ONETOFAC    LDX #129
1280	.$fea	STX FAC
1281	.$fec	DEX
1282	.$fed	STX FAC+1
1283	.$fef	LDX #0
1284	.$ff1	STX FAC+2
1285	.$ff3	STX FAC+3
1286	.$ff5	STX FAC+4
1287	.$ff7	STX FAC+5
1288	.$ff9	STX FAC+15
1289	.$ffb	RTS
1292	.$ffc	FASTAND  LDA ARGEXP   
1293	.$ffe	BNE CHECKFAC
1294	.$1000	STA FACSGN   
1295	.$1002	STA FACLO
1296	.$1004	STA FACMO
1297	.$1006	STA FACMOH
1298	.$1008	STA FACHO
1299	.$100a	STA FACEXP
1300	.$100c	RTS
1301	.$100d	CHECKFAC LDA FACEXP   
1302	.$100f	BNE FACNOTNULL
1303	.$1011	STA FACSGN   
1304	.$1013	RTS    
1305	.$1014	FACNOTNULL CMP #$81
1306	.$1016	BNE NORMALAND
1307	.$1018	LDA FACHO
1308	.$101a	CMP #$80
1309	.$101c	BNE NORMALAND
1310	.$101e	LDA FACMOH
1311	.$1020	BNE NORMALAND
1312	.$1022	LDA FACMO
1313	.$1024	BNE NORMALAND
1314	.$1026	LDA FACLO
1315	.$1028	BNE NORMALAND
1316	.$102a	LDA FACSGN
1317	.$102c	ROL
1318	.$102d	BCC NORMALAND
1319	.$102f	LDA ARGEXP   
1320	.$1031	CMP #$81
1321	.$1033	BNE NORMALAND
1322	.$1035	LDA ARGHO
1323	.$1037	CMP #$80
1324	.$1039	BNE NORMALAND
1325	.$103b	LDA ARGMOH
1326	.$103d	BNE NORMALAND
1327	.$103f	LDA ARGMO
1328	.$1041	BNE NORMALAND
1329	.$1043	LDA ARGLO
1330	.$1045	BNE NORMALAND
1331	.$1047	LDA ARGSGN
1332	.$1049	ROL
1333	.$104a	BCC NORMALAND
1334	.$104c	RTS    
1335	.$104d	NORMALAND JMP ARGAND
1338	.$1050	INITOUTCHANNEL
1339	.$1050	LDA CHLOCKFLAG
1340	.$1053	BEQ INITOUT2
1341	.$1055	CMP #$FF
1342	.$1057	BNE SKIPINITCH
1343	.$1059	INITOUT2
1344	.$1059	LDA #<C_REG
1345	.$105b	LDY #>C_REG
1346	.$105d	JSR REALFAC
1347	.$1060	JSR FACWORD
1348	.$1063	TYA
1349	.$1064	TAX
1350	.$1065	CPX CMD_NUM
1351	.$1068	BNE CMDNEQUAL
1352	.$106a	LDY #0
1353	.$106c	STY CMD_NUM   
1354	.$106f	CMDNEQUAL STA CHANNEL
1355	.$1072	STA CHLOCKFLAG
1356	.$1075	JMP CHKOUT
1357	.$1078	SKIPINITCH
1358	.$1078	RTS
1361	.$1079	CLRCHNEW
1362	.$1079	LDA CHLOCKFLAG
1363	.$107c	BNE SKIPCLRCH
1364	.$107e	JMP CLRCH
1365	.$1081	SKIPCLRCH
1366	.$1081	RTS
1369	.$1082	TABOUTCHANNEL
1370	.$1082	JSR INITOUTCHANNEL
1371	.$1085	LDA CHANNEL
1372	.$1088	CMP #3  
1373	.$108a	BEQ TABOUTSCREEN
1374	.$108c	TABOUTCHANNEL2
1375	.$108c	LDA IOCHANNEL
1376	.$108e	STA STORE1
1377	.$1091	LDA #1
1378	.$1093	STA IOCHANNEL  
1379	.$1095	LDX #10
1380	.$1097	JMP EXITCHANNEL
1381	.$109a	TABOUTSCREEN
1382	.$109a	JSR CLRCHNEW
1383	.$109d	JMP TABOUT
1386	.$10a0	EXITCHANNEL CLC
1387	.$10a1	JSR TABSPC
1388	.$10a4	JSR CLRCHNEW
1389	.$10a7	LDA STORE1
1390	.$10aa	STA IOCHANNEL
1391	.$10ac	RTS
1394	.$10ad	NEXTWOFOR
1398	.$10ad	LDX #$0A
1399	.$10af	JMP ERRALL
1402	.$10b2	ILLEGALQUANTITY
1406	.$10b2	JMP ERRIQ
1409	.$10b5	FACXREG  LDA FACLO
1410	.$10b7	STA X_REG+4
1411	.$10b9	LDA FACMO
1412	.$10bb	STA X_REG+3
1413	.$10bd	LDA FACMOH
1414	.$10bf	STA X_REG+2
1415	.$10c1	LDA FACSGN
1416	.$10c3	ORA #$7F
1417	.$10c5	AND FACHO
1418	.$10c7	STA X_REG+1
1419	.$10c9	LDA FACEXP
1420	.$10cb	STA X_REG
1421	.$10cd	LDA #0   
1422	.$10cf	STA FACOV
1423	.$10d1	RTS
1426	.$10d2	XREGFAC  LDA X_REG+4
1427	.$10d4	STA FACLO
1428	.$10d6	LDA X_REG+3
1429	.$10d8	STA FACMO
1430	.$10da	LDA X_REG+2
1431	.$10dc	STA FACMOH
1432	.$10de	LDA X_REG+1
1433	.$10e0	STA FACSGN
1434	.$10e2	ORA #$80
1435	.$10e4	STA FACHO
1436	.$10e6	LDA X_REG
1437	.$10e8	STA FACEXP
1438	.$10ea	LDA #0
1439	.$10ec	STA FACOV
1440	.$10ee	RTS
1554	.$10ef	FASTFADDMEM
1555	.$10ef	JSR MEMARG
1556	.$10f2	FASTFADDARG
1557	.$10f2	BNE FADDRET2     
1558	.$10f4	JMP ARGFAC
1559	.$10f7	FADDRET2 LDA ARGEXP
1560	.$10f9	BNE FADDRET1     
1561	.$10fb	RTS
1562	.$10fc	FADDRET1 SEC
1563	.$10fd	SBC FACEXP
1564	.$10ff	BEQ FFADD_EXPEQ     
1565	.$1101	BCC FFADD_SHFARG1   
1569	.$1103	LDY ARGEXP
1570	.$1105	STY FACEXP
1571	.$1107	LDY ARGSGN
1572	.$1109	STY FACSGN
1573	.$110b	LDX #0
1574	.$110d	STX OLDOV        
1575	.$110f	LDX #FAC         
1577	.$1111	SEC
1578	.$1112	SBC #$08
1579	.$1114	BMI FFADD_SHFFAC2
1581	.$1116	FFADD_SHFFAC1
1582	.$1116	LDY FACLO        
1583	.$1118	STY FACOV
1584	.$111a	LDY FACMO        
1585	.$111c	STY FACMO+1
1586	.$111e	LDY FACMOH       
1587	.$1120	STY FACMOH+1
1588	.$1122	LDY FACHO        
1589	.$1124	STY FACHO+1
1590	.$1126	LDY #0
1591	.$1128	STY FACHO        
1592	.$112a	SBC #$08         
1593	.$112c	BPL FFADD_SHFFAC1   
1594	.$112e	FFADD_SHFFAC2
1595	.$112e	ADC #$08         
1596	.$1130	BEQ FFADD_SHFFAC4   
1597	.$1132	TAY
1598	.$1133	LDA FACOV
1599	.$1135	FFADD_SHFFAC3
1600	.$1135	LSR FACHO        
1601	.$1137	ROR FACMOH       
1602	.$1139	ROR FACMO        
1603	.$113b	ROR FACLO        
1604	.$113d	ROR              
1605	.$113e	DEY
1606	.$113f	BNE FFADD_SHFFAC3
1607	.$1141	JMP FFADD_MANADD2   
1608	.$1144	FFADD_SHFFAC4
1609	.$1144	LDA FACOV        
1610	.$1146	JMP FFADD_MANADD2
1611	.$1149	FFADD_EXPEQ
1612	.$1149	LDX FACOV
1613	.$114b	STX OLDOV
1616	.$114d	JMP FFADD_MANADD1
1617	.$1150	FFADD_SHFARG2
1618	.$1150	LDA FACOV        
1619	.$1152	JMP FFADD_MANADD1
1620	.$1155	FFADD_SHFARG1
1621	.$1155	LDX FACOV
1622	.$1157	STX OLDOV        
1623	.$1159	LDX #$00         
1626	.$115b	ADC #$08
1627	.$115d	BPL FFADD_SHFARG6   
1628	.$115f	FFADD_SHFARG3
1629	.$115f	LDX ARGLO        
1630	.$1161	LDY ARGMO        
1631	.$1163	STY ARGMO+1
1632	.$1165	LDY ARGMOH       
1633	.$1167	STY ARGMOH+1
1634	.$1169	LDY ARGHO        
1635	.$116b	STY ARGHO+1
1636	.$116d	LDY #0
1637	.$116f	STY ARGHO        
1638	.$1171	FFADD_SHFARG4
1639	.$1171	ADC #$08
1640	.$1173	BMI FFADD_SHFARG3
1641	.$1175	BEQ FFADD_SHFARG3
1642	.$1177	FFADD_SHFARG6
1643	.$1177	SBC #$08
1644	.$1179	BEQ FFADD_SHFARG2   
1645	.$117b	TAY
1646	.$117c	TXA              
1647	.$117d	FFADD_SHFARG5
1648	.$117d	LSR ARGHO
1649	.$117f	ROR ARGMOH
1650	.$1181	ROR ARGMO
1651	.$1183	ROR ARGLO
1652	.$1185	ROR           
1653	.$1186	INY
1654	.$1187	BNE FFADD_SHFARG5
1655	.$1189	FFADD_MANADD1
1656	.$1189	LDX #ARGEXP      
1657	.$118b	FFADD_MANADD2
1658	.$118b	BIT ARISGN
1659	.$118d	BMI FFADD_MANSUB1   
1660	.$118f	CLC
1661	.$1190	ADC OLDOV
1662	.$1192	STA FACOV
1663	.$1194	LDA FACLO
1664	.$1196	ADC ARGLO
1665	.$1198	STA FACLO
1666	.$119a	LDA FACMO
1667	.$119c	ADC ARGMO
1668	.$119e	STA FACMO
1669	.$11a0	LDA FACMOH
1670	.$11a2	ADC ARGMOH
1671	.$11a4	STA FACMOH
1672	.$11a6	LDA FACHO
1673	.$11a8	ADC ARGHO
1674	.$11aa	STA FACHO
1675	.$11ac	BCC FFADD_RNDRTS
1676	.$11ae	INC FACEXP
1677	.$11b0	BEQ FFADD_OVERR
1679	.$11b2	ROR FACHO
1680	.$11b4	ROR FACMOH
1681	.$11b6	ROR FACMO
1682	.$11b8	ROR FACLO
1683	.$11ba	ROR FACOV
1684	.$11bc	FFADD_RNDRTS
1685	.$11bc	RTS
1686	.$11bd	FFADD_OVERR
1687	.$11bd	JMP ILLEGALQUANTITY
1688	.$11c0	FFADD_MANSUB1
1689	.$11c0	LDY #FACEXP
1690	.$11c2	CPX #ARGEXP
1691	.$11c4	BEQ FFADD_MANSUB2
1692	.$11c6	LDY #ARGEXP
1693	.$11c8	FFADD_MANSUB2
1694	.$11c8	SEC              
1695	.$11c9	EOR #$FF
1696	.$11cb	ADC OLDOV
1697	.$11cd	STA FACOV
1698	.$11cf	LDA 4,Y
1699	.$11d2	SBC 4,X
1700	.$11d4	STA FACLO
1701	.$11d6	LDA 3,Y
1702	.$11d9	SBC 3,X
1703	.$11db	STA FACMO
1704	.$11dd	LDA 2,Y
1705	.$11e0	SBC 2,X
1706	.$11e2	STA FACMOH
1707	.$11e4	LDA 1,Y
1708	.$11e7	SBC 1,X
1709	.$11e9	STA FACHO
1710	.$11eb	BCS FCNORMAL
1711	.$11ed	LDA FACSGN
1712	.$11ef	EOR #$FF
1713	.$11f1	STA FACSGN
1714	.$11f3	LDA FACHO
1715	.$11f5	EOR #$FF
1716	.$11f7	STA FACHO
1717	.$11f9	LDA FACMOH
1718	.$11fb	EOR #$FF
1719	.$11fd	STA FACMOH
1720	.$11ff	LDA FACMO
1721	.$1201	EOR #$FF
1722	.$1203	STA FACMO
1723	.$1205	LDA FACLO
1724	.$1207	EOR #$FF
1725	.$1209	STA FACLO
1726	.$120b	LDA FACOV
1727	.$120d	EOR #$FF
1728	.$120f	CLC
1729	.$1210	ADC #1
1730	.$1212	STA FACOV
1731	.$1214	BNE FCNORMAL
1732	.$1216	INC FACLO
1733	.$1218	BNE FCNORMAL
1734	.$121a	INC FACMO
1735	.$121c	BNE FCNORMAL
1736	.$121e	INC FACMOH
1737	.$1220	BNE FCNORMAL
1738	.$1222	INC FACHO
1739	.$1224	FCNORMAL   BIT FACHO
1740	.$1226	BMI FFADD_RET       
1741	.$1228	LDA #0           
1742	.$122a	CLC
1743	.$122b	FFADD_NORM3
1744	.$122b	LDX FACHO
1745	.$122d	BNE FFADD_NORM1
1746	.$122f	LDX FACHO+1
1747	.$1231	STX FACHO
1748	.$1233	LDX FACMOH+1
1749	.$1235	STX FACMOH
1750	.$1237	LDX FACMO+1
1751	.$1239	STX FACMO
1752	.$123b	LDX FACOV
1753	.$123d	STX FACLO
1754	.$123f	LDX #0
1755	.$1241	STX FACOV
1756	.$1243	ADC #$08
1757	.$1245	CMP #$20
1758	.$1247	BNE FFADD_NORM3
1759	.$1249	JMP FFADD_ZEROFAC
1760	.$124c	FFADD_NORM2
1761	.$124c	CLC
1762	.$124d	ADC #1
1763	.$124f	ASL FACOV
1764	.$1251	ROL FACLO
1765	.$1253	ROL FACMO
1766	.$1255	ROL FACMOH
1767	.$1257	ROL FACHO
1768	.$1259	FFADD_NORM1
1769	.$1259	BPL FFADD_NORM2     
1770	.$125b	SEC
1771	.$125c	SBC FACEXP
1772	.$125e	BCS FFADD_ZEROFAC
1773	.$1260	EOR #$FF
1774	.$1262	CLC
1775	.$1263	ADC #1
1776	.$1265	STA FACEXP
1777	.$1267	FFADD_RET   RTS
1778	.$1268	FFADD_ZEROFAC
1779	.$1268	LDX #0
1780	.$126a	STX FACEXP
1781	.$126c	STX FACSGN
1782	.$126e	RTS
1785	.$126f	INITVARS
1786	.$126f	JSR INITSTRVARS
1787	.$1272	LDA #0
1788	.$1274	LDY #4
1789	.$1276	REALINITLOOP0:
1790	.$1276	STA VAR_I,Y
1791	.$1279	STA VAR_K,Y
1792	.$127c	STA VAR_P,Y
1793	.$127f	STA VAR_J,Y
1794	.$1282	DEY
1795	.$1283	BMI REALLOOPEXIT0
1796	.$1285	JMP REALINITLOOP0
1797	.$1288	REALLOOPEXIT0:
1798	.$1288	RTS
1802	.$1289	CONSTANTS
1808	.$1289	CONST_1R .REAL 12.0
1811	.$128e	CONST_2R .REAL 11.0
1814	.$1293	CONST_3R .REAL 1.0
1817	.$1298	CONST_4R .REAL 10.0
1820	.$129d	CONST_5 .REAL 99.9
1823	.$12a2	CONST_6R .REAL 2.0
1825	.$12a7	CONST_7 .BYTE 2
1826	.$12a8	.STRG ">>"
1829	.$12aa	DATAS
1830	.$12aa	.BYTE $FF
1832	.$12ab	CONSTANTS_END
1835	.$12ab	VARIABLES
1837	.$12ab	VAR_I .REAL 0.0
1839	.$12b0	VAR_K .REAL 0.0
1841	.$12b5	VAR_P .REAL 0.0
1843	.$12ba	VAR_J .REAL 0.0
1844	.$12bf	STRINGVARS_START
1846	.$12bf	VAR_TI$ .WORD EMPTYSTR
1847	.$12c1	STRINGVARS_END
1848	.$12c1	STRINGARRAYS_START
1849	.$12c1	STRINGARRAYS_END
1850	.$12c1	VARIABLES_END
1852	.$12c1	Y_REG .REAL 0.0
1853	.$12c6	C_REG .REAL 0.0
1854	.$12cb	D_REG .REAL 0.0
1855	.$12d0	E_REG .REAL 0.0
1856	.$12d5	F_REG .REAL 0.0
1857	.$12da	A_REG .WORD 0
1858	.$12dc	B_REG .WORD 0
1859	.$12de	CMD_NUM .BYTE 0
1860	.$12df	CHANNEL .BYTE 0
1861	.$12e0	SP_SAVE .BYTE 0
1862	.$12e1	TMP2_REG .WORD 0
1863	.$12e3	TMP3_REG .WORD 0
1864	.$12e5	TMP4_REG .WORD 0
1865	.$12e7	AS_TMP .WORD 0
1866	.$12e9	BPOINTER_TMP .WORD 0
1867	.$12eb	BASICTEXTP .BYTE 0
1868	.$12ec	STORE1 .WORD 0
1869	.$12ee	STORE2 .WORD 0
1870	.$12f0	STORE3 .WORD 0
1871	.$12f2	STORE4 .WORD 0
1872	.$12f4	GCSTART .WORD 0
1873	.$12f6	GCLEN .WORD 0
1874	.$12f8	GCWORK .WORD 0
1875	.$12fa	INPUTLENGTH .BYTE 0
1876	.$12fb	TMP_FREG .REAL 0
1877	.$1300	TMP2_FREG .REAL 0
1878	.$1305	TMP_FLAG .BYTE 0
1879	.$1306	INT_FLAG .BYTE 0
1880	.$1307	REAL_CONST_ONE .REAL 1.0
1881	.$130c	REAL_CONST_ZERO .REAL 0.0
1882	.$1311	REAL_CONST_MINUS_ONE .REAL -1.0
1883	.$1316	CHLOCKFLAG .BYTE 0
1884	.$1317	EMPTYSTR .BYTE 0
1885	.$1318	FPSTACKP .WORD FPSTACK
1886	.$131a	FORSTACKP .WORD FORSTACK
1887	.$131c	DATASP .WORD DATAS
1888	.$131e	LASTVAR .WORD 0
1889	.$1320	LASTVARP .WORD 0
1890	.$1322	HIGHP .WORD STRBUF
1891	.$1324	STRBUFP .WORD STRBUF
1892	.$1326	ENDSTRBUF .WORD 0
1893	.$1328	INPUTQUEUEP .BYTE 0
1894	.$1329	PROGRAMEND
1895	.$1329	INPUTQUEUE .ARRAY $0F
1896	.$1338	FPSTACK .ARRAY 100
1897	.$139c	FORSTACK .ARRAY 340
1898	.$14f0	STRBUF .BYTE 0

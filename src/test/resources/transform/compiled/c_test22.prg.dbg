117	.$818	TSX
118	.$819	STX SP_SAVE
120	.$81c	PROGRAMSTART:
121	.$81c	JSR START
123	.$81f	LINE_0:
126	.$81f	LINE_10:
128	.$81f	INPUT2:
129	.$81f	JSR CLEARQUEUE
130	.$822	JSR COMPACTMAX
131	.$825	LDA #<CONST_0
132	.$827	LDY #>CONST_0
133	.$829	JSR STROUTWL
135	.$82c	JSR QMARKOUT1
136	.$82f	JSR INPUTSTR
137	.$832	JSR INPUTLENGTHCHECK
138	.$835	BEQ EMPTYINPUTSKIP5
139	.$837	LDA A_REG
140	.$83a	LDY A_REG+1
141	.$83d	STA TMP_ZP
142	.$83f	STY TMP_ZP+1
143	.$841	LDA #<VAR_A$
144	.$843	LDY #>VAR_A$
145	.$845	JSR COPYSTRING
146	.$848	EMPTYINPUTSKIP5:
147	.$848	JSR QUEUESIZE
148	.$84b	LDA X_REG
149	.$84d	COMP_SKP0:
150	.$84d	BNE QINPUT2_1
152	.$84f	JSR QMARKOUT2
153	.$852	QINPUT2_1:
154	.$852	JSR INPUTSTR
155	.$855	JSR INPUTLENGTHCHECK
156	.$858	BEQ EMPTYINPUTSKIP6
157	.$85a	LDA A_REG
158	.$85d	LDY A_REG+1
159	.$860	STA TMP_ZP
160	.$862	STY TMP_ZP+1
161	.$864	LDA #<VAR_B$
162	.$866	LDY #>VAR_B$
163	.$868	JSR COPYSTRING
164	.$86b	EMPTYINPUTSKIP6:
165	.$86b	JSR QUEUESIZE
166	.$86e	LDA X_REG
167	.$870	COMP_SKP1:
168	.$870	BNE QINPUT2_2
170	.$872	JSR QMARKOUT2
171	.$875	QINPUT2_2:
172	.$875	JSR INPUTNUMBER
173	.$878	LDA X_REG
174	.$87a	COMP_SKP2:
175	.$87a	BEQ INPUT2_2
177	.$87c	LDA #<CONST_2
178	.$87e	LDY #>CONST_2
179	.$880	JSR STROUTBRKWL
182	.$883	JMP INPUT2
183	.$886	INPUT2_2:
184	.$886	JSR INPUTLENGTHCHECK
185	.$889	BEQ EMPTYINPUTSKIP7
186	.$88b	JSR YREGFAC
188	.$88e	LDX #<VAR_K
189	.$890	LDY #>VAR_K
191	.$892	JSR FACMEM
192	.$895	EMPTYINPUTSKIP7:
193	.$895	JSR QUEUESIZE
194	.$898	LDA X_REG
195	.$89a	COMP_SKP3:
196	.$89a	BEQ INPUTCHECK2
198	.$89c	JSR EXTRAIGNORED
199	.$89f	INPUTCHECK2:
201	.$89f	LINE_20:
203	.$89f	LDA #<CONST_3
204	.$8a1	LDY #>CONST_3
205	.$8a3	JSR STROUTWL
207	.$8a6	JSR TABOUT
208	.$8a9	LDA VAR_A$
209	.$8ac	LDY VAR_A$+1
210	.$8af	JSR STROUTWL
212	.$8b2	JSR TABOUT
213	.$8b5	LDA VAR_B$
214	.$8b8	LDY VAR_B$+1
215	.$8bb	JSR STROUTWL
217	.$8be	JSR TABOUT
218	.$8c1	LDA #<VAR_K
219	.$8c3	LDY #>VAR_K
220	.$8c5	JSR COPY2_XYA_XREG
224	.$8c8	JSR REALOUTBRK
227	.$8cb	LINE_30:
229	.$8cb	INPUT3:
230	.$8cb	JSR CLEARQUEUE
231	.$8ce	JSR COMPACTMAX
232	.$8d1	LDA #<CONST_4
233	.$8d3	LDY #>CONST_4
234	.$8d5	JSR STROUTWL
236	.$8d8	JSR QMARKOUT1
237	.$8db	JSR INPUTNUMBER
238	.$8de	LDA X_REG
239	.$8e0	COMP_SKP4:
240	.$8e0	BEQ INPUT3_0
242	.$8e2	LDA #<CONST_2
243	.$8e4	LDY #>CONST_2
244	.$8e6	JSR STROUTBRKWL
247	.$8e9	JMP INPUT3
248	.$8ec	INPUT3_0:
249	.$8ec	JSR INPUTLENGTHCHECK
250	.$8ef	BEQ EMPTYINPUTSKIP8
251	.$8f1	JSR YREGFAC
253	.$8f4	LDX #<VAR_F
254	.$8f6	LDY #>VAR_F
256	.$8f8	JSR FACMEM
257	.$8fb	EMPTYINPUTSKIP8:
258	.$8fb	JSR QUEUESIZE
259	.$8fe	LDA X_REG
260	.$900	COMP_SKP5:
261	.$900	BEQ INPUTCHECK3
263	.$902	JSR EXTRAIGNORED
264	.$905	INPUTCHECK3:
266	.$905	LINE_40:
268	.$905	LDA #<CONST_5
269	.$907	LDY #>CONST_5
270	.$909	JSR STROUTWL
272	.$90c	JSR TABOUT
273	.$90f	LDA #<VAR_F
274	.$911	LDY #>VAR_F
275	.$913	JSR COPY2_XYA_XREG
279	.$916	JSR REALOUTBRK
281	.$919	JSR END
282	.$91c	RTS
285	.$91d	END   LDX SP_SAVE
286	.$920	TXS
293	.$921	RTS
296	.$922	START  LDA ENDSTRBUF+1
297	.$925	BNE ENDGIVEN
298	.$927	LDA BASICEND
299	.$929	STA ENDSTRBUF
300	.$92c	LDA BASICEND+1
301	.$92e	STA ENDSTRBUF+1
302	.$931	ENDGIVEN LDA #<FPSTACK
303	.$933	LDY #>FPSTACK
304	.$935	STA FPSTACKP
305	.$938	STY FPSTACKP+1
306	.$93b	LDA #<FORSTACK
307	.$93d	LDY #>FORSTACK
308	.$93f	STA FORSTACKP
309	.$942	STY FORSTACKP+1
310	.$945	LDA #<STRBUF
311	.$947	LDY #>STRBUF
312	.$949	STA STRBUFP
313	.$94c	STY STRBUFP+1
314	.$94f	STA HIGHP
315	.$952	STY HIGHP+1
316	.$955	LDA #0
317	.$957	STA CHLOCKFLAG
318	.$95a	STA LASTVAR
319	.$95d	STA LASTVAR+1
320	.$960	JSR INITVARS
321	.$963	LDA #0
322	.$965	STA CMD_NUM
323	.$968	STA CHANNEL
324	.$96b	TAY
325	.$96c	TAX
329	.$96d	STA KEYNDX
335	.$96f	JSR RESTORE
336	.$972	CLC
340	.$973	RTS
343	.$974	INITNARRAY
344	.$974	STA TMP_ZP
345	.$976	STY TMP_ZP+1
346	.$978	LDY #0
347	.$97a	TYA
348	.$97b	NINITLOOP STA (TMP_ZP),Y
349	.$97d	INC TMP_ZP
350	.$97f	BNE NLOOPNOV
351	.$981	INC TMP_ZP+1
352	.$983	NLOOPNOV LDX TMP2_ZP
353	.$985	BNE NLOOPNOV2
354	.$987	DEC TMP2_ZP+1
355	.$989	NLOOPNOV2 DEC TMP2_ZP
356	.$98b	BNE NINITLOOP
357	.$98d	LDX TMP2_ZP+1
358	.$98f	BNE NINITLOOP
359	.$991	RTS
362	.$992	INITSTRARRAY
363	.$992	STA TMP_ZP
364	.$994	STY TMP_ZP+1
365	.$996	SINITLOOP LDY #0
366	.$998	LDA #<EMPTYSTR
367	.$99a	STA (TMP_ZP),Y
368	.$99c	LDA #>EMPTYSTR
369	.$99e	INY
370	.$99f	STA (TMP_ZP),Y
371	.$9a1	CLC
372	.$9a2	LDA TMP_ZP
373	.$9a4	ADC #2
374	.$9a6	STA TMP_ZP
375	.$9a8	BCC SLOOPNOV1
376	.$9aa	INC TMP_ZP+1
377	.$9ac	SLOOPNOV1 SEC
378	.$9ad	LDA TMP2_ZP
379	.$9af	SBC #2
380	.$9b1	STA TMP2_ZP
381	.$9b3	BCS SLOOPNOV2
382	.$9b5	DEC TMP2_ZP+1
383	.$9b7	SLOOPNOV2 LDA TMP2_ZP
384	.$9b9	BNE SINITLOOP
385	.$9bb	LDA TMP2_ZP+1
386	.$9bd	BNE SINITLOOP
387	.$9bf	RTS
390	.$9c0	INITSPARAMS STA TMP3_ZP
391	.$9c2	STY TMP3_ZP+1
392	.$9c4	SEC
393	.$9c5	SBC #2
394	.$9c7	STA TMP_ZP
395	.$9c9	TYA
396	.$9ca	SBC #0
397	.$9cc	STA TMP_ZP+1
398	.$9ce	LDY #0
399	.$9d0	LDA (TMP_ZP),Y
400	.$9d2	STA TMP2_ZP
401	.$9d4	INY
402	.$9d5	LDA (TMP_ZP),Y
403	.$9d7	STA TMP2_ZP+1
404	.$9d9	LDA TMP3_ZP
405	.$9db	LDY TMP3_ZP+1
406	.$9dd	RTS
409	.$9de	INITSTRVARS LDA #<STRINGVARS_START  
410	.$9e0	LDY #>STRINGVARS_START
411	.$9e2	CMP #<STRINGVARS_END
412	.$9e4	BNE INITIT1
413	.$9e6	CPY #>STRINGVARS_END
414	.$9e8	BNE INITIT1
415	.$9ea	JMP INITSA2     
416	.$9ed	INITIT1  STA TMP_ZP
417	.$9ef	STY TMP_ZP+1
418	.$9f1	LDY #0
419	.$9f3	INITSTRLOOP LDA #<EMPTYSTR
420	.$9f5	STA (TMP_ZP),Y
421	.$9f7	INY
422	.$9f8	LDA #>EMPTYSTR
423	.$9fa	STA (TMP_ZP),Y
424	.$9fc	DEY
425	.$9fd	LDA TMP_ZP
426	.$9ff	CLC
427	.$a00	ADC #2
428	.$a02	STA TMP_ZP
429	.$a04	LDA TMP_ZP+1
430	.$a06	ADC #0
431	.$a08	STA TMP_ZP+1
432	.$a0a	CMP #>STRINGVARS_END
433	.$a0c	BNE INITSTRLOOP
434	.$a0e	LDA TMP_ZP
435	.$a10	CMP #<STRINGVARS_END
436	.$a12	BNE INITSTRLOOP
437	.$a14	INITSA2  LDA #<STRINGARRAYS_START 
438	.$a16	LDY #>STRINGARRAYS_START
439	.$a18	CMP #<STRINGARRAYS_END
440	.$a1a	BNE ARRAYLOOP
441	.$a1c	CPY #>STRINGARRAYS_END
442	.$a1e	BNE ARRAYLOOP
443	.$a20	RTS       
444	.$a21	ARRAYLOOP CLC
445	.$a22	ADC #3
446	.$a24	BCC ARRAYSKIP1
447	.$a26	INY
448	.$a27	ARRAYSKIP1 CPY #>STRINGARRAYS_END
449	.$a29	BEQ ARRAYSC
450	.$a2b	BCC ARRAYSKIP2
451	.$a2d	JMP ARRAYQUIT
452	.$a30	ARRAYSC  CMP #<STRINGARRAYS_END
453	.$a32	BCS ARRAYQUIT
454	.$a34	ARRAYSKIP2 STA TMP_REG
455	.$a36	STY TMP_REG+1
456	.$a38	JSR INITSPARAMS
457	.$a3b	LDA TMP_REG
458	.$a3d	LDY TMP_REG+1
459	.$a3f	JSR INITSTRARRAY
460	.$a42	LDA TMP_ZP
461	.$a44	LDY TMP_ZP+1
462	.$a46	JMP ARRAYLOOP
463	.$a49	ARRAYQUIT RTS
466	.$a4a	RESTORE  LDA #<DATAS
467	.$a4c	LDY #>DATAS
468	.$a4e	STA DATASP
469	.$a51	STY DATASP+1
470	.$a54	RTS
473	.$a55	TABSPC     BCC DOSPC
474	.$a57	TXA
475	.$a58	SBC $09
476	.$a5a	BCC TABSPCQUIT
477	.$a5c	TAX
478	.$a5d	DOSPC  INX
479	.$a5e	TABSPCLOOP  DEX
480	.$a5f	BNE TABSPCRIGHT
481	.$a61	TABSPCQUIT RTS
482	.$a62	TABSPCRIGHT JSR CRSRRIGHT
483	.$a65	JMP TABSPCLOOP
486	.$a68	SAVEPOINTERS
487	.$a68	LDA TMP_ZP   
488	.$a6a	STA STORE1
489	.$a6d	LDA TMP_ZP+1
490	.$a6f	STA STORE1+1
491	.$a72	LDA TMP2_ZP
492	.$a74	STA STORE2
493	.$a77	LDA TMP2_ZP+1
494	.$a79	STA STORE2+1
495	.$a7c	LDA TMP3_ZP
496	.$a7e	STA STORE3
497	.$a81	LDA TMP3_ZP+1
498	.$a83	STA STORE3+1
499	.$a86	RTS
502	.$a87	RESTOREPOINTERS
503	.$a87	LDA STORE3+1  
504	.$a8a	STA TMP3_ZP+1
505	.$a8c	LDA STORE3
506	.$a8f	STA TMP3_ZP
507	.$a91	LDA STORE2+1
508	.$a94	STA TMP2_ZP+1
509	.$a96	LDA STORE2
510	.$a99	STA TMP2_ZP
511	.$a9b	LDA STORE1+1
512	.$a9e	STA TMP_ZP+1
513	.$aa0	LDA STORE1
514	.$aa3	STA TMP_ZP
515	.$aa5	RTS
522	.$aa6	COMPACTMAX
523	.$aa6	LDA #$FF
524	.$aa8	LDY #$0
525	.$aaa	JMP COMPACTF
528	.$aad	COMPACT
529	.$aad	LDY #0
530	.$aaf	GCBUFNE  LDA (TMP_ZP),Y  
531	.$ab1	COMPACTF STA TMP4_REG  
532	.$ab4	LDY STRBUFP+1  
533	.$ab7	STY TMP4_REG+1  
534	.$aba	INY     
535	.$abb	BEQ ENDMEM   
536	.$abd	CPY ENDSTRBUF+1  
537	.$ac0	BCC RGCEXIT   
538	.$ac2	ENDMEM  LDA STRBUFP
539	.$ac5	CLC
540	.$ac6	ADC TMP4_REG
541	.$ac9	STA TMP4_REG
542	.$acc	BCC RGCNOOV1
543	.$ace	INC TMP4_REG+1
544	.$ad1	RGCNOOV1 CLC
545	.$ad2	LDA TMP4_REG
546	.$ad5	ADC #3
547	.$ad7	STA TMP4_REG
548	.$ada	BCC RGCNOOV2
549	.$adc	INC TMP4_REG+1
550	.$adf	RGCNOOV2 LDA TMP4_REG+1  
551	.$ae2	CMP ENDSTRBUF+1
552	.$ae5	BEQ RGCLOW1
553	.$ae7	BCS GCEXECOMP  
554	.$ae9	JMP RGCEXIT
555	.$aec	RGCLOW1  LDA TMP4_REG
556	.$aef	CMP ENDSTRBUF
557	.$af2	BCS GCEXECOMP  
558	.$af4	RGCEXIT  RTS     
559	.$af5	GCEXECOMP LDA STRBUFP
560	.$af8	STA STORE4
561	.$afb	LDA STRBUFP+1
562	.$afe	STA STORE4+1
563	.$b01	JSR GCEXE
564	.$b04	JMP CHECKMEMORY
567	.$b07	GCEXE  JSR SAVEPOINTERS
568	.$b0a	LDA #0
569	.$b0c	STA LASTVAR
570	.$b0f	STA LASTVAR+1  
571	.$b12	LDA #<STRBUF
572	.$b14	STA TMP_ZP
573	.$b16	STA GCSTART
574	.$b19	LDA #>STRBUF
575	.$b1b	STA TMP_ZP+1  
576	.$b1d	STA GCSTART+1
577	.$b20	GCLOOP  LDY #0
578	.$b22	LDA TMP_ZP
579	.$b24	STA GCWORK
580	.$b27	LDA TMP_ZP+1
581	.$b29	STA GCWORK+1  
582	.$b2c	LDA (TMP_ZP),Y
583	.$b2e	STA GCLEN   
584	.$b31	INC TMP_ZP
585	.$b33	BNE GCLOOPNOOV
586	.$b35	INC TMP_ZP+1
587	.$b37	GCLOOPNOOV LDA TMP_ZP
588	.$b39	CLC
589	.$b3a	ADC GCLEN
590	.$b3d	STA TMP_ZP
591	.$b3f	BCC GCLOOPNOOV2
592	.$b41	INC TMP_ZP+1  
593	.$b43	GCLOOPNOOV2 LDY #0
594	.$b45	LDA (TMP_ZP),Y
595	.$b47	STA TMP2_ZP
596	.$b49	INY
597	.$b4a	LDA (TMP_ZP),Y
598	.$b4c	STA TMP2_ZP+1  
599	.$b4e	LDA TMP_ZP
600	.$b50	CLC
601	.$b51	ADC #2
602	.$b53	STA TMP_ZP
603	.$b55	BCC GCLOOPNOOV3
604	.$b57	INC TMP_ZP+1  
605	.$b59	GCLOOPNOOV3 LDY #0
606	.$b5b	LDA (TMP2_ZP),Y
607	.$b5d	CMP GCWORK
608	.$b60	BNE GCKLOOP
609	.$b62	INY
610	.$b63	LDA (TMP2_ZP),Y
611	.$b65	CMP GCWORK+1
612	.$b68	BEQ MEMFREE
613	.$b6a	GCKLOOP  LDA TMP_ZP+1  
614	.$b6c	CMP HIGHP+1
615	.$b6f	BEQ GCHECKLOW
616	.$b71	BCC GCLOOP
617	.$b73	JMP GCDONE
618	.$b76	GCHECKLOW LDA TMP_ZP
619	.$b78	CMP HIGHP
620	.$b7b	BCS GCDONE
621	.$b7d	JMP GCLOOP
622	.$b80	MEMFREE  LDA GCSTART   
623	.$b83	CMP GCWORK   
624	.$b86	BNE COPYDOWN
625	.$b88	LDA GCSTART+1
626	.$b8b	CMP GCWORK+1
627	.$b8e	BNE COPYDOWN
628	.$b90	LDA TMP_ZP   
629	.$b92	STA GCSTART
630	.$b95	LDA TMP_ZP+1
631	.$b97	STA GCSTART+1
632	.$b9a	JMP GCKLOOP   
633	.$b9d	COPYDOWN LDA GCSTART   
634	.$ba0	STA TMP_REG
635	.$ba2	LDA GCSTART+1
636	.$ba5	STA TMP_REG+1  
637	.$ba7	LDA GCWORK
638	.$baa	STA TMP2_REG
639	.$bad	LDA GCWORK+1
640	.$bb0	STA TMP2_REG+1  
641	.$bb3	LDA TMP_ZP
642	.$bb5	SEC
643	.$bb6	SBC GCWORK
644	.$bb9	STA TMP3_REG
645	.$bbc	LDA TMP_ZP+1
646	.$bbe	SBC GCWORK+1
647	.$bc1	STA TMP3_REG+1  
648	.$bc4	LDA GCSTART
649	.$bc7	CLC
650	.$bc8	ADC TMP3_REG
651	.$bcb	STA GCSTART
652	.$bce	LDA GCSTART+1
653	.$bd1	ADC TMP3_REG+1
654	.$bd4	STA GCSTART+1  
655	.$bd7	JSR QUICKCOPY  
656	.$bda	LDY #0
657	.$bdc	LDA TMP_REG
658	.$bde	STA (TMP2_ZP),Y
659	.$be0	INY
660	.$be1	LDA TMP_REG+1
661	.$be3	STA (TMP2_ZP),Y  
662	.$be5	JMP GCKLOOP
663	.$be8	GCDONE  LDA GCSTART
664	.$beb	STA HIGHP
665	.$bee	STA STRBUFP
666	.$bf1	LDA GCSTART+1
667	.$bf4	STA HIGHP+1
668	.$bf7	STA STRBUFP+1  
669	.$bfa	GCSKIP  JSR RESTOREPOINTERS
670	.$bfd	RTS     
673	.$bfe	CHECKMEMORY
674	.$bfe	LDA STRBUFP+1  
675	.$c01	CMP STORE4+1  
676	.$c04	BCC STILLFITSCM  
680	.$c06	BEQ CHECKMEMLOWCM
681	.$c08	JMP OUTOFMEMORY  
682	.$c0b	CHECKMEMLOWCM
683	.$c0b	LDA STRBUFP   
684	.$c0e	CMP STORE4
685	.$c11	BCC STILLFITSCM
686	.$c13	JMP OUTOFMEMORY  
687	.$c16	STILLFITSCM RTS
690	.$c17	QUICKCOPY LDA TMP_REG  
691	.$c19	STA TMEM+1
692	.$c1c	LDA TMP_REG+1
693	.$c1e	STA TMEM+2
694	.$c21	LDA TMP2_REG
695	.$c24	STA SMEM+1
696	.$c27	LDA TMP2_REG+1
697	.$c2a	STA SMEM+2
698	.$c2d	LDY #$0
699	.$c2f	LDX TMP3_REG
700	.$c32	BNE QCLOOP
701	.$c34	LDA TMP3_REG+1
702	.$c37	BEQ QCEXIT  
703	.$c39	QCLOOP
704	.$c39	SMEM  LDA $0000,Y
705	.$c3c	TMEM  STA $0000,Y
706	.$c3f	INY
707	.$c40	BNE YNOOV
708	.$c42	INC TMEM+2
709	.$c45	INC SMEM+2
710	.$c48	YNOOV  DEX
711	.$c49	BNE QCLOOP
712	.$c4b	LDA TMP3_REG+1
713	.$c4e	BEQ QCEXIT
714	.$c50	DEC TMP3_REG+1
715	.$c53	JMP QCLOOP
716	.$c56	QCEXIT  RTS
719	.$c57	COPYSTRING STA TMP2_ZP
720	.$c59	STY TMP2_ZP+1
721	.$c5b	CPY TMP_ZP+1
722	.$c5d	BNE CONTCOPY
723	.$c5f	LDA TMP2_ZP
724	.$c61	CMP TMP_ZP
725	.$c63	BNE CONTCOPY
726	.$c65	RTS     
727	.$c66	CONTCOPY JSR COMPACT   
728	.$c69	LDY #0
729	.$c6b	STY TMP_FLAG
730	.$c6e	LDA (TMP_ZP),Y
731	.$c70	BNE NOTEMPTYSTR
732	.$c72	LDA #<EMPTYSTR  
733	.$c74	STA TMP_ZP
734	.$c76	LDA #>EMPTYSTR
735	.$c78	STA TMP_ZP+1
736	.$c7a	JMP ISCONST
737	.$c7d	NOTEMPTYSTR TAX     
738	.$c7e	LDA (TMP2_ZP),Y
739	.$c80	STA TMP3_ZP
740	.$c82	INY
741	.$c83	LDA (TMP2_ZP),Y
742	.$c85	STA TMP3_ZP+1
743	.$c87	DEY
744	.$c88	LDA TMP_ZP+1  
745	.$c8a	CMP #>CONSTANTS_END
746	.$c8c	BEQ CHECKLOW1
747	.$c8e	BCS INVAR
748	.$c90	JMP CHECKNEXT
749	.$c93	CHECKLOW1 LDA TMP_ZP
750	.$c95	CMP #<CONSTANTS_END
751	.$c97	BCS INVAR
752	.$c99	CHECKNEXT LDA TMP_ZP+1  
753	.$c9b	CMP #>CONSTANTS
754	.$c9d	BEQ CHECKLOW3
755	.$c9f	BCC INVAR
756	.$ca1	JMP ISCONST
757	.$ca4	CHECKLOW3 LDA TMP_ZP
758	.$ca6	CMP #<CONSTANTS
759	.$ca8	BCC INVAR   
760	.$caa	ISCONST  JSR CHECKLASTVAR 
761	.$cad	LDA TMP_ZP
762	.$caf	STA (TMP2_ZP),Y  
763	.$cb1	INY
764	.$cb2	LDA TMP_ZP+1
765	.$cb4	STA (TMP2_ZP),Y
766	.$cb6	LDA HIGHP   
767	.$cb9	STA STRBUFP
768	.$cbc	LDA HIGHP+1
769	.$cbf	STA STRBUFP+1
770	.$cc2	RTS
771	.$cc3	INVAR  INY
772	.$cc4	LDA (TMP2_ZP),Y  
773	.$cc6	CMP #>CONSTANTS_END
774	.$cc8	BEQ CHECKLOW2
775	.$cca	BCS INVAR2
776	.$ccc	JMP PUPDATEPTR
777	.$ccf	CHECKLOW2 DEY
778	.$cd0	LDA (TMP2_ZP),Y
779	.$cd2	CMP #<CONSTANTS_END
780	.$cd4	BCS INVAR2
781	.$cd6	JMP PUPDATEPTR
782	.$cd9	INVAR2  LDY #0   
783	.$cdb	LDA (TMP3_ZP),Y
784	.$cdd	STA TMP_REG
785	.$cdf	TXA
786	.$ce0	CMP TMP_REG  
787	.$ce2	BEQ UPDATEHP2 
790	.$ce4	PUPDATEPTR JSR CHECKLASTVAR
791	.$ce7	LDY #1   
792	.$ce9	STY TMP_FLAG 
793	.$cec	JMP UPDATEPTR 
794	.$cef	UPDATEHP2 LDA HIGHP  
795	.$cf2	STA STRBUFP
796	.$cf5	LDA HIGHP+1
797	.$cf8	STA STRBUFP+1
798	.$cfb	JMP STRFITS
799	.$cfe	COPYONLY LDY #0
800	.$d00	STY TMP_FLAG
801	.$d03	JMP CHECKMEM
802	.$d06	ALTCOPY  JMP COPYSTRING2
803	.$d09	UPDATEPTR LDA TMP_ZP+1 
804	.$d0b	CMP HIGHP+1  
805	.$d0e	BEQ CHECKXT1
806	.$d10	BCS ALTCOPY
807	.$d12	JMP CHECKMEM
808	.$d15	CHECKXT1 LDA TMP_ZP
809	.$d17	CMP HIGHP
810	.$d1a	BCS ALTCOPY
811	.$d1c	CHECKMEM
812	.$d1c	MEMOK  LDY #0
813	.$d1e	LDA STRBUFP  
814	.$d21	STA (TMP2_ZP),Y 
815	.$d23	STA TMP3_ZP
816	.$d25	LDA STRBUFP+1
817	.$d28	INY
818	.$d29	STA (TMP2_ZP),Y
819	.$d2b	STA TMP3_ZP+1
820	.$d2d	TXA
821	.$d2e	CLC
822	.$d2f	ADC STRBUFP
823	.$d32	PHP
824	.$d33	CLC
825	.$d34	ADC #3
826	.$d36	STA STRBUFP
827	.$d39	BCC NOCS1
828	.$d3b	INC STRBUFP+1
829	.$d3e	NOCS1  PLP
830	.$d3f	BCC STRFITS
831	.$d41	INC STRBUFP+1
832	.$d44	STRFITS  LDY TMP_FLAG 
833	.$d47	BEQ NOHPUPDATE 
834	.$d49	LDA HIGHP+1
835	.$d4c	CMP STRBUFP+1
836	.$d4f	BCC UPDATEHIGHP
837	.$d51	BEQ CHECKNEXTHP
838	.$d53	JMP NOHPUPDATE
839	.$d56	CHECKNEXTHP LDA HIGHP
840	.$d59	CMP STRBUFP
841	.$d5c	BCC UPDATEHIGHP
842	.$d5e	JMP NOHPUPDATE
843	.$d61	UPDATEHIGHP LDA STRBUFP
844	.$d64	STA HIGHP
845	.$d67	LDA STRBUFP+1
846	.$d6a	STA HIGHP+1  
847	.$d6d	JSR REMEMBERLASTVAR
848	.$d70	JSR STOREVARREF
849	.$d73	NOHPUPDATE LDY #0
850	.$d75	LDA (TMP_ZP),Y 
851	.$d77	STA (TMP3_ZP),Y
852	.$d79	TAY    
853	.$d7a	BEQ EXITCOPY 
854	.$d7c	LOOP  LDA (TMP_ZP),Y 
855	.$d7e	STA (TMP3_ZP),Y
856	.$d80	DEY
857	.$d81	BNE LOOP
858	.$d83	EXITCOPY RTS
863	.$d84	COPYSTRING2 LDY #0
864	.$d86	LDA (TMP_ZP),Y
865	.$d88	STA TMP_REG
866	.$d8a	TAX
867	.$d8b	LDA HIGHP
868	.$d8e	STA TMP3_ZP
869	.$d90	STA (TMP2_ZP),Y
870	.$d92	LDA HIGHP+1
871	.$d95	STA TMP3_ZP+1
872	.$d97	INY
873	.$d98	STA (TMP2_ZP),Y
874	.$d9a	JSR REMEMBERLASTVAR
877	.$d9d	LDA TMP_ZP
878	.$d9f	CMP TMP3_ZP
879	.$da1	BNE DOLOOP
880	.$da3	LDA TMP_ZP+1
881	.$da5	CMP TMP3_ZP+1
882	.$da7	BEQ SKIPCP2
883	.$da9	DOLOOP  DEY
884	.$daa	TXA
885	.$dab	STA (TMP3_ZP),Y
886	.$dad	INY
887	.$dae	ASLOOP  LDA (TMP_ZP),Y
888	.$db0	STA (TMP3_ZP),Y
889	.$db2	INY
890	.$db3	DEX
891	.$db4	BNE ASLOOP
892	.$db6	SKIPCP2  LDA HIGHP
893	.$db9	CLC
894	.$dba	ADC TMP_REG
895	.$dbc	PHP
896	.$dbd	CLC
897	.$dbe	ADC #3
898	.$dc0	STA HIGHP
899	.$dc3	STA STRBUFP
900	.$dc6	BCC SKIPLOWAS1
901	.$dc8	INC HIGHP+1
902	.$dcb	SKIPLOWAS1 PLP
903	.$dcc	BCC SKIPLOWAS2
904	.$dce	INC HIGHP+1
905	.$dd1	SKIPLOWAS2 LDA HIGHP+1
906	.$dd4	STA STRBUFP+1
907	.$dd7	JSR STOREVARREF
908	.$dda	RTS
912	.$ddb	CHECKLASTVAR
913	.$ddb	LDA TMP2_ZP
914	.$ddd	CMP LASTVAR
915	.$de0	BNE NOTSAMEVAR
916	.$de2	LDA TMP2_ZP+1
917	.$de4	CMP LASTVAR+1
918	.$de7	BNE NOTSAMEVAR
919	.$de9	LDA LASTVARP   
920	.$dec	STA HIGHP
921	.$def	STA STRBUFP
922	.$df2	LDA LASTVARP+1
923	.$df5	STA HIGHP+1
924	.$df8	STA STRBUFP+1
925	.$dfb	NOTSAMEVAR RTS
929	.$dfc	REMEMBERLASTVAR
930	.$dfc	LDA TMP2_ZP
931	.$dfe	STA LASTVAR
932	.$e01	LDA TMP2_ZP+1
933	.$e03	STA LASTVAR+1
934	.$e06	LDA TMP3_ZP
935	.$e08	STA LASTVARP
936	.$e0b	LDA TMP3_ZP+1
937	.$e0d	STA LASTVARP+1 
938	.$e10	RTS
943	.$e11	STOREVARREF
944	.$e11	TYA
945	.$e12	PHA    
946	.$e13	LDA TMP_ZP
947	.$e15	PHA
948	.$e16	LDA TMP_ZP+1
949	.$e18	PHA
950	.$e19	LDA HIGHP+1
951	.$e1c	STA TMP_ZP+1
952	.$e1e	LDA HIGHP
953	.$e21	SEC
954	.$e22	SBC #2
955	.$e24	STA TMP_ZP
956	.$e26	BCS RLVNOOV
957	.$e28	DEC TMP_ZP+1
958	.$e2a	RLVNOOV  LDA TMP2_ZP
959	.$e2c	LDY #0
960	.$e2e	STA (TMP_ZP),Y
961	.$e30	LDA TMP2_ZP+1
962	.$e32	INY
963	.$e33	STA (TMP_ZP),Y 
964	.$e35	PLA
965	.$e36	STA TMP_ZP+1
966	.$e38	PLA
967	.$e39	STA TMP_ZP  
968	.$e3b	PLA
969	.$e3c	TAY    
970	.$e3d	RTS
973	.$e3e	REROUTE  LDA CMD_NUM  
974	.$e41	BEQ REROUTECMD
975	.$e43	TAX
976	.$e44	STA CHANNEL
977	.$e47	JMP CHKOUT
978	.$e4a	REROUTECMD RTS
981	.$e4b	RESETROUTE LDA CMD_NUM  
982	.$e4e	BEQ RESETROUTECMD
983	.$e50	JMP CLRCHNEW
984	.$e53	RESETROUTECMD
985	.$e53	RTS
988	.$e54	INTOUTFASTZ LDX #32    
989	.$e56	LDA TMP_ZP+1
990	.$e58	BPL INTISPOS
991	.$e5a	CLC
992	.$e5b	LDA TMP_ZP
993	.$e5d	EOR #$FF
994	.$e5f	ADC #1
995	.$e61	STA TMP_ZP
996	.$e63	LDA TMP_ZP+1
997	.$e65	EOR #$FF
998	.$e67	ADC #0
999	.$e69	STA TMP_ZP+1
1000	.$e6b	LDX #45    
1001	.$e6d	INTISPOS
1002	.$e6d	TXA
1003	.$e6e	JSR CHROUT
1004	.$e71	JSR CONVPOSINT
1005	.$e74	LDA NUMFLAG
1006	.$e77	BNE ALLINTOUTDONE
1007	.$e79	LDA #48
1008	.$e7b	JSR CHROUT
1009	.$e7e	ALLINTOUTDONE
1010	.$e7e	RTS
1013	.$e7f	NUMBEROUT
1014	.$e7f	BEQ NUMZERO
1015	.$e81	ORA #$30
1016	.$e83	STA NUMFLAG
1017	.$e86	JMP CHROUT
1018	.$e89	NUMZERO
1019	.$e89	LDX NUMFLAG
1020	.$e8c	BEQ STILLZERO
1021	.$e8e	ORA #$30
1022	.$e90	JMP CHROUT
1023	.$e93	STILLZERO
1024	.$e93	RTS
1027	.$e94	CONVPOSINT
1028	.$e94	JSR INT2BCD
1029	.$e97	LDX #0
1030	.$e99	STX NUMFLAG
1031	.$e9c	AND #$0F
1032	.$e9e	JSR NUMBEROUT
1033	.$ea1	LDA BCD+1
1034	.$ea4	LSR
1035	.$ea5	LSR
1036	.$ea6	LSR
1037	.$ea7	LSR
1038	.$ea8	JSR NUMBEROUT
1039	.$eab	LDA BCD+1
1040	.$eae	AND #$0F
1041	.$eb0	TAY
1042	.$eb1	JSR NUMBEROUT
1043	.$eb4	LDA BCD
1044	.$eb7	LSR
1045	.$eb8	LSR
1046	.$eb9	LSR
1047	.$eba	LSR
1048	.$ebb	JSR NUMBEROUT
1049	.$ebe	LDA BCD
1050	.$ec1	AND #$0F
1051	.$ec3	JSR NUMBEROUT
1052	.$ec6	RTS
1055	.$ec7	INT2BCD
1056	.$ec7	SED
1057	.$ec8	LDA #0
1058	.$eca	STA BCD
1059	.$ecd	STA BCD+1
1060	.$ed0	STA BCD+2
1061	.$ed3	ASL TMP_ZP
1062	.$ed5	ROL TMP_ZP+1
1063	.$ed7	LDA BCD
1064	.$eda	ADC BCD
1065	.$edd	STA BCD
1066	.$ee0	ASL TMP_ZP
1067	.$ee2	ROL TMP_ZP+1
1068	.$ee4	ADC BCD
1069	.$ee7	STA BCD
1070	.$eea	ASL TMP_ZP
1071	.$eec	ROL TMP_ZP+1
1072	.$eee	ADC BCD
1073	.$ef1	STA BCD
1074	.$ef4	ASL TMP_ZP
1075	.$ef6	ROL TMP_ZP+1
1076	.$ef8	ADC BCD
1077	.$efb	STA BCD
1078	.$efe	ASL TMP_ZP
1079	.$f00	ROL TMP_ZP+1
1080	.$f02	ADC BCD
1081	.$f05	STA BCD
1082	.$f08	ASL TMP_ZP
1083	.$f0a	ROL TMP_ZP+1
1084	.$f0c	ADC BCD
1085	.$f0f	STA BCD
1086	.$f12	LDX #7
1087	.$f14	BCDBIT1
1088	.$f14	ASL TMP_ZP
1089	.$f16	ROL TMP_ZP+1
1090	.$f18	LDA BCD
1091	.$f1b	ADC BCD
1092	.$f1e	STA BCD
1093	.$f21	LDA BCD+1
1094	.$f24	ADC BCD+1
1095	.$f27	STA BCD+1
1096	.$f2a	DEX
1097	.$f2b	BNE BCDBIT1
1098	.$f2d	LDX #3
1099	.$f2f	BCDBIT2
1100	.$f2f	ASL TMP_ZP
1101	.$f31	ROL TMP_ZP+1
1102	.$f33	LDA BCD
1103	.$f36	ADC BCD
1104	.$f39	STA BCD
1105	.$f3c	LDA BCD+1
1106	.$f3f	ADC BCD+1
1107	.$f42	STA BCD+1
1108	.$f45	LDA BCD+2
1109	.$f48	ADC BCD+2
1110	.$f4b	STA BCD+2
1111	.$f4e	DEX
1112	.$f4f	BNE BCDBIT2
1113	.$f51	CLD
1114	.$f52	RTS
1115	.$f53	BCD
1116	.$f53	.WORD 0 0
1117	.$f57	NUMFLAG
1118	.$f57	.BYTE 0
1121	.$f58	REALOUTFAST JSR FACINT
1122	.$f5b	STA TMP_ZP+1
1123	.$f5d	STY TMP_ZP
1124	.$f5f	JMP INTOUTFASTZ
1127	.$f62	CHECKFORFASTOUT
1128	.$f62	JSR REROUTE
1129	.$f65	JSR XREGFAC
1130	.$f68	LDA FACEXP
1131	.$f6a	CMP #$90
1132	.$f6c	BCS REALOUTINT
1133	.$f6e	CMP #$81
1134	.$f70	BCC REALOUTINT
1135	.$f72	MAYBEREALOUTFAST
1136	.$f72	LDA FACEXP+3
1137	.$f74	BNE REALOUTINT
1138	.$f76	LDA FACEXP+4
1139	.$f78	BNE REALOUTINT
1140	.$f7a	LDA FACEXP
1141	.$f7c	SEC
1142	.$f7d	SBC #129
1143	.$f7f	ASL
1144	.$f80	TAX
1145	.$f81	LDA FACEXP+1
1146	.$f83	AND MANTMASK,X
1147	.$f86	BNE REALOUTINT
1148	.$f88	INX
1149	.$f89	LDA FACEXP+2
1150	.$f8b	AND MANTMASK,X
1151	.$f8e	BNE REALOUTINT
1152	.$f90	JMP REALOUTFAST
1153	.$f93	REALOUTINT LDY #0
1154	.$f95	JSR FACSTR
1155	.$f98	LDY #0
1156	.$f9a	LDA LOFBUF,Y
1157	.$f9d	STRLOOPRO JSR CHROUT
1158	.$fa0	INY
1159	.$fa1	LDA LOFBUF,Y
1160	.$fa4	BNE STRLOOPRO
1161	.$fa6	RTS
1162	.$fa7	MANTMASK
1163	.$fa7	.BYTE 127 255 63 255 31 255 15 255 7 255 3 255 1 255 0 255 0 127 0 63 0 31 0 15 0 7 0 3 0 1
1166	.$fc5	REALOUTBRK  LDA X_REG
1167	.$fc7	BNE RNOTNULLBRK
1168	.$fc9	JMP PRINTNULLBRK
1169	.$fcc	RNOTNULLBRK JSR CHECKFORFASTOUT
1170	.$fcf	LDA #$0D
1171	.$fd1	JSR CHROUT
1172	.$fd4	JMP RESETROUTE
1175	.$fd7	PRINTNULLBRK
1176	.$fd7	JSR REROUTE
1177	.$fda	LDA #$20
1178	.$fdc	JSR CHROUT
1179	.$fdf	LDA #$30
1180	.$fe1	JSR CHROUT
1181	.$fe4	LDA #$0D
1182	.$fe6	JSR CHROUT
1183	.$fe9	JMP RESETROUTE
1186	.$fec	STROUTWL STA A_REG
1187	.$fef	STY A_REG+1
1188	.$ff2	STROUT  JSR REROUTE
1189	.$ff5	LDA A_REG
1190	.$ff8	STA INDEX1
1191	.$ffa	LDA A_REG+1
1192	.$ffd	STA INDEX1+1
1193	.$fff	LDY #0
1194	.$1001	LDA (INDEX1),Y
1195	.$1003	TAX
1196	.$1004	INC INDEX1
1197	.$1006	BNE PRINTSTR
1198	.$1008	INC INDEX1+1
1199	.$100a	PRINTSTR JSR PRINTSTRS
1200	.$100d	LDA HIGHP   
1201	.$1010	STA STRBUFP
1202	.$1013	LDA HIGHP+1
1203	.$1016	STA STRBUFP+1
1204	.$1019	JSR RESETROUTE
1205	.$101c	RTS
1208	.$101d	STROUTBRKWL STA A_REG
1209	.$1020	STY A_REG+1
1210	.$1023	STROUTBRK JSR REROUTE
1211	.$1026	LDA A_REG
1212	.$1029	STA INDEX1
1213	.$102b	LDA A_REG+1
1214	.$102e	STA INDEX1+1
1215	.$1030	LDY #0
1216	.$1032	LDA (INDEX1),Y
1217	.$1034	TAX
1218	.$1035	INC INDEX1
1219	.$1037	BNE PRINTSTR2
1220	.$1039	INC INDEX1+1
1221	.$103b	PRINTSTR2 JSR PRINTSTRS
1222	.$103e	LDA HIGHP   
1223	.$1041	STA STRBUFP
1224	.$1044	LDA HIGHP+1
1225	.$1047	STA STRBUFP+1
1226	.$104a	LDA #$0D
1227	.$104c	JSR CHROUT
1228	.$104f	JMP RESETROUTE  
1231	.$1052	TABOUT  JSR REROUTE
1232	.$1055	LDA CMD_NUM
1233	.$1058	BEQ NORMALTABOUT  
1234	.$105a	CMP #3
1235	.$105c	BEQ NORMALTABOUT2  
1236	.$105e	JMP TABOUTCHANNEL2
1237	.$1061	NORMALTABOUT2
1238	.$1061	JSR CLRCHNEW
1239	.$1064	NORMALTABOUT
1240	.$1064	SEC
1241	.$1065	JSR CRSRPOS
1242	.$1068	TYA
1243	.$1069	SEC
1244	.$106a	TABSUB   SBC #$0A
1245	.$106c	BCS TABSUB
1246	.$106e	EOR #$FF
1247	.$1070	ADC #$01
1248	.$1072	TAX
1249	.$1073	INX
1250	.$1074	TABLOOP  DEX
1251	.$1075	BNE TABRIGHT
1252	.$1077	RTS
1253	.$1078	TABRIGHT JSR CRSRRIGHT
1254	.$107b	JMP TABLOOP
1257	.$107e	QUEUESIZE LDY INPUTQUEUEP
1258	.$1081	LDA #0
1259	.$1083	JSR INTFAC
1260	.$1086	JMP FACXREG
1263	.$1089	CLEARQUEUE LDA #$0
1264	.$108b	STA INPUTQUEUEP
1265	.$108e	RTS
1268	.$108f	CLEANINPUT LDY #0    
1269	.$1091	LDX #0
1270	.$1093	STY STORE1   
1271	.$1096	STY STORE2   
1272	.$1099	DEY
1273	.$109a	CILOOP  INY
1274	.$109b	LDA $0200,Y
1275	.$109e	BNE CINOEND
1276	.$10a0	JMP CIEND   
1277	.$10a3	CINOEND  STA STORE3   
1278	.$10a6	LDA STORE1
1279	.$10a9	BEQ CINOQUOTE  
1280	.$10ab	LDA STORE3
1281	.$10ae	CMP #$22   
1282	.$10b0	BNE CISTILLQUOTE 
1283	.$10b2	LDA #0    
1284	.$10b4	STA STORE1
1285	.$10b7	JMP CILOOP
1286	.$10ba	CISTILLQUOTE
1287	.$10ba	STA $0200,X
1288	.$10bd	INX
1289	.$10be	JMP CILOOP
1290	.$10c1	CINOQUOTE LDA STORE3
1291	.$10c4	CMP #$22
1292	.$10c6	BNE CISOMECHAR  
1293	.$10c8	CIFIRSTCHAR LDA #1    
1294	.$10ca	STA STORE1   
1295	.$10cd	STA STORE2   
1296	.$10d0	JMP CILOOP
1297	.$10d3	CISOMECHAR  CMP #$3A   
1298	.$10d5	BNE CINOCOLON
1299	.$10d7	JMP CIEND
1300	.$10da	CINOCOLON CMP #$2C   
1301	.$10dc	BNE CINOCOMMA
1302	.$10de	LDA #$22   
1303	.$10e0	STA $0200,X
1304	.$10e3	INX
1305	.$10e4	LDA #0
1306	.$10e6	STA STORE2   
1307	.$10e9	JMP CILOOP
1308	.$10ec	CINOCOMMA CMP #$20   
1309	.$10ee	BNE CINOSPACE
1310	.$10f0	LDA STORE2   
1311	.$10f3	BEQ CINEXT   
1312	.$10f5	LDA STORE3
1313	.$10f8	CINOSPACE STA $0200,X
1314	.$10fb	STA STORE2   
1315	.$10fe	INX
1316	.$10ff	CINEXT  JMP CILOOP
1317	.$1102	CIEND  LDA #0
1318	.$1104	STA $0200,X   
1319	.$1107	RTS     
1322	.$1108	QMARKOUT1 LDA #1
1323	.$110a	STA TMP_ZP
1324	.$110c	JMP QMARKOUT
1327	.$110f	QMARKOUT2 LDA #2
1328	.$1111	STA TMP_ZP
1329	.$1113	JMP QMARKOUT
1332	.$1116	QMARKOUT LDA IOCHANNEL    
1333	.$1118	BNE NOQMARK
1334	.$111a	JSR REROUTE
1335	.$111d	LDA #63
1336	.$111f	LDY TMP_ZP
1337	.$1121	CPY #2    
1338	.$1123	BNE ONEQMARK
1339	.$1125	JSR CHROUT
1340	.$1128	ONEQMARK JSR CHROUT
1341	.$112b	LDA #32
1342	.$112d	JSR CHROUT
1343	.$1130	JMP RESETROUTE
1344	.$1133	NOQMARK  RTS
1347	.$1134	INPUTSTR LDA #$0
1348	.$1136	INPUTSTR2 STA TMP_REG+1
1349	.$1138	LDA #$0
1350	.$113a	STX INPUTLENGTH
1351	.$113d	STA TMP_REG
1352	.$113f	STA TMP_FLAG
1353	.$1142	LDX INPUTQUEUEP
1354	.$1145	BEQ INPUTNORM
1355	.$1147	LDA #LOFBUF
1356	.$1149	LDX #$1
1357	.$114b	CLC
1358	.$114c	ADC INPUTQUEUE
1359	.$114f	STA TMP_ZP
1360	.$1151	BCC INNONO
1361	.$1153	LDX #$2
1362	.$1155	INNONO  STX TMP_ZP+1
1363	.$1157	DEC INPUTQUEUEP  
1364	.$115a	LDY INPUTQUEUE  
1365	.$115d	STY TMP_REG   
1366	.$115f	DEY
1367	.$1160	LDX #$0
1368	.$1162	SHRINKQ  LDA INPUTQUEUEP
1369	.$1165	BEQ QUEUEEMPTY
1370	.$1167	INX
1371	.$1168	LDA INPUTQUEUE,X 
1372	.$116b	DEX
1373	.$116c	STA INPUTQUEUE,X
1374	.$116f	INX
1375	.$1170	CPX INPUTQUEUEP
1376	.$1173	BNE SHRINKQ
1377	.$1175	QUEUEEMPTY JMP ISTRLOOP
1378	.$1178	INPUTNORM AND #$FF
1379	.$117a	JSR INPUT
1380	.$117d	JSR CLEANINPUT
1381	.$1180	LDA #LOFBUF
1382	.$1182	STA TMP_ZP
1383	.$1184	LDA #$1
1384	.$1186	STA TMP_ZP+1
1385	.$1188	LDY #0
1386	.$118a	DEY
1387	.$118b	ISTRLOOP INY
1388	.$118c	LDA INPUTBUF,Y
1389	.$118f	TAX
1390	.$1190	CMP #$22   
1391	.$1192	BNE ICHECK
1392	.$1194	STA TMP_FLAG
1393	.$1197	LDA #$0
1394	.$1199	STA INPUTBUF,Y   
1395	.$119c	LDX INPUTQUEUEP  
1396	.$119f	BNE INQUEUENE  
1397	.$11a1	STA INPUTQUEUE  
1398	.$11a4	INX
1399	.$11a5	INQUEUENE INY
1400	.$11a6	TYA
1401	.$11a7	STA INPUTQUEUE,X 
1402	.$11aa	INX
1403	.$11ab	STX INPUTQUEUEP  
1404	.$11ae	JMP ISTRLOOP  
1405	.$11b1	ICHECK  TXA     
1406	.$11b2	BNE ISTRLOOP  
1407	.$11b4	LDA TMP_FLAG
1408	.$11b7	BEQ ISIMPLECOPY
1409	.$11b9	JMP INPUTSTR
1410	.$11bc	ISIMPLECOPY TYA
1411	.$11bd	SEC
1412	.$11be	SBC TMP_REG
1413	.$11c0	LDY #0
1414	.$11c2	STA (TMP_ZP),Y
1415	.$11c4	TAX    
1416	.$11c5	STX INPUTLENGTH
1417	.$11c8	LDA TMP_REG+1 
1418	.$11ca	BEQ INISSTR
1419	.$11cc	RTS
1420	.$11cd	INISSTR  LDA #<A_REG
1421	.$11cf	LDY #>A_REG
1422	.$11d1	STA TMP2_ZP
1423	.$11d3	STY TMP2_ZP+1
1424	.$11d5	JSR COPYONLY
1425	.$11d8	RTS
1428	.$11d9	INPUTNUMBER LDA #$1
1429	.$11db	JSR INPUTSTR2
1430	.$11de	LDA TMP_ZP
1431	.$11e0	STA INDEX1
1432	.$11e2	LDA TMP_ZP+1
1433	.$11e4	STA INDEX1+1
1434	.$11e6	LDY #0
1435	.$11e8	STY VALTYPE
1436	.$11ea	LDA (INDEX1),Y
1437	.$11ec	STA TMP_REG  
1438	.$11ee	TAY
1439	.$11ef	INC INDEX1
1440	.$11f1	BNE VALSTR2
1441	.$11f3	INC INDEX1+1
1442	.$11f5	VALSTR2  LDY #$0   
1443	.$11f7	DEY
1444	.$11f8	LDX #$0   
1445	.$11fa	NUMCHKLOOP INY
1446	.$11fb	CPY TMP_REG
1447	.$11fd	BEQ NUMOK
1448	.$11ff	LDA (INDEX1),Y
1449	.$1201	CMP #$20
1450	.$1203	BEQ NUMCHKLOOP 
1451	.$1205	CMP #43   
1452	.$1207	BNE NOPLUS
1453	.$1209	TXA
1454	.$120a	BIT VAL6  
1455	.$120d	BNE CHECKERR
1456	.$120f	ORA #2
1457	.$1211	TAX
1458	.$1212	JMP NUMCHKLOOP
1459	.$1215	NOPLUS  CMP #45   
1460	.$1217	BNE NOMINUS
1461	.$1219	TXA
1462	.$121a	BIT VAL6  
1463	.$121d	BNE CHECKERR
1464	.$121f	ORA #4
1465	.$1221	TAX
1466	.$1222	JMP NUMCHKLOOP
1467	.$1225	NOMINUS  CMP #69   
1468	.$1227	BNE NOEEE
1469	.$1229	TXA
1470	.$122a	BIT VAL8  
1471	.$122d	BNE CHECKERR
1472	.$122f	ORA #8
1473	.$1231	AND #249  
1474	.$1233	TAX
1475	.$1234	JMP NUMCHKLOOP
1476	.$1237	NOEEE  CMP #46   
1477	.$1239	BNE NOPOINT
1478	.$123b	TXA
1479	.$123c	BIT VAL24  
1480	.$123f	BNE CHECKERR
1481	.$1241	ORA #16
1482	.$1243	TAX
1483	.$1244	JMP NUMCHKLOOP
1484	.$1247	NOPOINT  CMP #48
1485	.$1249	BCC CHECKERR 
1486	.$124b	CMP #58
1487	.$124d	BCS CHECKERR 
1488	.$124f	TXA
1489	.$1250	ORA #1
1490	.$1252	TAX
1491	.$1253	JMP NUMCHKLOOP
1492	.$1256	VAL1  .BYTE 1
1493	.$1257	VAL6  .BYTE 6
1494	.$1258	VAL8  .BYTE 8
1495	.$1259	VAL24  .BYTE 24
1496	.$125a	CHECKERR LDA #<REAL_CONST_MINUS_ONE
1497	.$125c	STA TMP3_ZP
1498	.$125e	LDA #>REAL_CONST_MINUS_ONE
1499	.$1260	STA TMP3_ZP+1
1500	.$1262	JMP COPY2_XY_XREG
1501	.$1265	RTS    
1503	.$1266	NUMOK  LDA TMP_REG
1504	.$1268	JSR VALS
1505	.$126b	LDA #$0   
1506	.$126d	STA X_REG
1507	.$126f	JMP FACYREG  
1510	.$1272	COPY2_XYA_XREG
1511	.$1272	STA TMP3_ZP
1512	.$1274	STY TMP3_ZP+1
1513	.$1276	COPY2_XY_XREG
1514	.$1276	LDX #<X_REG  
1515	.$1278	LDY #0
1516	.$127a	LDA (TMP3_ZP),Y
1517	.$127c	STA X_REG
1518	.$127e	INY
1519	.$127f	LDA (TMP3_ZP),Y
1520	.$1281	STA X_REG+1
1521	.$1283	INY
1522	.$1284	LDA (TMP3_ZP),Y
1523	.$1286	STA X_REG+2
1524	.$1288	INY
1525	.$1289	LDA (TMP3_ZP),Y
1526	.$128b	STA X_REG+3
1527	.$128d	INY
1528	.$128e	LDA (TMP3_ZP),Y
1529	.$1290	STA X_REG+4
1530	.$1292	RTS
1534	.$1293	FACWORD
1535	.$1293	LDA FACEXP   
1536	.$1295	BNE DOFACWORD
1537	.$1297	STA FACSGN   
1538	.$1299	DOFACWORD:
1539	.$1299	JMP XFACWORD
1543	.$129c	INITOUTCHANNEL
1544	.$129c	LDA CHLOCKFLAG
1545	.$129f	BEQ INITOUT2
1546	.$12a1	CMP #$FF
1547	.$12a3	BNE SKIPINITCH
1548	.$12a5	INITOUT2
1549	.$12a5	LDA #<C_REG
1550	.$12a7	LDY #>C_REG
1551	.$12a9	JSR REALFAC
1552	.$12ac	JSR FACWORD
1553	.$12af	TYA
1554	.$12b0	TAX
1555	.$12b1	CPX CMD_NUM
1556	.$12b4	BNE CMDNEQUAL
1557	.$12b6	LDY #0
1558	.$12b8	STY CMD_NUM   
1559	.$12bb	CMDNEQUAL STA CHANNEL
1560	.$12be	STA CHLOCKFLAG
1561	.$12c1	JMP CHKOUT
1562	.$12c4	SKIPINITCH
1563	.$12c4	RTS
1566	.$12c5	CLRCHNEW
1567	.$12c5	LDA CHLOCKFLAG
1568	.$12c8	BNE SKIPCLRCH
1569	.$12ca	JMP CLRCH
1570	.$12cd	SKIPCLRCH
1571	.$12cd	RTS
1574	.$12ce	INPUTLENGTHCHECK LDA INPUTLENGTH
1575	.$12d1	RTS
1578	.$12d2	TABOUTCHANNEL
1579	.$12d2	JSR INITOUTCHANNEL
1580	.$12d5	LDA CHANNEL
1581	.$12d8	CMP #3  
1582	.$12da	BEQ TABOUTSCREEN
1583	.$12dc	TABOUTCHANNEL2
1584	.$12dc	LDA IOCHANNEL
1585	.$12de	STA STORE1
1586	.$12e1	LDA #1
1587	.$12e3	STA IOCHANNEL  
1588	.$12e5	LDX #10
1589	.$12e7	JMP EXITCHANNEL
1590	.$12ea	TABOUTSCREEN
1591	.$12ea	JSR CLRCHNEW
1592	.$12ed	JMP TABOUT
1595	.$12f0	EXITCHANNEL CLC
1596	.$12f1	JSR TABSPC
1597	.$12f4	JSR CLRCHNEW
1598	.$12f7	LDA STORE1
1599	.$12fa	STA IOCHANNEL
1600	.$12fc	RTS
1603	.$12fd	OUTOFMEMORY
1607	.$12fd	LDX #$10
1608	.$12ff	JMP ERRALL
1611	.$1302	EXTRAIGNORED
1615	.$1302	JMP ERREI
1618	.$1305	FACXREG  LDA FACLO
1619	.$1307	STA X_REG+4
1620	.$1309	LDA FACMO
1621	.$130b	STA X_REG+3
1622	.$130d	LDA FACMOH
1623	.$130f	STA X_REG+2
1624	.$1311	LDA FACSGN
1625	.$1313	ORA #$7F
1626	.$1315	AND FACHO
1627	.$1317	STA X_REG+1
1628	.$1319	LDA FACEXP
1629	.$131b	STA X_REG
1630	.$131d	LDA #0   
1631	.$131f	STA FACOV
1632	.$1321	RTS
1635	.$1322	FACYREG  LDA FACLO
1636	.$1324	STA Y_REG+4
1637	.$1327	LDA FACMO
1638	.$1329	STA Y_REG+3
1639	.$132c	LDA FACMOH
1640	.$132e	STA Y_REG+2
1641	.$1331	LDA FACSGN
1642	.$1333	ORA #$7F
1643	.$1335	AND FACHO
1644	.$1337	STA Y_REG+1
1645	.$133a	LDA FACEXP
1646	.$133c	STA Y_REG
1647	.$133f	LDA #0   
1648	.$1341	STA FACOV
1649	.$1343	RTS
1652	.$1344	XREGFAC  LDA X_REG+4
1653	.$1346	STA FACLO
1654	.$1348	LDA X_REG+3
1655	.$134a	STA FACMO
1656	.$134c	LDA X_REG+2
1657	.$134e	STA FACMOH
1658	.$1350	LDA X_REG+1
1659	.$1352	STA FACSGN
1660	.$1354	ORA #$80
1661	.$1356	STA FACHO
1662	.$1358	LDA X_REG
1663	.$135a	STA FACEXP
1664	.$135c	LDA #0
1665	.$135e	STA FACOV
1666	.$1360	RTS
1669	.$1361	YREGFAC  LDA Y_REG+4
1670	.$1364	STA FACLO
1671	.$1366	LDA Y_REG+3
1672	.$1369	STA FACMO
1673	.$136b	LDA Y_REG+2
1674	.$136e	STA FACMOH
1675	.$1370	LDA Y_REG+1
1676	.$1373	STA FACSGN
1677	.$1375	ORA #$80
1678	.$1377	STA FACHO
1679	.$1379	LDA Y_REG
1680	.$137c	STA FACEXP
1681	.$137e	LDA #0
1682	.$1380	STA FACOV
1683	.$1382	RTS
1797	.$1383	INITVARS
1798	.$1383	JSR INITSTRVARS
1799	.$1386	LDA #0
1800	.$1388	LDY #4
1801	.$138a	REALINITLOOP0:
1802	.$138a	STA VAR_K,Y
1803	.$138d	STA VAR_F,Y
1804	.$1390	DEY
1805	.$1391	BMI REALLOOPEXIT0
1806	.$1393	JMP REALINITLOOP0
1807	.$1396	REALLOOPEXIT0:
1808	.$1396	RTS
1812	.$1397	CONSTANTS
1814	.$1397	CONST_0 .BYTE 5
1815	.$1398	.STRG "enter"
1820	.$139d	CONST_2 .BYTE 16
1821	.$139e	.STRG "?redo from start"
1823	.$13ae	CONST_3 .BYTE 5
1824	.$13af	.STRG "input"
1826	.$13b4	CONST_4 .BYTE 0
1827	.$13b5	.STRG ""
1829	.$13b5	CONST_5 .BYTE 6
1830	.$13b6	.STRG "input2"
1833	.$13bc	DATAS
1834	.$13bc	.BYTE $FF
1836	.$13bd	CONSTANTS_END
1839	.$13bd	VARIABLES
1841	.$13bd	VAR_K .REAL 0.0
1843	.$13c2	VAR_F .REAL 0.0
1844	.$13c7	STRINGVARS_START
1846	.$13c7	VAR_A$ .WORD EMPTYSTR
1848	.$13c9	VAR_B$ .WORD EMPTYSTR
1850	.$13cb	VAR_TI$ .WORD EMPTYSTR
1851	.$13cd	STRINGVARS_END
1852	.$13cd	STRINGARRAYS_START
1853	.$13cd	STRINGARRAYS_END
1854	.$13cd	VARIABLES_END
1856	.$13cd	Y_REG .REAL 0.0
1857	.$13d2	C_REG .REAL 0.0
1858	.$13d7	D_REG .REAL 0.0
1859	.$13dc	E_REG .REAL 0.0
1860	.$13e1	F_REG .REAL 0.0
1861	.$13e6	A_REG .WORD 0
1862	.$13e8	B_REG .WORD 0
1863	.$13ea	CMD_NUM .BYTE 0
1864	.$13eb	CHANNEL .BYTE 0
1865	.$13ec	SP_SAVE .BYTE 0
1866	.$13ed	TMP2_REG .WORD 0
1867	.$13ef	TMP3_REG .WORD 0
1868	.$13f1	TMP4_REG .WORD 0
1869	.$13f3	AS_TMP .WORD 0
1870	.$13f5	BPOINTER_TMP .WORD 0
1871	.$13f7	BASICTEXTP .BYTE 0
1872	.$13f8	STORE1 .WORD 0
1873	.$13fa	STORE2 .WORD 0
1874	.$13fc	STORE3 .WORD 0
1875	.$13fe	STORE4 .WORD 0
1876	.$1400	GCSTART .WORD 0
1877	.$1402	GCLEN .WORD 0
1878	.$1404	GCWORK .WORD 0
1879	.$1406	INPUTLENGTH .BYTE 0
1880	.$1407	TMP_FREG .REAL 0
1881	.$140c	TMP2_FREG .REAL 0
1882	.$1411	TMP_FLAG .BYTE 0
1883	.$1412	INT_FLAG .BYTE 0
1884	.$1413	REAL_CONST_ONE .REAL 1.0
1885	.$1418	REAL_CONST_ZERO .REAL 0.0
1886	.$141d	REAL_CONST_MINUS_ONE .REAL -1.0
1887	.$1422	CHLOCKFLAG .BYTE 0
1888	.$1423	EMPTYSTR .BYTE 0
1889	.$1424	FPSTACKP .WORD FPSTACK
1890	.$1426	FORSTACKP .WORD FORSTACK
1891	.$1428	DATASP .WORD DATAS
1892	.$142a	LASTVAR .WORD 0
1893	.$142c	LASTVARP .WORD 0
1894	.$142e	HIGHP .WORD STRBUF
1895	.$1430	STRBUFP .WORD STRBUF
1896	.$1432	ENDSTRBUF .WORD 0
1897	.$1434	INPUTQUEUEP .BYTE 0
1898	.$1435	PROGRAMEND
1899	.$1435	INPUTQUEUE .ARRAY $0F
1900	.$1444	FPSTACK .ARRAY 100
1901	.$14a8	FORSTACK .ARRAY 340
1902	.$15fc	STRBUF .BYTE 0

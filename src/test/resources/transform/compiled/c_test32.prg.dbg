117	.$818	TSX
118	.$819	STX SP_SAVE
120	.$81c	PROGRAMSTART:
121	.$81c	JSR START
123	.$81f	LINE_0:
126	.$81f	LINE_10:
128	.$81f	LDX #4
129	.$821	dcloop401_1:
130	.$821	LDA CONST_0R,X
131	.$824	STA VAR_I,X
132	.$827	DEX
133	.$828	BPL dcloop401_1
135	.$82a	LDA #<CONST_1R
136	.$82c	LDY #>CONST_1R
137	.$82e	JSR REALFACPUSH
139	.$831	LDA #<CONST_0R
140	.$833	LDY #>CONST_0R
141	.$835	JSR REALFACPUSH
143	.$838	LDA #<VAR_I
144	.$83a	LDY #>VAR_I
145	.$83c	STA A_REG
146	.$83f	STY A_REG+1
147	.$842	LDA #<FORLOOP0
148	.$844	STA JUMP_TARGET
149	.$846	LDA #>FORLOOP0
150	.$848	STA JUMP_TARGET+1
151	.$84a	JSR INITFOR
152	.$84d	FORLOOP0:
153	.$84d	LDA #<VAR_I
154	.$84f	LDY #>VAR_I
155	.$851	JSR COPY2_XYA_XREG
159	.$854	JSR REALOUT
160	.$857	JSR CRSRRIGHT
161	.$85a	JSR TABOUT
162	.$85d	LDA #0
163	.$85f	STA A_REG
164	.$862	STA A_REG+1
165	.$865	JSR NEXT
167	.$868	LDA A_REG
168	.$86b	BNE RBEQ_0
169	.$86d	JMP (JUMP_TARGET)
171	.$870	RBEQ_0:
173	.$870	LINE_20:
175	.$870	LDX #4
176	.$872	dcloop567_1:
177	.$872	LDA CONST_1R,X
178	.$875	STA VAR_I,X
179	.$878	DEX
180	.$879	BPL dcloop567_1
182	.$87b	LDA #<CONST_0R
183	.$87d	LDY #>CONST_0R
184	.$87f	JSR REALFACPUSH
186	.$882	LDA #<CONST_3
187	.$884	LDY #>CONST_3
188	.$886	JSR REALFACPUSH
190	.$889	LDA #<VAR_I
191	.$88b	LDY #>VAR_I
192	.$88d	STA A_REG
193	.$890	STY A_REG+1
194	.$893	LDA #<FORLOOP1
195	.$895	STA JUMP_TARGET
196	.$897	LDA #>FORLOOP1
197	.$899	STA JUMP_TARGET+1
198	.$89b	JSR INITFOR
199	.$89e	FORLOOP1:
200	.$89e	LDA #<VAR_I
201	.$8a0	LDY #>VAR_I
202	.$8a2	JSR COPY2_XYA_XREG
206	.$8a5	JSR REALOUT
207	.$8a8	JSR CRSRRIGHT
208	.$8ab	JSR TABOUT
209	.$8ae	LDA #0
210	.$8b0	STA A_REG
211	.$8b3	STA A_REG+1
212	.$8b6	JSR NEXT
214	.$8b9	LDA A_REG
215	.$8bc	BNE RBEQ_1
216	.$8be	JMP (JUMP_TARGET)
218	.$8c1	RBEQ_1:
219	.$8c1	JSR END
220	.$8c4	RTS
223	.$8c5	END   LDX SP_SAVE
224	.$8c8	TXS
231	.$8c9	RTS
234	.$8ca	START  LDA ENDSTRBUF+1
235	.$8cd	BNE ENDGIVEN
236	.$8cf	LDA BASICEND
237	.$8d1	STA ENDSTRBUF
238	.$8d4	LDA BASICEND+1
239	.$8d6	STA ENDSTRBUF+1
240	.$8d9	ENDGIVEN LDA #<FPSTACK
241	.$8db	LDY #>FPSTACK
242	.$8dd	STA FPSTACKP
243	.$8e0	STY FPSTACKP+1
244	.$8e3	LDA #<FORSTACK
245	.$8e5	LDY #>FORSTACK
246	.$8e7	STA FORSTACKP
247	.$8ea	STY FORSTACKP+1
248	.$8ed	LDA #<STRBUF
249	.$8ef	LDY #>STRBUF
250	.$8f1	STA STRBUFP
251	.$8f4	STY STRBUFP+1
252	.$8f7	STA HIGHP
253	.$8fa	STY HIGHP+1
254	.$8fd	LDA #0
255	.$8ff	STA CHLOCKFLAG
256	.$902	STA LASTVAR
257	.$905	STA LASTVAR+1
258	.$908	JSR INITVARS
259	.$90b	LDA #0
260	.$90d	STA CMD_NUM
261	.$910	STA CHANNEL
262	.$913	TAY
263	.$914	TAX
267	.$915	STA KEYNDX
273	.$917	JSR RESTORE
274	.$91a	CLC
278	.$91b	RTS
281	.$91c	INITNARRAY
282	.$91c	STA TMP_ZP
283	.$91e	STY TMP_ZP+1
284	.$920	LDY #0
285	.$922	TYA
286	.$923	NINITLOOP STA (TMP_ZP),Y
287	.$925	INC TMP_ZP
288	.$927	BNE NLOOPNOV
289	.$929	INC TMP_ZP+1
290	.$92b	NLOOPNOV LDX TMP2_ZP
291	.$92d	BNE NLOOPNOV2
292	.$92f	DEC TMP2_ZP+1
293	.$931	NLOOPNOV2 DEC TMP2_ZP
294	.$933	BNE NINITLOOP
295	.$935	LDX TMP2_ZP+1
296	.$937	BNE NINITLOOP
297	.$939	RTS
300	.$93a	INITSTRARRAY
301	.$93a	STA TMP_ZP
302	.$93c	STY TMP_ZP+1
303	.$93e	SINITLOOP LDY #0
304	.$940	LDA #<EMPTYSTR
305	.$942	STA (TMP_ZP),Y
306	.$944	LDA #>EMPTYSTR
307	.$946	INY
308	.$947	STA (TMP_ZP),Y
309	.$949	CLC
310	.$94a	LDA TMP_ZP
311	.$94c	ADC #2
312	.$94e	STA TMP_ZP
313	.$950	BCC SLOOPNOV1
314	.$952	INC TMP_ZP+1
315	.$954	SLOOPNOV1 SEC
316	.$955	LDA TMP2_ZP
317	.$957	SBC #2
318	.$959	STA TMP2_ZP
319	.$95b	BCS SLOOPNOV2
320	.$95d	DEC TMP2_ZP+1
321	.$95f	SLOOPNOV2 LDA TMP2_ZP
322	.$961	BNE SINITLOOP
323	.$963	LDA TMP2_ZP+1
324	.$965	BNE SINITLOOP
325	.$967	RTS
328	.$968	INITSPARAMS STA TMP3_ZP
329	.$96a	STY TMP3_ZP+1
330	.$96c	SEC
331	.$96d	SBC #2
332	.$96f	STA TMP_ZP
333	.$971	TYA
334	.$972	SBC #0
335	.$974	STA TMP_ZP+1
336	.$976	LDY #0
337	.$978	LDA (TMP_ZP),Y
338	.$97a	STA TMP2_ZP
339	.$97c	INY
340	.$97d	LDA (TMP_ZP),Y
341	.$97f	STA TMP2_ZP+1
342	.$981	LDA TMP3_ZP
343	.$983	LDY TMP3_ZP+1
344	.$985	RTS
347	.$986	INITSTRVARS LDA #<STRINGVARS_START  
348	.$988	LDY #>STRINGVARS_START
349	.$98a	CMP #<STRINGVARS_END
350	.$98c	BNE INITIT1
351	.$98e	CPY #>STRINGVARS_END
352	.$990	BNE INITIT1
353	.$992	JMP INITSA2     
354	.$995	INITIT1  STA TMP_ZP
355	.$997	STY TMP_ZP+1
356	.$999	LDY #0
357	.$99b	INITSTRLOOP LDA #<EMPTYSTR
358	.$99d	STA (TMP_ZP),Y
359	.$99f	INY
360	.$9a0	LDA #>EMPTYSTR
361	.$9a2	STA (TMP_ZP),Y
362	.$9a4	DEY
363	.$9a5	LDA TMP_ZP
364	.$9a7	CLC
365	.$9a8	ADC #2
366	.$9aa	STA TMP_ZP
367	.$9ac	LDA TMP_ZP+1
368	.$9ae	ADC #0
369	.$9b0	STA TMP_ZP+1
370	.$9b2	CMP #>STRINGVARS_END
371	.$9b4	BNE INITSTRLOOP
372	.$9b6	LDA TMP_ZP
373	.$9b8	CMP #<STRINGVARS_END
374	.$9ba	BNE INITSTRLOOP
375	.$9bc	INITSA2  LDA #<STRINGARRAYS_START 
376	.$9be	LDY #>STRINGARRAYS_START
377	.$9c0	CMP #<STRINGARRAYS_END
378	.$9c2	BNE ARRAYLOOP
379	.$9c4	CPY #>STRINGARRAYS_END
380	.$9c6	BNE ARRAYLOOP
381	.$9c8	RTS       
382	.$9c9	ARRAYLOOP CLC
383	.$9ca	ADC #3
384	.$9cc	BCC ARRAYSKIP1
385	.$9ce	INY
386	.$9cf	ARRAYSKIP1 CPY #>STRINGARRAYS_END
387	.$9d1	BEQ ARRAYSC
388	.$9d3	BCC ARRAYSKIP2
389	.$9d5	JMP ARRAYQUIT
390	.$9d8	ARRAYSC  CMP #<STRINGARRAYS_END
391	.$9da	BCS ARRAYQUIT
392	.$9dc	ARRAYSKIP2 STA TMP_REG
393	.$9de	STY TMP_REG+1
394	.$9e0	JSR INITSPARAMS
395	.$9e3	LDA TMP_REG
396	.$9e5	LDY TMP_REG+1
397	.$9e7	JSR INITSTRARRAY
398	.$9ea	LDA TMP_ZP
399	.$9ec	LDY TMP_ZP+1
400	.$9ee	JMP ARRAYLOOP
401	.$9f1	ARRAYQUIT RTS
404	.$9f2	RESTORE  LDA #<DATAS
405	.$9f4	LDY #>DATAS
406	.$9f6	STA DATASP
407	.$9f9	STY DATASP+1
408	.$9fc	RTS
411	.$9fd	TABSPC     BCC DOSPC
412	.$9ff	TXA
413	.$a00	SBC $09
414	.$a02	BCC TABSPCQUIT
415	.$a04	TAX
416	.$a05	DOSPC  INX
417	.$a06	TABSPCLOOP  DEX
418	.$a07	BNE TABSPCRIGHT
419	.$a09	TABSPCQUIT RTS
420	.$a0a	TABSPCRIGHT JSR CRSRRIGHT
421	.$a0d	JMP TABSPCLOOP
424	.$a10	REROUTE  LDA CMD_NUM  
425	.$a13	BEQ REROUTECMD
426	.$a15	TAX
427	.$a16	STA CHANNEL
428	.$a19	JMP CHKOUT
429	.$a1c	REROUTECMD RTS
432	.$a1d	RESETROUTE LDA CMD_NUM  
433	.$a20	BEQ RESETROUTECMD
434	.$a22	JMP CLRCHNEW
435	.$a25	RESETROUTECMD
436	.$a25	RTS
439	.$a26	INTOUTFASTZ LDX #32    
440	.$a28	LDA TMP_ZP+1
441	.$a2a	BPL INTISPOS
442	.$a2c	CLC
443	.$a2d	LDA TMP_ZP
444	.$a2f	EOR #$FF
445	.$a31	ADC #1
446	.$a33	STA TMP_ZP
447	.$a35	LDA TMP_ZP+1
448	.$a37	EOR #$FF
449	.$a39	ADC #0
450	.$a3b	STA TMP_ZP+1
451	.$a3d	LDX #45    
452	.$a3f	INTISPOS
453	.$a3f	TXA
454	.$a40	JSR CHROUT
455	.$a43	JSR CONVPOSINT
456	.$a46	LDA NUMFLAG
457	.$a49	BNE ALLINTOUTDONE
458	.$a4b	LDA #48
459	.$a4d	JSR CHROUT
460	.$a50	ALLINTOUTDONE
461	.$a50	RTS
464	.$a51	NUMBEROUT
465	.$a51	BEQ NUMZERO
466	.$a53	ORA #$30
467	.$a55	STA NUMFLAG
468	.$a58	JMP CHROUT
469	.$a5b	NUMZERO
470	.$a5b	LDX NUMFLAG
471	.$a5e	BEQ STILLZERO
472	.$a60	ORA #$30
473	.$a62	JMP CHROUT
474	.$a65	STILLZERO
475	.$a65	RTS
478	.$a66	CONVPOSINT
479	.$a66	JSR INT2BCD
480	.$a69	LDX #0
481	.$a6b	STX NUMFLAG
482	.$a6e	AND #$0F
483	.$a70	JSR NUMBEROUT
484	.$a73	LDA BCD+1
485	.$a76	LSR
486	.$a77	LSR
487	.$a78	LSR
488	.$a79	LSR
489	.$a7a	JSR NUMBEROUT
490	.$a7d	LDA BCD+1
491	.$a80	AND #$0F
492	.$a82	TAY
493	.$a83	JSR NUMBEROUT
494	.$a86	LDA BCD
495	.$a89	LSR
496	.$a8a	LSR
497	.$a8b	LSR
498	.$a8c	LSR
499	.$a8d	JSR NUMBEROUT
500	.$a90	LDA BCD
501	.$a93	AND #$0F
502	.$a95	JSR NUMBEROUT
503	.$a98	RTS
506	.$a99	INT2BCD
507	.$a99	SED
508	.$a9a	LDA #0
509	.$a9c	STA BCD
510	.$a9f	STA BCD+1
511	.$aa2	STA BCD+2
512	.$aa5	ASL TMP_ZP
513	.$aa7	ROL TMP_ZP+1
514	.$aa9	LDA BCD
515	.$aac	ADC BCD
516	.$aaf	STA BCD
517	.$ab2	ASL TMP_ZP
518	.$ab4	ROL TMP_ZP+1
519	.$ab6	ADC BCD
520	.$ab9	STA BCD
521	.$abc	ASL TMP_ZP
522	.$abe	ROL TMP_ZP+1
523	.$ac0	ADC BCD
524	.$ac3	STA BCD
525	.$ac6	ASL TMP_ZP
526	.$ac8	ROL TMP_ZP+1
527	.$aca	ADC BCD
528	.$acd	STA BCD
529	.$ad0	ASL TMP_ZP
530	.$ad2	ROL TMP_ZP+1
531	.$ad4	ADC BCD
532	.$ad7	STA BCD
533	.$ada	ASL TMP_ZP
534	.$adc	ROL TMP_ZP+1
535	.$ade	ADC BCD
536	.$ae1	STA BCD
537	.$ae4	LDX #7
538	.$ae6	BCDBIT1
539	.$ae6	ASL TMP_ZP
540	.$ae8	ROL TMP_ZP+1
541	.$aea	LDA BCD
542	.$aed	ADC BCD
543	.$af0	STA BCD
544	.$af3	LDA BCD+1
545	.$af6	ADC BCD+1
546	.$af9	STA BCD+1
547	.$afc	DEX
548	.$afd	BNE BCDBIT1
549	.$aff	LDX #3
550	.$b01	BCDBIT2
551	.$b01	ASL TMP_ZP
552	.$b03	ROL TMP_ZP+1
553	.$b05	LDA BCD
554	.$b08	ADC BCD
555	.$b0b	STA BCD
556	.$b0e	LDA BCD+1
557	.$b11	ADC BCD+1
558	.$b14	STA BCD+1
559	.$b17	LDA BCD+2
560	.$b1a	ADC BCD+2
561	.$b1d	STA BCD+2
562	.$b20	DEX
563	.$b21	BNE BCDBIT2
564	.$b23	CLD
565	.$b24	RTS
566	.$b25	BCD
567	.$b25	.WORD 0 0
568	.$b29	NUMFLAG
569	.$b29	.BYTE 0
572	.$b2a	REALOUTFAST JSR FACINT
573	.$b2d	STA TMP_ZP+1
574	.$b2f	STY TMP_ZP
575	.$b31	JMP INTOUTFASTZ
578	.$b34	CHECKFORFASTOUT
579	.$b34	JSR REROUTE
580	.$b37	JSR XREGFAC
581	.$b3a	LDA FACEXP
582	.$b3c	CMP #$90
583	.$b3e	BCS REALOUTINT
584	.$b40	CMP #$81
585	.$b42	BCC REALOUTINT
586	.$b44	MAYBEREALOUTFAST
587	.$b44	LDA FACEXP+3
588	.$b46	BNE REALOUTINT
589	.$b48	LDA FACEXP+4
590	.$b4a	BNE REALOUTINT
591	.$b4c	LDA FACEXP
592	.$b4e	SEC
593	.$b4f	SBC #129
594	.$b51	ASL
595	.$b52	TAX
596	.$b53	LDA FACEXP+1
597	.$b55	AND MANTMASK,X
598	.$b58	BNE REALOUTINT
599	.$b5a	INX
600	.$b5b	LDA FACEXP+2
601	.$b5d	AND MANTMASK,X
602	.$b60	BNE REALOUTINT
603	.$b62	JMP REALOUTFAST
604	.$b65	REALOUTINT LDY #0
605	.$b67	JSR FACSTR
606	.$b6a	LDY #0
607	.$b6c	LDA LOFBUF,Y
608	.$b6f	STRLOOPRO JSR CHROUT
609	.$b72	INY
610	.$b73	LDA LOFBUF,Y
611	.$b76	BNE STRLOOPRO
612	.$b78	RTS
613	.$b79	MANTMASK
614	.$b79	.BYTE 127 255 63 255 31 255 15 255 7 255 3 255 1 255 0 255 0 127 0 63 0 31 0 15 0 7 0 3 0 1
617	.$b97	REALOUT  LDA X_REG
618	.$b99	BNE RNOTNULL
619	.$b9b	JMP PRINTNULL
620	.$b9e	RNOTNULL JSR CHECKFORFASTOUT
621	.$ba1	JMP RESETROUTE
624	.$ba4	PRINTNULL JSR REROUTE
625	.$ba7	LDA #$20
626	.$ba9	JSR CHROUT
627	.$bac	LDA #$30
628	.$bae	JSR CHROUT
629	.$bb1	JMP RESETROUTE
632	.$bb4	TABOUT  JSR REROUTE
633	.$bb7	LDA CMD_NUM
634	.$bba	BEQ NORMALTABOUT  
635	.$bbc	CMP #3
636	.$bbe	BEQ NORMALTABOUT2  
637	.$bc0	JMP TABOUTCHANNEL2
638	.$bc3	NORMALTABOUT2
639	.$bc3	JSR CLRCHNEW
640	.$bc6	NORMALTABOUT
641	.$bc6	SEC
642	.$bc7	JSR CRSRPOS
643	.$bca	TYA
644	.$bcb	SEC
645	.$bcc	TABSUB   SBC #$0A
646	.$bce	BCS TABSUB
647	.$bd0	EOR #$FF
648	.$bd2	ADC #$01
649	.$bd4	TAX
650	.$bd5	INX
651	.$bd6	TABLOOP  DEX
652	.$bd7	BNE TABRIGHT
653	.$bd9	RTS
654	.$bda	TABRIGHT JSR CRSRRIGHT
655	.$bdd	JMP TABLOOP
658	.$be0	ADJUSTSTACK LDA FORSTACKP 
659	.$be3	STA TMP_ZP
660	.$be5	LDA FORSTACKP+1
661	.$be8	STA TMP_ZP+1
662	.$bea	ADSEARCHFOR LDA TMP_ZP
663	.$bec	CMP #<FORSTACK
664	.$bee	BNE ADJUST2
665	.$bf0	LDA TMP_ZP+1
666	.$bf2	CMP #>FORSTACK
667	.$bf4	BNE ADJUST2
668	.$bf6	RTS    
669	.$bf7	ADJUST2  LDA TMP_ZP
670	.$bf9	SEC
671	.$bfa	SBC #2
672	.$bfc	STA TMP_ZP
673	.$bfe	BCS ADNOPV1N1
674	.$c00	DEC TMP_ZP+1
675	.$c02	ADNOPV1N1 LDY #0
676	.$c04	LDA (TMP_ZP),Y
677	.$c06	BNE ADNOGOSUB
678	.$c08	RTS    
679	.$c09	ADNOGOSUB
680	.$c09	INY
681	.$c0a	LDA TMP_ZP
682	.$c0c	SEC
683	.$c0d	SBC (TMP_ZP),Y
684	.$c0f	STA TMP_ZP
685	.$c11	BCS ADNOPV1N2
686	.$c13	DEC TMP_ZP+1
687	.$c15	ADNOPV1N2 DEY
688	.$c16	LDA A_REG
689	.$c19	ADCMPFOR CMP (TMP_ZP),Y
690	.$c1b	BNE ADSEARCHFOR
691	.$c1d	LDA A_REG+1
692	.$c20	INY
693	.$c21	CMP (TMP_ZP),Y
694	.$c23	BEQ ADFOUNDFOR
695	.$c25	JMP ADSEARCHFOR
696	.$c28	ADLOW0  LDX A_REG+1
697	.$c2b	BEQ ADFOUNDFOR
698	.$c2d	BNE ADCMPFOR
699	.$c2f	ADFOUNDFOR LDA TMP_ZP  
700	.$c31	STA FORSTACKP
701	.$c34	LDA TMP_ZP+1
702	.$c36	STA FORSTACKP+1
703	.$c39	RTS
706	.$c3a	INITFOR  JSR ADJUSTSTACK
707	.$c3d	LDA FORSTACKP
708	.$c40	STA TMP_ZP
709	.$c42	LDA FORSTACKP+1
710	.$c45	STA TMP_ZP+1
711	.$c47	LDY #0
712	.$c49	LDA A_REG
713	.$c4c	STA (TMP_ZP),Y
714	.$c4e	INY
715	.$c4f	LDA A_REG+1
716	.$c52	STA (TMP_ZP),Y
717	.$c54	INY
718	.$c55	LDA JUMP_TARGET
719	.$c57	STA (TMP_ZP),Y
720	.$c59	INY
721	.$c5a	LDA JUMP_TARGET+1
722	.$c5c	STA (TMP_ZP),Y
723	.$c5e	INY
724	.$c5f	STY TMP3_ZP
725	.$c61	JSR INCTMPZP
726	.$c64	JSR POPREAL
727	.$c67	LDX TMP_ZP
728	.$c69	LDY TMP_ZP+1
730	.$c6b	JSR FACMEM
731	.$c6e	JSR SGNFAC
732	.$c71	STA TMP_FLAG
733	.$c74	LDY #5
734	.$c76	STY TMP3_ZP
735	.$c78	JSR INCTMPZP
736	.$c7b	JSR POPREAL
737	.$c7e	LDX TMP_ZP
738	.$c80	LDY TMP_ZP+1
740	.$c82	JSR FACMEM
741	.$c85	LDY #5
742	.$c87	STY TMP3_ZP
743	.$c89	JSR INCTMPZP
744	.$c8c	LDY #0
745	.$c8e	LDA TMP_FLAG
746	.$c91	STA (TMP_ZP),Y
747	.$c93	INY
748	.$c94	LDA #1
749	.$c96	STA (TMP_ZP),Y
750	.$c98	INY
751	.$c99	LDA #15
752	.$c9b	STA (TMP_ZP),Y
753	.$c9d	LDY #3
754	.$c9f	STY TMP3_ZP
755	.$ca1	JSR INCTMPZP
756	.$ca4	LDA TMP_ZP
757	.$ca6	STA FORSTACKP
758	.$ca9	LDA TMP_ZP+1
759	.$cab	STA FORSTACKP+1
760	.$cae	RTS
763	.$caf	NEXT  LDA FORSTACKP
764	.$cb2	STA TMP_ZP
765	.$cb4	LDA FORSTACKP+1
766	.$cb7	STA TMP_ZP+1
767	.$cb9	SEARCHFOR LDA TMP_ZP+1
768	.$cbb	STA TMP3_REG+1
769	.$cbe	LDA TMP_ZP
770	.$cc0	STA TMP3_REG
771	.$cc3	SEC
772	.$cc4	SBC #2
773	.$cc6	STA TMP_ZP
774	.$cc8	BCS NOPV1N1
775	.$cca	DEC TMP_ZP+1
776	.$ccc	NOPV1N1  LDY #0
777	.$cce	LDA (TMP_ZP),Y
778	.$cd0	BNE NOGOSUB
779	.$cd2	JMP NEXTWOFOR
780	.$cd5	NOGOSUB
781	.$cd5	INY
782	.$cd6	LDA TMP_ZP
783	.$cd8	SEC
784	.$cd9	SBC (TMP_ZP),Y
785	.$cdb	STA TMP_ZP
786	.$cdd	BCS NOPV1N2
787	.$cdf	DEC TMP_ZP+1
788	.$ce1	NOPV1N2  DEY
789	.$ce2	LDA A_REG
790	.$ce5	BEQ LOW0
791	.$ce7	CMPFOR  CMP (TMP_ZP),Y
792	.$ce9	BNE SEARCHFOR
793	.$ceb	LDA A_REG+1
794	.$cee	INY
795	.$cef	CMP (TMP_ZP),Y
796	.$cf1	BEQ FOUNDFOR
797	.$cf3	JMP SEARCHFOR
798	.$cf6	LOW0  LDX A_REG+1
799	.$cf9	BEQ FOUNDFOR
800	.$cfb	BNE CMPFOR
801	.$cfd	FOUNDFOR LDA TMP_ZP
802	.$cff	STA TMP2_REG
803	.$d02	LDA TMP_ZP+1
804	.$d04	STA TMP2_REG+1
805	.$d07	VARREAL
806	.$d07	LDY #0
807	.$d09	STY A_REG+1 
808	.$d0c	LDA (TMP_ZP),Y
809	.$d0e	TAX
810	.$d0f	INY
811	.$d10	LDA (TMP_ZP),Y
812	.$d12	TAY
813	.$d13	TXA
814	.$d14	JSR REALFAC
815	.$d17	CALCNEXT LDA TMP_ZP
816	.$d19	CLC
817	.$d1a	ADC #4
818	.$d1c	STA TMP_ZP
819	.$d1e	BCC NOPV2IN
820	.$d20	INC TMP_ZP+1
821	.$d22	NOPV2IN  STA TMP_REG
822	.$d24	LDY TMP_ZP+1
823	.$d26	STY TMP_REG+1
824	.$d28	JSR FASTFADDMEM
826	.$d2b	LDA TMP2_REG
827	.$d2e	STA TMP_ZP
828	.$d30	LDA TMP2_REG+1
829	.$d33	STA TMP_ZP+1
830	.$d35	STOREREAL
831	.$d35	LDY #0
832	.$d37	LDA (TMP_ZP),Y
833	.$d39	TAX
834	.$d3a	INY
835	.$d3b	LDA (TMP_ZP),Y
836	.$d3d	TAY
837	.$d3e	JSR FACMEM 
838	.$d41	CMPFORXX LDA #5
839	.$d43	STA TMP3_ZP
840	.$d45	LDA TMP_REG
841	.$d47	CLC
842	.$d48	ADC #5
843	.$d4a	STA TMP_REG
844	.$d4c	BCC NOPV3
845	.$d4e	INC TMP_REG+1
846	.$d50	NOPV3  LDY TMP_REG+1
847	.$d52	JSR CMPFAC  
848	.$d55	BEQ LOOPING
849	.$d57	PHA
850	.$d58	LDY #14
851	.$d5a	LDA (TMP_ZP),Y
852	.$d5c	BEQ STEPZERO
853	.$d5e	ROL
854	.$d5f	BCC STEPPOS
855	.$d61	STEPNEG  PLA
856	.$d62	ROL
857	.$d63	BCC LOOPING
858	.$d65	BCS EXITLOOP
859	.$d67	STEPPOS  PLA
860	.$d68	ROL
861	.$d69	BCC EXITLOOP
862	.$d6b	LOOPING  LDA TMP3_REG
863	.$d6e	STA FORSTACKP
864	.$d71	LDA TMP3_REG+1
865	.$d74	STA FORSTACKP+1
866	.$d77	LDA TMP2_REG
867	.$d7a	CLC
868	.$d7b	ADC #2
869	.$d7d	STA TMP2_REG
870	.$d80	BCC NOPV4IN
871	.$d82	INC TMP2_REG+1
872	.$d85	NOPV4IN  LDY #0
873	.$d87	STY A_REG
874	.$d8a	STA TMP_ZP
875	.$d8c	LDA TMP2_REG+1
876	.$d8f	STA TMP_ZP+1
877	.$d91	LDA (TMP_ZP),Y
878	.$d93	STA JUMP_TARGET
879	.$d95	INY
880	.$d96	LDA (TMP_ZP),Y
881	.$d98	STA JUMP_TARGET+1
882	.$d9a	RTS
883	.$d9b	STEPZERO PLA
884	.$d9c	JMP LOOPING
885	.$d9f	EXITLOOP LDA TMP2_REG
886	.$da2	STA FORSTACKP
887	.$da5	LDA TMP2_REG+1
888	.$da8	STA FORSTACKP+1
889	.$dab	LDA #1
890	.$dad	STA A_REG
891	.$db0	RTS
894	.$db1	REALFACPUSH STA TMP_ZP
895	.$db3	STY TMP_ZP+1
896	.$db5	LDX FPSTACKP
897	.$db8	LDY FPSTACKP+1
898	.$dbb	STX TMP2_ZP
899	.$dbd	STY TMP2_ZP+1
900	.$dbf	LDY #0
901	.$dc1	LDA (TMP_ZP),Y
902	.$dc3	STA (TMP2_ZP),Y
903	.$dc5	INY
904	.$dc6	LDA (TMP_ZP),Y
905	.$dc8	STA (TMP2_ZP),Y
906	.$dca	INY
907	.$dcb	LDA (TMP_ZP),Y
908	.$dcd	STA (TMP2_ZP),Y
909	.$dcf	INY
910	.$dd0	LDA (TMP_ZP),Y
911	.$dd2	STA (TMP2_ZP),Y
912	.$dd4	INY
913	.$dd5	LDA (TMP_ZP),Y
914	.$dd7	STA (TMP2_ZP),Y
915	.$dd9	TXA    
916	.$dda	CLC
917	.$ddb	ADC #5
918	.$ddd	STA FPSTACKP
919	.$de0	BCC NOPVRFPXX
920	.$de2	INC FPSTACKP+1
921	.$de5	NOPVRFPXX RTS
924	.$de6	POPREAL  LDA FPSTACKP
925	.$de9	SEC
926	.$dea	SBC #5
927	.$dec	STA FPSTACKP
928	.$def	BCS NOPVPR
929	.$df1	DEC FPSTACKP+1
930	.$df4	NOPVPR  LDA FPSTACKP
931	.$df7	LDY FPSTACKP+1
932	.$dfa	JMP REALFAC
935	.$dfd	INCTMPZP LDA TMP_ZP
936	.$dff	CLC
937	.$e00	ADC TMP3_ZP
938	.$e02	STA TMP_ZP
939	.$e04	BCC NOPV2
940	.$e06	INC TMP_ZP+1
941	.$e08	NOPV2  RTS
944	.$e09	COPY2_XYA_XREG
945	.$e09	STA TMP3_ZP
946	.$e0b	STY TMP3_ZP+1
947	.$e0d	COPY2_XY_XREG
948	.$e0d	LDX #<X_REG  
949	.$e0f	LDY #0
950	.$e11	LDA (TMP3_ZP),Y
951	.$e13	STA X_REG
952	.$e15	INY
953	.$e16	LDA (TMP3_ZP),Y
954	.$e18	STA X_REG+1
955	.$e1a	INY
956	.$e1b	LDA (TMP3_ZP),Y
957	.$e1d	STA X_REG+2
958	.$e1f	INY
959	.$e20	LDA (TMP3_ZP),Y
960	.$e22	STA X_REG+3
961	.$e24	INY
962	.$e25	LDA (TMP3_ZP),Y
963	.$e27	STA X_REG+4
964	.$e29	RTS
968	.$e2a	FACWORD
969	.$e2a	LDA FACEXP   
970	.$e2c	BNE DOFACWORD
971	.$e2e	STA FACSGN   
972	.$e30	DOFACWORD:
973	.$e30	JMP XFACWORD
977	.$e33	INITOUTCHANNEL
978	.$e33	LDA CHLOCKFLAG
979	.$e36	BEQ INITOUT2
980	.$e38	CMP #$FF
981	.$e3a	BNE SKIPINITCH
982	.$e3c	INITOUT2
983	.$e3c	LDA #<C_REG
984	.$e3e	LDY #>C_REG
985	.$e40	JSR REALFAC
986	.$e43	JSR FACWORD
987	.$e46	TYA
988	.$e47	TAX
989	.$e48	CPX CMD_NUM
990	.$e4b	BNE CMDNEQUAL
991	.$e4d	LDY #0
992	.$e4f	STY CMD_NUM   
993	.$e52	CMDNEQUAL STA CHANNEL
994	.$e55	STA CHLOCKFLAG
995	.$e58	JMP CHKOUT
996	.$e5b	SKIPINITCH
997	.$e5b	RTS
1000	.$e5c	CLRCHNEW
1001	.$e5c	LDA CHLOCKFLAG
1002	.$e5f	BNE SKIPCLRCH
1003	.$e61	JMP CLRCH
1004	.$e64	SKIPCLRCH
1005	.$e64	RTS
1008	.$e65	TABOUTCHANNEL
1009	.$e65	JSR INITOUTCHANNEL
1010	.$e68	LDA CHANNEL
1011	.$e6b	CMP #3  
1012	.$e6d	BEQ TABOUTSCREEN
1013	.$e6f	TABOUTCHANNEL2
1014	.$e6f	LDA IOCHANNEL
1015	.$e71	STA STORE1
1016	.$e74	LDA #1
1017	.$e76	STA IOCHANNEL  
1018	.$e78	LDX #10
1019	.$e7a	JMP EXITCHANNEL
1020	.$e7d	TABOUTSCREEN
1021	.$e7d	JSR CLRCHNEW
1022	.$e80	JMP TABOUT
1025	.$e83	EXITCHANNEL CLC
1026	.$e84	JSR TABSPC
1027	.$e87	JSR CLRCHNEW
1028	.$e8a	LDA STORE1
1029	.$e8d	STA IOCHANNEL
1030	.$e8f	RTS
1033	.$e90	NEXTWOFOR
1037	.$e90	LDX #$0A
1038	.$e92	JMP ERRALL
1041	.$e95	ILLEGALQUANTITY
1045	.$e95	JMP ERRIQ
1048	.$e98	XREGFAC  LDA X_REG+4
1049	.$e9a	STA FACLO
1050	.$e9c	LDA X_REG+3
1051	.$e9e	STA FACMO
1052	.$ea0	LDA X_REG+2
1053	.$ea2	STA FACMOH
1054	.$ea4	LDA X_REG+1
1055	.$ea6	STA FACSGN
1056	.$ea8	ORA #$80
1057	.$eaa	STA FACHO
1058	.$eac	LDA X_REG
1059	.$eae	STA FACEXP
1060	.$eb0	LDA #0
1061	.$eb2	STA FACOV
1062	.$eb4	RTS
1176	.$eb5	FASTFADDMEM
1177	.$eb5	JSR MEMARG
1178	.$eb8	FASTFADDARG
1179	.$eb8	BNE FADDRET2     
1180	.$eba	JMP ARGFAC
1181	.$ebd	FADDRET2 LDA ARGEXP
1182	.$ebf	BNE FADDRET1     
1183	.$ec1	RTS
1184	.$ec2	FADDRET1 SEC
1185	.$ec3	SBC FACEXP
1186	.$ec5	BEQ FFADD_EXPEQ     
1187	.$ec7	BCC FFADD_SHFARG1   
1191	.$ec9	LDY ARGEXP
1192	.$ecb	STY FACEXP
1193	.$ecd	LDY ARGSGN
1194	.$ecf	STY FACSGN
1195	.$ed1	LDX #0
1196	.$ed3	STX OLDOV        
1197	.$ed5	LDX #FAC         
1199	.$ed7	SEC
1200	.$ed8	SBC #$08
1201	.$eda	BMI FFADD_SHFFAC2
1203	.$edc	FFADD_SHFFAC1
1204	.$edc	LDY FACLO        
1205	.$ede	STY FACOV
1206	.$ee0	LDY FACMO        
1207	.$ee2	STY FACMO+1
1208	.$ee4	LDY FACMOH       
1209	.$ee6	STY FACMOH+1
1210	.$ee8	LDY FACHO        
1211	.$eea	STY FACHO+1
1212	.$eec	LDY #0
1213	.$eee	STY FACHO        
1214	.$ef0	SBC #$08         
1215	.$ef2	BPL FFADD_SHFFAC1   
1216	.$ef4	FFADD_SHFFAC2
1217	.$ef4	ADC #$08         
1218	.$ef6	BEQ FFADD_SHFFAC4   
1219	.$ef8	TAY
1220	.$ef9	LDA FACOV
1221	.$efb	FFADD_SHFFAC3
1222	.$efb	LSR FACHO        
1223	.$efd	ROR FACMOH       
1224	.$eff	ROR FACMO        
1225	.$f01	ROR FACLO        
1226	.$f03	ROR              
1227	.$f04	DEY
1228	.$f05	BNE FFADD_SHFFAC3
1229	.$f07	JMP FFADD_MANADD2   
1230	.$f0a	FFADD_SHFFAC4
1231	.$f0a	LDA FACOV        
1232	.$f0c	JMP FFADD_MANADD2
1233	.$f0f	FFADD_EXPEQ
1234	.$f0f	LDX FACOV
1235	.$f11	STX OLDOV
1238	.$f13	JMP FFADD_MANADD1
1239	.$f16	FFADD_SHFARG2
1240	.$f16	LDA FACOV        
1241	.$f18	JMP FFADD_MANADD1
1242	.$f1b	FFADD_SHFARG1
1243	.$f1b	LDX FACOV
1244	.$f1d	STX OLDOV        
1245	.$f1f	LDX #$00         
1248	.$f21	ADC #$08
1249	.$f23	BPL FFADD_SHFARG6   
1250	.$f25	FFADD_SHFARG3
1251	.$f25	LDX ARGLO        
1252	.$f27	LDY ARGMO        
1253	.$f29	STY ARGMO+1
1254	.$f2b	LDY ARGMOH       
1255	.$f2d	STY ARGMOH+1
1256	.$f2f	LDY ARGHO        
1257	.$f31	STY ARGHO+1
1258	.$f33	LDY #0
1259	.$f35	STY ARGHO        
1260	.$f37	FFADD_SHFARG4
1261	.$f37	ADC #$08
1262	.$f39	BMI FFADD_SHFARG3
1263	.$f3b	BEQ FFADD_SHFARG3
1264	.$f3d	FFADD_SHFARG6
1265	.$f3d	SBC #$08
1266	.$f3f	BEQ FFADD_SHFARG2   
1267	.$f41	TAY
1268	.$f42	TXA              
1269	.$f43	FFADD_SHFARG5
1270	.$f43	LSR ARGHO
1271	.$f45	ROR ARGMOH
1272	.$f47	ROR ARGMO
1273	.$f49	ROR ARGLO
1274	.$f4b	ROR           
1275	.$f4c	INY
1276	.$f4d	BNE FFADD_SHFARG5
1277	.$f4f	FFADD_MANADD1
1278	.$f4f	LDX #ARGEXP      
1279	.$f51	FFADD_MANADD2
1280	.$f51	BIT ARISGN
1281	.$f53	BMI FFADD_MANSUB1   
1282	.$f55	CLC
1283	.$f56	ADC OLDOV
1284	.$f58	STA FACOV
1285	.$f5a	LDA FACLO
1286	.$f5c	ADC ARGLO
1287	.$f5e	STA FACLO
1288	.$f60	LDA FACMO
1289	.$f62	ADC ARGMO
1290	.$f64	STA FACMO
1291	.$f66	LDA FACMOH
1292	.$f68	ADC ARGMOH
1293	.$f6a	STA FACMOH
1294	.$f6c	LDA FACHO
1295	.$f6e	ADC ARGHO
1296	.$f70	STA FACHO
1297	.$f72	BCC FFADD_RNDRTS
1298	.$f74	INC FACEXP
1299	.$f76	BEQ FFADD_OVERR
1301	.$f78	ROR FACHO
1302	.$f7a	ROR FACMOH
1303	.$f7c	ROR FACMO
1304	.$f7e	ROR FACLO
1305	.$f80	ROR FACOV
1306	.$f82	FFADD_RNDRTS
1307	.$f82	RTS
1308	.$f83	FFADD_OVERR
1309	.$f83	JMP ILLEGALQUANTITY
1310	.$f86	FFADD_MANSUB1
1311	.$f86	LDY #FACEXP
1312	.$f88	CPX #ARGEXP
1313	.$f8a	BEQ FFADD_MANSUB2
1314	.$f8c	LDY #ARGEXP
1315	.$f8e	FFADD_MANSUB2
1316	.$f8e	SEC              
1317	.$f8f	EOR #$FF
1318	.$f91	ADC OLDOV
1319	.$f93	STA FACOV
1320	.$f95	LDA 4,Y
1321	.$f98	SBC 4,X
1322	.$f9a	STA FACLO
1323	.$f9c	LDA 3,Y
1324	.$f9f	SBC 3,X
1325	.$fa1	STA FACMO
1326	.$fa3	LDA 2,Y
1327	.$fa6	SBC 2,X
1328	.$fa8	STA FACMOH
1329	.$faa	LDA 1,Y
1330	.$fad	SBC 1,X
1331	.$faf	STA FACHO
1332	.$fb1	BCS FCNORMAL
1333	.$fb3	LDA FACSGN
1334	.$fb5	EOR #$FF
1335	.$fb7	STA FACSGN
1336	.$fb9	LDA FACHO
1337	.$fbb	EOR #$FF
1338	.$fbd	STA FACHO
1339	.$fbf	LDA FACMOH
1340	.$fc1	EOR #$FF
1341	.$fc3	STA FACMOH
1342	.$fc5	LDA FACMO
1343	.$fc7	EOR #$FF
1344	.$fc9	STA FACMO
1345	.$fcb	LDA FACLO
1346	.$fcd	EOR #$FF
1347	.$fcf	STA FACLO
1348	.$fd1	LDA FACOV
1349	.$fd3	EOR #$FF
1350	.$fd5	CLC
1351	.$fd6	ADC #1
1352	.$fd8	STA FACOV
1353	.$fda	BNE FCNORMAL
1354	.$fdc	INC FACLO
1355	.$fde	BNE FCNORMAL
1356	.$fe0	INC FACMO
1357	.$fe2	BNE FCNORMAL
1358	.$fe4	INC FACMOH
1359	.$fe6	BNE FCNORMAL
1360	.$fe8	INC FACHO
1361	.$fea	FCNORMAL   BIT FACHO
1362	.$fec	BMI FFADD_RET       
1363	.$fee	LDA #0           
1364	.$ff0	CLC
1365	.$ff1	FFADD_NORM3
1366	.$ff1	LDX FACHO
1367	.$ff3	BNE FFADD_NORM1
1368	.$ff5	LDX FACHO+1
1369	.$ff7	STX FACHO
1370	.$ff9	LDX FACMOH+1
1371	.$ffb	STX FACMOH
1372	.$ffd	LDX FACMO+1
1373	.$fff	STX FACMO
1374	.$1001	LDX FACOV
1375	.$1003	STX FACLO
1376	.$1005	LDX #0
1377	.$1007	STX FACOV
1378	.$1009	ADC #$08
1379	.$100b	CMP #$20
1380	.$100d	BNE FFADD_NORM3
1381	.$100f	JMP FFADD_ZEROFAC
1382	.$1012	FFADD_NORM2
1383	.$1012	CLC
1384	.$1013	ADC #1
1385	.$1015	ASL FACOV
1386	.$1017	ROL FACLO
1387	.$1019	ROL FACMO
1388	.$101b	ROL FACMOH
1389	.$101d	ROL FACHO
1390	.$101f	FFADD_NORM1
1391	.$101f	BPL FFADD_NORM2     
1392	.$1021	SEC
1393	.$1022	SBC FACEXP
1394	.$1024	BCS FFADD_ZEROFAC
1395	.$1026	EOR #$FF
1396	.$1028	CLC
1397	.$1029	ADC #1
1398	.$102b	STA FACEXP
1399	.$102d	FFADD_RET   RTS
1400	.$102e	FFADD_ZEROFAC
1401	.$102e	LDX #0
1402	.$1030	STX FACEXP
1403	.$1032	STX FACSGN
1404	.$1034	RTS
1407	.$1035	INITVARS
1408	.$1035	JSR INITSTRVARS
1409	.$1038	LDA #0
1410	.$103a	LDY #4
1411	.$103c	REALINITLOOP0:
1412	.$103c	STA VAR_I,Y
1413	.$103f	DEY
1414	.$1040	BMI REALLOOPEXIT0
1415	.$1042	JMP REALINITLOOP0
1416	.$1045	REALLOOPEXIT0:
1417	.$1045	RTS
1421	.$1046	CONSTANTS
1424	.$1046	CONST_0R .REAL 1.0
1427	.$104b	CONST_1R .REAL 10.0
1433	.$1050	CONST_3 .REAL -1.0
1436	.$1055	DATAS
1437	.$1055	.BYTE $FF
1439	.$1056	CONSTANTS_END
1442	.$1056	VARIABLES
1444	.$1056	VAR_I .REAL 0.0
1445	.$105b	STRINGVARS_START
1447	.$105b	VAR_TI$ .WORD EMPTYSTR
1448	.$105d	STRINGVARS_END
1449	.$105d	STRINGARRAYS_START
1450	.$105d	STRINGARRAYS_END
1451	.$105d	VARIABLES_END
1453	.$105d	Y_REG .REAL 0.0
1454	.$1062	C_REG .REAL 0.0
1455	.$1067	D_REG .REAL 0.0
1456	.$106c	E_REG .REAL 0.0
1457	.$1071	F_REG .REAL 0.0
1458	.$1076	A_REG .WORD 0
1459	.$1078	B_REG .WORD 0
1460	.$107a	CMD_NUM .BYTE 0
1461	.$107b	CHANNEL .BYTE 0
1462	.$107c	SP_SAVE .BYTE 0
1463	.$107d	TMP2_REG .WORD 0
1464	.$107f	TMP3_REG .WORD 0
1465	.$1081	TMP4_REG .WORD 0
1466	.$1083	AS_TMP .WORD 0
1467	.$1085	BPOINTER_TMP .WORD 0
1468	.$1087	BASICTEXTP .BYTE 0
1469	.$1088	STORE1 .WORD 0
1470	.$108a	STORE2 .WORD 0
1471	.$108c	STORE3 .WORD 0
1472	.$108e	STORE4 .WORD 0
1473	.$1090	GCSTART .WORD 0
1474	.$1092	GCLEN .WORD 0
1475	.$1094	GCWORK .WORD 0
1476	.$1096	INPUTLENGTH .BYTE 0
1477	.$1097	TMP_FREG .REAL 0
1478	.$109c	TMP2_FREG .REAL 0
1479	.$10a1	TMP_FLAG .BYTE 0
1480	.$10a2	INT_FLAG .BYTE 0
1481	.$10a3	REAL_CONST_ONE .REAL 1.0
1482	.$10a8	REAL_CONST_ZERO .REAL 0.0
1483	.$10ad	REAL_CONST_MINUS_ONE .REAL -1.0
1484	.$10b2	CHLOCKFLAG .BYTE 0
1485	.$10b3	EMPTYSTR .BYTE 0
1486	.$10b4	FPSTACKP .WORD FPSTACK
1487	.$10b6	FORSTACKP .WORD FORSTACK
1488	.$10b8	DATASP .WORD DATAS
1489	.$10ba	LASTVAR .WORD 0
1490	.$10bc	LASTVARP .WORD 0
1491	.$10be	HIGHP .WORD STRBUF
1492	.$10c0	STRBUFP .WORD STRBUF
1493	.$10c2	ENDSTRBUF .WORD 0
1494	.$10c4	INPUTQUEUEP .BYTE 0
1495	.$10c5	PROGRAMEND
1496	.$10c5	INPUTQUEUE .ARRAY $0F
1497	.$10d4	FPSTACK .ARRAY 100
1498	.$1138	FORSTACK .ARRAY 340
1499	.$128c	STRBUF .BYTE 0

PROGRAMSTART:
JSR START
0:
NOP
MOV A,#{clr}{down}  division 2000{down}{STRING}
JSR STROUT
JSR LINEBREAK
NOP
INPUT0:
JSR CLEARQUEUE
JSR COMPACTMAX
MOV A,#  {STRING}
JSR STROUT
JSR QMARKOUT1
JSR INPUTNUMBER
CMP X,#0{REAL}
JE INPUT0_0
MOV A,#?redo from start{STRING}
JSR STROUT
JSR LINEBREAK
JMP INPUT0
INPUT0_0:
JSR INPUTLENGTHCHECK
JE EMPTYINPUTSKIP1
MOV X{REAL},Y
EMPTYINPUTSKIP1:
JSR QUEUESIZE
CMP X,#0{REAL}
JE INPUTCHECK0
JSR EXTRAIGNORED
INPUTCHECK0:
1:
NOP
INPUT1:
JSR CLEARQUEUE
JSR COMPACTMAX
MOV A,#  {96*37}    {STRING}
JSR STROUT
JSR QMARKOUT1
JSR INPUTNUMBER
CMP X,#0{REAL}
JE INPUT1_0
MOV A,#?redo from start{STRING}
JSR STROUT
JSR LINEBREAK
JMP INPUT1
INPUT1_0:
JSR INPUTLENGTHCHECK
JE EMPTYINPUTSKIP2
MOV Y{REAL},Y
EMPTYINPUTSKIP2:
JSR QUEUESIZE
CMP X,#0{REAL}
JE INPUTCHECK1
JSR EXTRAIGNORED
INPUTCHECK1:
2:
NOP
MOV Y,Y{REAL}
INT X,Y
MOV Y,X
MOV X,Y{REAL}
NEQ X,Y
CMP X,#0{REAL}
JNE NSKIP0
JMP SKIP0
NSKIP0:
NOP
MOV X,X{REAL}
MOV A,#3{INTEGER}
MOV Y,X
SHL X,A
MOV A,#1{INTEGER}
SHL Y,A
ADD X,Y
MOV X{REAL},X
NOP
MOV X,Y{REAL}
MOV A,#3{INTEGER}
MOV Y,X
SHL X,A
MOV A,#1{INTEGER}
SHL Y,A
ADD X,Y
MOV Y{REAL},X
JMP 2
NOP
SKIP0:
3:
NOP
MOV Y,#2000{INTEGER}
MOV X,Y{REAL}
GT X,Y
CMP X,#0{REAL}
JNE NSKIP1
JMP SKIP1
NSKIP1:
NOP
MOV A,#{down} (bis 2000 stellen periodenerkennung){STRING}
JSR STROUT
JSR LINEBREAK
NOP
SKIP1:
4:
NOP
MOV B,#000000{STRING}
MOV TI${STRING},B
5:
NOP
MOV Y,Y{REAL}
MOV X,X{REAL}
DIV X,Y
MOV Y,X
INT X,Y
MOV N{REAL},X
NOP
MOV Y,N{REAL}
MOV X,Y{REAL}
MUL X,Y
MOV Y,X
MOV X,X{REAL}
SUB X,Y
MOV X{REAL},X
NOP
MOV Y,M{REAL}
PUSH Y
NOP
POP X
MOV Y,X{REAL}
MOV G,R[]{REAL}
JSR ARRAYSTORE
NOP
MOVB X,211
MOV Y,#40{INTEGER}
EQ X,Y
PUSH X
MOVB X,211
MOV Y,#0{INTEGER}
EQ X,Y
POP Y
OR X,Y
CMP X,#0{REAL}
JNE NSKIP2
JMP SKIP2
NSKIP2:
NOP
MOV A,#{down}{STRING}
JSR STROUT
NOP
SKIP2:
6:
NOP
JSR COMPACTMAX
MOV Y,#1{INTEGER}
PUSH Y
MOV Y,N{REAL}
CHGCTX #1
JSR STR
MOV B,A
CHGCTX #0
JSR LEN
POP Y
SUB X,Y
PUSH X
MOV Y,N{REAL}
CHGCTX #1
JSR STR
MOV B,A
POP C
JSR RIGHT
JSR STROUT
NOP
MOV Y,#0{INTEGER}
MOV X,K{REAL}
EQ X,Y
CMP X,#0{REAL}
JNE NSKIP3
JMP SKIP3
NSKIP3:
NOP
JSR COMPACTMAX
MOV Y,#46{INTEGER}
CHGCTX #1
JSR CHR
JSR STROUT
NOP
SKIP3:
7:
NOP
MOV Y,#0{INTEGER}
MOV X,M{REAL}
EQ X,Y
CMP X,#0{REAL}
JNE NSKIP4
JMP SKIP4
NSKIP4:
JMP 10
NOP
SKIP4:
8:
NOP
MOV Y,#0{INTEGER}
MOV F{REAL},Y
NOP
MOV Y,#1{INTEGER}
MOV X,M{REAL}
SUB X,Y
PUSH X
NOP
MOV Y,#1{INTEGER}
PUSH Y
MOV A,(F{REAL})
JSR INITFOR
NOP
MOV X,F{REAL}
MOV G,R[]{REAL}
CHGCTX #0
JSR ARRAYACCESS
PUSH X
MOV X,M{REAL}
MOV G,R[]{REAL}
CHGCTX #0
JSR ARRAYACCESS
POP Y
EQ X,Y
CMP X,#0{REAL}
JNE NSKIP5
JMP SKIP5
NSKIP5:
JMP 11
NOP
SKIP5:
9:
NOP
MOV A,#0{INTEGER}
JSR NEXT
CMP A,#0{INTEGER}
JE ($JUMP)
10:
NOP
MOV Y,#0{INTEGER}
MOV N{REAL},Y
NOP
MOV Y,#1{INTEGER}
MOV K{REAL},Y
NOP
MOV Y,#1{INTEGER}
MOV X,M{REAL}
ADD X,Y
MOV M{REAL},X
NOP
MOV X,X{REAL}
MOV A,#3{INTEGER}
MOV Y,X
SHL X,A
MOV A,#1{INTEGER}
SHL Y,A
ADD X,Y
MOV X{REAL},X
NOP
JMP 5
11:
NOP
MOV Y,#1{INTEGER}
MOV D{REAL},Y
NOP
MOV Y,F{REAL}
MOV X,M{REAL}
SUB X,Y
PUSH X
NOP
MOV Y,#1{INTEGER}
PUSH Y
MOV A,(D{REAL})
JSR INITFOR
NOP
MOV A,#{left}{STRING}
JSR STROUT
NOP
MOVB X,211
MOV Y,#79{INTEGER}
EQ X,Y
PUSH X
MOVB X,211
MOV Y,#39{INTEGER}
EQ X,Y
POP Y
OR X,Y
CMP X,#0{REAL}
JNE NSKIP6
JMP SKIP6
NSKIP6:
NOP
MOV A,#{up}{STRING}
JSR STROUT
NOP
SKIP6:
12:
NOP
MOV A,#0{INTEGER}
JSR NEXT
CMP A,#0{INTEGER}
JE ($JUMP)
NOP
MOV A,#{up}{STRING}
JSR STROUT
NOP
MOV Y,#1{INTEGER}
MOV D{REAL},Y
NOP
MOV Y,F{REAL}
MOV X,M{REAL}
SUB X,Y
PUSH X
NOP
MOV Y,#1{INTEGER}
PUSH Y
MOV A,(D{REAL})
JSR INITFOR
NOP
JSR COMPACTMAX
MOV Y,#95{INTEGER}
CHGCTX #1
JSR CHR
JSR STROUT
NOP
MOVB X,211
MOV Y,#40{INTEGER}
EQ X,Y
PUSH X
MOVB X,211
MOV Y,#0{INTEGER}
EQ X,Y
POP Y
OR X,Y
CMP X,#0{REAL}
JNE NSKIP7
JMP SKIP7
NSKIP7:
NOP
MOV A,#{down}{STRING}
JSR STROUT
NOP
SKIP7:
13:
NOP
MOV A,#0{INTEGER}
JSR NEXT
CMP A,#0{INTEGER}
JE ($JUMP)
NOP
MOV A,#{down*2}{STRING}
JSR STROUT
JSR LINEBREAK
NOP
MOV A,TI${STRING}
JSR STROUT
JSR LINEBREAK
NOP
MOVB 198,#0{INTEGER}
NOP
MOV Y,#198{INTEGER}
MOV X,#1{INTEGER}
WAIT0:
MOV D,(Y)
AND D,X
CMP D,#0{INTEGER}
JE WAIT0
NOP
JSR GETSTR
MOV K${STRING},A
NOP
JSR RUN
NOP
JSR END
RTS

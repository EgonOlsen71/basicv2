PROGRAMSTART:
JSR START
0:
NOP
JMP 1000
1:
NOP
MOV A,#directory{STRING}
JSR STROUT
JSR LINEBREAK
NOP
MOV Y,#1{INTEGER}
PUSH Y
MOV Y,#8{INTEGER}
PUSH Y
MOV Y,#0{INTEGER}
PUSH Y
MOV B,#${STRING}
MOV G,B
POP D
POP C
POP X
MOV Y,#4{INTEGER}
JSR OPEN
NOP
MOV C,#1{INTEGER}
JSR GETSTRCHANNEL
MOV A${STRING},A
JSR GETSTRCHANNEL
MOV A${STRING},A
NOP
JSR COMPACTMAX
MOV Y,#0{INTEGER}
CHGCTX #1
JSR CHR
JSR COPYSTR
MOV E${STRING},A
2:
NOP
MOV Y,#0{INTEGER}
MOV I{REAL},Y
NOP
MOV Y,#1{INTEGER}
PUSH Y
NOP
MOV Y,#0{INTEGER}
PUSH Y
MOV A,(I{REAL})
JSR INITFOR
NOP
MOV C,#1{INTEGER}
JSR GETSTRCHANNEL
MOV A${STRING},A
JSR GETSTRCHANNEL
MOV A${STRING},A
JSR GETSTRCHANNEL
MOV H${STRING},A
JSR GETSTRCHANNEL
MOV L${STRING},A
NOP
MOV Y,ST{REAL}
CMP Y,#0{REAL}
JNE NSKIP0
JMP SKIP0
NSKIP0:
MOV X,#1{INTEGER}
JSR CLOSE
JMP RETURN
NOP
SKIP0:
3:
NOP
JSR COMPACTMAX
MOV Y,#62{INTEGER}
CHGCTX #1
JSR CHR
JSR STROUT
NOP
JSR COMPACTMAX
MOV B,E${STRING}
MOV A,L${STRING}
JSR CONCAT
MOV B,A
CHGCTX #0
JSR ASC
MOV A,#8{INTEGER}
SHL X,A
PUSH X
CHGCTX #1
MOV B,E${STRING}
MOV A,H${STRING}
JSR CONCAT
MOV B,A
CHGCTX #0
JSR ASC
POP Y
ADD X,Y
JSR INTOUT
JSR CRSRRIGHT
4:
NOP
MOV Y,#0{INTEGER}
MOV S{REAL},Y
NOP
MOV Y,#1{INTEGER}
PUSH Y
NOP
MOV Y,#1{INTEGER}
PUSH Y
MOV A,(S{REAL})
JSR INITFOR
NOP
MOV C,#1{INTEGER}
JSR GETSTRCHANNEL
MOV A${STRING},A
JSR GETSTRCHANNEL
MOV B${STRING},A
NOP
MOV B,B${STRING}
CHGCTX #0
JSR LEN
CMP X,#0{REAL}
JNE NSKIP1
JMP SKIP1
NSKIP1:
NOP
MOV A,A${STRING}
JSR STROUT
NOP
MOV A,B${STRING}
JSR STROUT
NOP
MOV Y,ST{REAL}
ABS X,Y
MOV S{REAL},X
MOV A,#0{INTEGER}
JSR NEXT
CMP A,#0{INTEGER}
JE ($JUMP)
NOP
SKIP1:
5:
NOP
MOV A,A${STRING}
JSR STROUT
JSR LINEBREAK
NOP
MOV A,(I{})
JSR NEXT
CMP A,#0{INTEGER}
JE ($JUMP)
1000:
NOP
JSR GOSUB
JSR 1
NOP
JSR END
RTS

117	.$818	TSX
118	.$819	STX SP_SAVE
120	.$81c	PROGRAMSTART:
121	.$81c	JSR START
123	.$81f	LINE_0:
125	.$81f	LDY #12
126	.$821	STY 53281
128	.$824	JSR POS
129	.$827	LDA #<CONST_1R
130	.$829	LDY #>CONST_1R
131	.$82b	JSR REALFAC
134	.$82e	LDA #<X_REG
135	.$830	LDY #>X_REG
137	.$832	JSR FASTFMULMEM
139	.$835	JSR FACXREG
141	.$838	LDA #<CONST_2R
142	.$83a	LDY #>CONST_2R
143	.$83c	JSR REALFAC
146	.$83f	LDA #<X_REG
147	.$841	LDY #>X_REG
149	.$843	JSR FACDIV
151	.$846	JSR FACXREG
153	.$849	JSR FACINT
154	.$84c	AND #$00
155	.$84e	TAX
156	.$84f	TYA
157	.$850	AND #$01
158	.$852	TAY
159	.$853	TXA
162	.$854	STY 199
163	.$856	JSR COMPACTMAX
164	.$859	JSR ONETOFAC
169	.$85c	JSR FACRND
170	.$85f	JSR FACXREG
171	.$862	LDY #2
172	.$864	STY A_REG
174	.$867	JSR SHL
176	.$86a	JSR FACXREG
178	.$86d	LDA #<CONST_3R
179	.$86f	LDY #>CONST_3R
180	.$871	JSR MEMARG
181	.$874	JSR FASTOR
185	.$877	JSR PUSHREAL
186	.$87a	LDA #<CONST_4R
187	.$87c	LDY #>CONST_4R
188	.$87e	JSR REALFACPUSH
191	.$881	LDA #<CONST_5
192	.$883	LDY #>CONST_5
193	.$885	STA B_REG
194	.$888	STY B_REG+1
195	.$88b	JSR POPREAL
196	.$88e	LDX #<D_REG
197	.$890	LDY #>D_REG
199	.$892	JSR FACMEM
200	.$895	JSR POPREAL
201	.$898	LDX #<C_REG
202	.$89a	LDY #>C_REG
204	.$89c	JSR FACMEM
205	.$89f	JSR MID
206	.$8a2	JSR STROUT
207	.$8a5	JMP LINE_0
208	.$8a8	JSR END
209	.$8ab	RTS
212	.$8ac	END   LDX SP_SAVE
213	.$8af	TXS
220	.$8b0	RTS
223	.$8b1	START  LDA ENDSTRBUF+1
224	.$8b4	BNE ENDGIVEN
225	.$8b6	LDA BASICEND
226	.$8b8	STA ENDSTRBUF
227	.$8bb	LDA BASICEND+1
228	.$8bd	STA ENDSTRBUF+1
229	.$8c0	ENDGIVEN LDA #<FPSTACK
230	.$8c2	LDY #>FPSTACK
231	.$8c4	STA FPSTACKP
232	.$8c7	STY FPSTACKP+1
233	.$8ca	LDA #<FORSTACK
234	.$8cc	LDY #>FORSTACK
235	.$8ce	STA FORSTACKP
236	.$8d1	STY FORSTACKP+1
237	.$8d4	LDA #<STRBUF
238	.$8d6	LDY #>STRBUF
239	.$8d8	STA STRBUFP
240	.$8db	STY STRBUFP+1
241	.$8de	STA HIGHP
242	.$8e1	STY HIGHP+1
243	.$8e4	LDA #0
244	.$8e6	STA CHLOCKFLAG
245	.$8e9	STA LASTVAR
246	.$8ec	STA LASTVAR+1
247	.$8ef	JSR INITVARS
248	.$8f2	LDA #0
249	.$8f4	STA CMD_NUM
250	.$8f7	STA CHANNEL
251	.$8fa	TAY
252	.$8fb	TAX
256	.$8fc	STA KEYNDX
262	.$8fe	JSR RESTORE
263	.$901	CLC
267	.$902	RTS
270	.$903	INITNARRAY
271	.$903	STA TMP_ZP
272	.$905	STY TMP_ZP+1
273	.$907	LDY #0
274	.$909	TYA
275	.$90a	NINITLOOP STA (TMP_ZP),Y
276	.$90c	INC TMP_ZP
277	.$90e	BNE NLOOPNOV
278	.$910	INC TMP_ZP+1
279	.$912	NLOOPNOV LDX TMP2_ZP
280	.$914	BNE NLOOPNOV2
281	.$916	DEC TMP2_ZP+1
282	.$918	NLOOPNOV2 DEC TMP2_ZP
283	.$91a	BNE NINITLOOP
284	.$91c	LDX TMP2_ZP+1
285	.$91e	BNE NINITLOOP
286	.$920	RTS
289	.$921	INITSTRARRAY
290	.$921	STA TMP_ZP
291	.$923	STY TMP_ZP+1
292	.$925	SINITLOOP LDY #0
293	.$927	LDA #<EMPTYSTR
294	.$929	STA (TMP_ZP),Y
295	.$92b	LDA #>EMPTYSTR
296	.$92d	INY
297	.$92e	STA (TMP_ZP),Y
298	.$930	CLC
299	.$931	LDA TMP_ZP
300	.$933	ADC #2
301	.$935	STA TMP_ZP
302	.$937	BCC SLOOPNOV1
303	.$939	INC TMP_ZP+1
304	.$93b	SLOOPNOV1 SEC
305	.$93c	LDA TMP2_ZP
306	.$93e	SBC #2
307	.$940	STA TMP2_ZP
308	.$942	BCS SLOOPNOV2
309	.$944	DEC TMP2_ZP+1
310	.$946	SLOOPNOV2 LDA TMP2_ZP
311	.$948	BNE SINITLOOP
312	.$94a	LDA TMP2_ZP+1
313	.$94c	BNE SINITLOOP
314	.$94e	RTS
317	.$94f	INITSPARAMS STA TMP3_ZP
318	.$951	STY TMP3_ZP+1
319	.$953	SEC
320	.$954	SBC #2
321	.$956	STA TMP_ZP
322	.$958	TYA
323	.$959	SBC #0
324	.$95b	STA TMP_ZP+1
325	.$95d	LDY #0
326	.$95f	LDA (TMP_ZP),Y
327	.$961	STA TMP2_ZP
328	.$963	INY
329	.$964	LDA (TMP_ZP),Y
330	.$966	STA TMP2_ZP+1
331	.$968	LDA TMP3_ZP
332	.$96a	LDY TMP3_ZP+1
333	.$96c	RTS
336	.$96d	INITSTRVARS LDA #<STRINGVARS_START  
337	.$96f	LDY #>STRINGVARS_START
338	.$971	CMP #<STRINGVARS_END
339	.$973	BNE INITIT1
340	.$975	CPY #>STRINGVARS_END
341	.$977	BNE INITIT1
342	.$979	JMP INITSA2     
343	.$97c	INITIT1  STA TMP_ZP
344	.$97e	STY TMP_ZP+1
345	.$980	LDY #0
346	.$982	INITSTRLOOP LDA #<EMPTYSTR
347	.$984	STA (TMP_ZP),Y
348	.$986	INY
349	.$987	LDA #>EMPTYSTR
350	.$989	STA (TMP_ZP),Y
351	.$98b	DEY
352	.$98c	LDA TMP_ZP
353	.$98e	CLC
354	.$98f	ADC #2
355	.$991	STA TMP_ZP
356	.$993	LDA TMP_ZP+1
357	.$995	ADC #0
358	.$997	STA TMP_ZP+1
359	.$999	CMP #>STRINGVARS_END
360	.$99b	BNE INITSTRLOOP
361	.$99d	LDA TMP_ZP
362	.$99f	CMP #<STRINGVARS_END
363	.$9a1	BNE INITSTRLOOP
364	.$9a3	INITSA2  LDA #<STRINGARRAYS_START 
365	.$9a5	LDY #>STRINGARRAYS_START
366	.$9a7	CMP #<STRINGARRAYS_END
367	.$9a9	BNE ARRAYLOOP
368	.$9ab	CPY #>STRINGARRAYS_END
369	.$9ad	BNE ARRAYLOOP
370	.$9af	RTS       
371	.$9b0	ARRAYLOOP CLC
372	.$9b1	ADC #3
373	.$9b3	BCC ARRAYSKIP1
374	.$9b5	INY
375	.$9b6	ARRAYSKIP1 CPY #>STRINGARRAYS_END
376	.$9b8	BEQ ARRAYSC
377	.$9ba	BCC ARRAYSKIP2
378	.$9bc	JMP ARRAYQUIT
379	.$9bf	ARRAYSC  CMP #<STRINGARRAYS_END
380	.$9c1	BCS ARRAYQUIT
381	.$9c3	ARRAYSKIP2 STA TMP_REG
382	.$9c5	STY TMP_REG+1
383	.$9c7	JSR INITSPARAMS
384	.$9ca	LDA TMP_REG
385	.$9cc	LDY TMP_REG+1
386	.$9ce	JSR INITSTRARRAY
387	.$9d1	LDA TMP_ZP
388	.$9d3	LDY TMP_ZP+1
389	.$9d5	JMP ARRAYLOOP
390	.$9d8	ARRAYQUIT RTS
393	.$9d9	RESTORE  LDA #<DATAS
394	.$9db	LDY #>DATAS
395	.$9dd	STA DATASP
396	.$9e0	STY DATASP+1
397	.$9e3	RTS
400	.$9e4	MID   LDA #<D_REG
401	.$9e6	LDY #>D_REG
402	.$9e8	JSR REALFAC
403	.$9eb	JSR SGNFAC
404	.$9ee	ROL
405	.$9ef	BCC MIDLENGTH  
406	.$9f1	MIDNEGC  JSR STRFUNCINT  
407	.$9f4	LDA TMP_REG   
408	.$9f6	STA TMP_REG+1
409	.$9f8	BNE MIDOK2
410	.$9fa	JMP ILLEGALQUANTITY 
411	.$9fd	MIDOK2  DEC TMP_REG+1  
412	.$9ff	LDA (TMP_ZP),Y
413	.$a01	SEC
414	.$a02	SBC TMP_REG+1
415	.$a04	STA TMP_REG   
416	.$a06	BCS MIDNOV2
417	.$a08	STY TMP_REG   
418	.$a0a	JMP MIDNOV2
419	.$a0d	MIDLENGTH JSR FACWORD
420	.$a10	MIDCONST STY TMP2_REG  
421	.$a13	JSR STRFUNCINT
422	.$a16	LDA TMP_REG   
423	.$a18	BNE MIDOK
424	.$a1a	JMP ILLEGALQUANTITY 
425	.$a1d	MIDOK  LDX TMP2_REG
426	.$a20	STX TMP_REG   
427	.$a22	STA TMP_REG+1
428	.$a24	DEC TMP_REG+1  
429	.$a26	MIDNOV
430	.$a26	MIDNOV2  LDA TMP_REG+1  
431	.$a28	CLC
432	.$a29	ADC TMP_REG   
433	.$a2b	BCS MIDCLAMP
434	.$a2d	CMP (TMP_ZP),Y
435	.$a2f	BCS MIDCLAMP
436	.$a31	MIDCOPY  JMP STRFUNC
437	.$a34	MIDCLAMP LDA (TMP_ZP),Y  
438	.$a36	SEC
439	.$a37	SBC TMP_REG+1
440	.$a39	STA TMP_REG
441	.$a3b	BCS MIDCOPY
442	.$a3d	STY TMP_REG
443	.$a3f	JMP MIDCOPY
446	.$a42	STRFUNCINT  LDA B_REG   
447	.$a45	STA TMP_ZP
448	.$a47	LDA B_REG+1
449	.$a4a	STA TMP_ZP+1
450	.$a4c	LDA #<C_REG
451	.$a4e	LDY #>C_REG
452	.$a50	JSR REALFAC
453	.$a53	JSR FACWORD
454	.$a56	STY TMP_REG   
455	.$a58	LDY #0
456	.$a5a	RTS
463	.$a5b	STRFUNC  LDA TMP_REG+1
464	.$a5d	BEQ STARTATZERO
465	.$a5f	LDA TMP_ZP
466	.$a61	CLC
467	.$a62	ADC TMP_REG+1
468	.$a64	STA TMP_ZP
469	.$a66	BCC STARTATZERO
470	.$a68	INC TMP_ZP+1
471	.$a6a	STARTATZERO LDY #0
472	.$a6c	LDA (TMP_ZP),Y
473	.$a6e	PHA     
474	.$a6f	LDA TMP_REG
475	.$a71	BNE STRFUNCNZ
476	.$a73	LDA #<EMPTYSTR
477	.$a75	STA A_REG
478	.$a78	LDA #>EMPTYSTR
479	.$a7a	STA A_REG+1
480	.$a7d	PLA     
483	.$a7e	JMP EXITSTRFUNC
484	.$a81	STRFUNCNZ STA (TMP_ZP),Y
485	.$a83	LDA #<A_REG
486	.$a85	LDY #>A_REG
487	.$a87	STA TMP2_ZP
488	.$a89	STY TMP2_ZP+1
489	.$a8b	LDX TMP_REG   
490	.$a8d	JSR COPYONLY
491	.$a90	PLA
492	.$a91	LDY #0
493	.$a93	STA (TMP_ZP),Y  
494	.$a95	EXITSTRFUNC RTS
497	.$a96	SAVEPOINTERS
498	.$a96	LDA TMP_ZP   
499	.$a98	STA STORE1
500	.$a9b	LDA TMP_ZP+1
501	.$a9d	STA STORE1+1
502	.$aa0	LDA TMP2_ZP
503	.$aa2	STA STORE2
504	.$aa5	LDA TMP2_ZP+1
505	.$aa7	STA STORE2+1
506	.$aaa	LDA TMP3_ZP
507	.$aac	STA STORE3
508	.$aaf	LDA TMP3_ZP+1
509	.$ab1	STA STORE3+1
510	.$ab4	RTS
513	.$ab5	RESTOREPOINTERS
514	.$ab5	LDA STORE3+1  
515	.$ab8	STA TMP3_ZP+1
516	.$aba	LDA STORE3
517	.$abd	STA TMP3_ZP
518	.$abf	LDA STORE2+1
519	.$ac2	STA TMP2_ZP+1
520	.$ac4	LDA STORE2
521	.$ac7	STA TMP2_ZP
522	.$ac9	LDA STORE1+1
523	.$acc	STA TMP_ZP+1
524	.$ace	LDA STORE1
525	.$ad1	STA TMP_ZP
526	.$ad3	RTS
533	.$ad4	COMPACTMAX
534	.$ad4	LDA #$FF
535	.$ad6	LDY #$0
536	.$ad8	JMP COMPACTF
539	.$adb	COMPACT
540	.$adb	LDY #0
541	.$add	GCBUFNE  LDA (TMP_ZP),Y  
542	.$adf	COMPACTF STA TMP4_REG  
543	.$ae2	LDY STRBUFP+1  
544	.$ae5	STY TMP4_REG+1  
545	.$ae8	INY     
546	.$ae9	BEQ ENDMEM   
547	.$aeb	CPY ENDSTRBUF+1  
548	.$aee	BCC RGCEXIT   
549	.$af0	ENDMEM  LDA STRBUFP
550	.$af3	CLC
551	.$af4	ADC TMP4_REG
552	.$af7	STA TMP4_REG
553	.$afa	BCC RGCNOOV1
554	.$afc	INC TMP4_REG+1
555	.$aff	RGCNOOV1 CLC
556	.$b00	LDA TMP4_REG
557	.$b03	ADC #3
558	.$b05	STA TMP4_REG
559	.$b08	BCC RGCNOOV2
560	.$b0a	INC TMP4_REG+1
561	.$b0d	RGCNOOV2 LDA TMP4_REG+1  
562	.$b10	CMP ENDSTRBUF+1
563	.$b13	BEQ RGCLOW1
564	.$b15	BCS GCEXECOMP  
565	.$b17	JMP RGCEXIT
566	.$b1a	RGCLOW1  LDA TMP4_REG
567	.$b1d	CMP ENDSTRBUF
568	.$b20	BCS GCEXECOMP  
569	.$b22	RGCEXIT  RTS     
570	.$b23	GCEXECOMP LDA STRBUFP
571	.$b26	STA STORE4
572	.$b29	LDA STRBUFP+1
573	.$b2c	STA STORE4+1
574	.$b2f	JSR GCEXE
575	.$b32	JMP CHECKMEMORY
578	.$b35	GCEXE  JSR SAVEPOINTERS
579	.$b38	LDA #0
580	.$b3a	STA LASTVAR
581	.$b3d	STA LASTVAR+1  
582	.$b40	LDA #<STRBUF
583	.$b42	STA TMP_ZP
584	.$b44	STA GCSTART
585	.$b47	LDA #>STRBUF
586	.$b49	STA TMP_ZP+1  
587	.$b4b	STA GCSTART+1
588	.$b4e	GCLOOP  LDY #0
589	.$b50	LDA TMP_ZP
590	.$b52	STA GCWORK
591	.$b55	LDA TMP_ZP+1
592	.$b57	STA GCWORK+1  
593	.$b5a	LDA (TMP_ZP),Y
594	.$b5c	STA GCLEN   
595	.$b5f	INC TMP_ZP
596	.$b61	BNE GCLOOPNOOV
597	.$b63	INC TMP_ZP+1
598	.$b65	GCLOOPNOOV LDA TMP_ZP
599	.$b67	CLC
600	.$b68	ADC GCLEN
601	.$b6b	STA TMP_ZP
602	.$b6d	BCC GCLOOPNOOV2
603	.$b6f	INC TMP_ZP+1  
604	.$b71	GCLOOPNOOV2 LDY #0
605	.$b73	LDA (TMP_ZP),Y
606	.$b75	STA TMP2_ZP
607	.$b77	INY
608	.$b78	LDA (TMP_ZP),Y
609	.$b7a	STA TMP2_ZP+1  
610	.$b7c	LDA TMP_ZP
611	.$b7e	CLC
612	.$b7f	ADC #2
613	.$b81	STA TMP_ZP
614	.$b83	BCC GCLOOPNOOV3
615	.$b85	INC TMP_ZP+1  
616	.$b87	GCLOOPNOOV3 LDY #0
617	.$b89	LDA (TMP2_ZP),Y
618	.$b8b	CMP GCWORK
619	.$b8e	BNE GCKLOOP
620	.$b90	INY
621	.$b91	LDA (TMP2_ZP),Y
622	.$b93	CMP GCWORK+1
623	.$b96	BEQ MEMFREE
624	.$b98	GCKLOOP  LDA TMP_ZP+1  
625	.$b9a	CMP HIGHP+1
626	.$b9d	BEQ GCHECKLOW
627	.$b9f	BCC GCLOOP
628	.$ba1	JMP GCDONE
629	.$ba4	GCHECKLOW LDA TMP_ZP
630	.$ba6	CMP HIGHP
631	.$ba9	BCS GCDONE
632	.$bab	JMP GCLOOP
633	.$bae	MEMFREE  LDA GCSTART   
634	.$bb1	CMP GCWORK   
635	.$bb4	BNE COPYDOWN
636	.$bb6	LDA GCSTART+1
637	.$bb9	CMP GCWORK+1
638	.$bbc	BNE COPYDOWN
639	.$bbe	LDA TMP_ZP   
640	.$bc0	STA GCSTART
641	.$bc3	LDA TMP_ZP+1
642	.$bc5	STA GCSTART+1
643	.$bc8	JMP GCKLOOP   
644	.$bcb	COPYDOWN LDA GCSTART   
645	.$bce	STA TMP_REG
646	.$bd0	LDA GCSTART+1
647	.$bd3	STA TMP_REG+1  
648	.$bd5	LDA GCWORK
649	.$bd8	STA TMP2_REG
650	.$bdb	LDA GCWORK+1
651	.$bde	STA TMP2_REG+1  
652	.$be1	LDA TMP_ZP
653	.$be3	SEC
654	.$be4	SBC GCWORK
655	.$be7	STA TMP3_REG
656	.$bea	LDA TMP_ZP+1
657	.$bec	SBC GCWORK+1
658	.$bef	STA TMP3_REG+1  
659	.$bf2	LDA GCSTART
660	.$bf5	CLC
661	.$bf6	ADC TMP3_REG
662	.$bf9	STA GCSTART
663	.$bfc	LDA GCSTART+1
664	.$bff	ADC TMP3_REG+1
665	.$c02	STA GCSTART+1  
666	.$c05	JSR QUICKCOPY  
667	.$c08	LDY #0
668	.$c0a	LDA TMP_REG
669	.$c0c	STA (TMP2_ZP),Y
670	.$c0e	INY
671	.$c0f	LDA TMP_REG+1
672	.$c11	STA (TMP2_ZP),Y  
673	.$c13	JMP GCKLOOP
674	.$c16	GCDONE  LDA GCSTART
675	.$c19	STA HIGHP
676	.$c1c	STA STRBUFP
677	.$c1f	LDA GCSTART+1
678	.$c22	STA HIGHP+1
679	.$c25	STA STRBUFP+1  
680	.$c28	GCSKIP  JSR RESTOREPOINTERS
681	.$c2b	RTS     
684	.$c2c	CHECKMEMORY
685	.$c2c	LDA STRBUFP+1  
686	.$c2f	CMP STORE4+1  
687	.$c32	BCC STILLFITSCM  
691	.$c34	BEQ CHECKMEMLOWCM
692	.$c36	JMP OUTOFMEMORY  
693	.$c39	CHECKMEMLOWCM
694	.$c39	LDA STRBUFP   
695	.$c3c	CMP STORE4
696	.$c3f	BCC STILLFITSCM
697	.$c41	JMP OUTOFMEMORY  
698	.$c44	STILLFITSCM RTS
701	.$c45	QUICKCOPY LDA TMP_REG  
702	.$c47	STA TMEM+1
703	.$c4a	LDA TMP_REG+1
704	.$c4c	STA TMEM+2
705	.$c4f	LDA TMP2_REG
706	.$c52	STA SMEM+1
707	.$c55	LDA TMP2_REG+1
708	.$c58	STA SMEM+2
709	.$c5b	LDY #$0
710	.$c5d	LDX TMP3_REG
711	.$c60	BNE QCLOOP
712	.$c62	LDA TMP3_REG+1
713	.$c65	BEQ QCEXIT  
714	.$c67	QCLOOP
715	.$c67	SMEM  LDA $0000,Y
716	.$c6a	TMEM  STA $0000,Y
717	.$c6d	INY
718	.$c6e	BNE YNOOV
719	.$c70	INC TMEM+2
720	.$c73	INC SMEM+2
721	.$c76	YNOOV  DEX
722	.$c77	BNE QCLOOP
723	.$c79	LDA TMP3_REG+1
724	.$c7c	BEQ QCEXIT
725	.$c7e	DEC TMP3_REG+1
726	.$c81	JMP QCLOOP
727	.$c84	QCEXIT  RTS
730	.$c85	COPYSTRING STA TMP2_ZP
731	.$c87	STY TMP2_ZP+1
732	.$c89	CPY TMP_ZP+1
733	.$c8b	BNE CONTCOPY
734	.$c8d	LDA TMP2_ZP
735	.$c8f	CMP TMP_ZP
736	.$c91	BNE CONTCOPY
737	.$c93	RTS     
738	.$c94	CONTCOPY JSR COMPACT   
739	.$c97	LDY #0
740	.$c99	STY TMP_FLAG
741	.$c9c	LDA (TMP_ZP),Y
742	.$c9e	BNE NOTEMPTYSTR
743	.$ca0	LDA #<EMPTYSTR  
744	.$ca2	STA TMP_ZP
745	.$ca4	LDA #>EMPTYSTR
746	.$ca6	STA TMP_ZP+1
747	.$ca8	JMP ISCONST
748	.$cab	NOTEMPTYSTR TAX     
749	.$cac	LDA (TMP2_ZP),Y
750	.$cae	STA TMP3_ZP
751	.$cb0	INY
752	.$cb1	LDA (TMP2_ZP),Y
753	.$cb3	STA TMP3_ZP+1
754	.$cb5	DEY
755	.$cb6	LDA TMP_ZP+1  
756	.$cb8	CMP #>CONSTANTS_END
757	.$cba	BEQ CHECKLOW1
758	.$cbc	BCS INVAR
759	.$cbe	JMP CHECKNEXT
760	.$cc1	CHECKLOW1 LDA TMP_ZP
761	.$cc3	CMP #<CONSTANTS_END
762	.$cc5	BCS INVAR
763	.$cc7	CHECKNEXT LDA TMP_ZP+1  
764	.$cc9	CMP #>CONSTANTS
765	.$ccb	BEQ CHECKLOW3
766	.$ccd	BCC INVAR
767	.$ccf	JMP ISCONST
768	.$cd2	CHECKLOW3 LDA TMP_ZP
769	.$cd4	CMP #<CONSTANTS
770	.$cd6	BCC INVAR   
771	.$cd8	ISCONST  JSR CHECKLASTVAR 
772	.$cdb	LDA TMP_ZP
773	.$cdd	STA (TMP2_ZP),Y  
774	.$cdf	INY
775	.$ce0	LDA TMP_ZP+1
776	.$ce2	STA (TMP2_ZP),Y
777	.$ce4	LDA HIGHP   
778	.$ce7	STA STRBUFP
779	.$cea	LDA HIGHP+1
780	.$ced	STA STRBUFP+1
781	.$cf0	RTS
782	.$cf1	INVAR  INY
783	.$cf2	LDA (TMP2_ZP),Y  
784	.$cf4	CMP #>CONSTANTS_END
785	.$cf6	BEQ CHECKLOW2
786	.$cf8	BCS INVAR2
787	.$cfa	JMP PUPDATEPTR
788	.$cfd	CHECKLOW2 DEY
789	.$cfe	LDA (TMP2_ZP),Y
790	.$d00	CMP #<CONSTANTS_END
791	.$d02	BCS INVAR2
792	.$d04	JMP PUPDATEPTR
793	.$d07	INVAR2  LDY #0   
794	.$d09	LDA (TMP3_ZP),Y
795	.$d0b	STA TMP_REG
796	.$d0d	TXA
797	.$d0e	CMP TMP_REG  
798	.$d10	BEQ UPDATEHP2 
801	.$d12	PUPDATEPTR JSR CHECKLASTVAR
802	.$d15	LDY #1   
803	.$d17	STY TMP_FLAG 
804	.$d1a	JMP UPDATEPTR 
805	.$d1d	UPDATEHP2 LDA HIGHP  
806	.$d20	STA STRBUFP
807	.$d23	LDA HIGHP+1
808	.$d26	STA STRBUFP+1
809	.$d29	JMP STRFITS
810	.$d2c	COPYONLY LDY #0
811	.$d2e	STY TMP_FLAG
812	.$d31	JMP CHECKMEM
813	.$d34	ALTCOPY  JMP COPYSTRING2
814	.$d37	UPDATEPTR LDA TMP_ZP+1 
815	.$d39	CMP HIGHP+1  
816	.$d3c	BEQ CHECKXT1
817	.$d3e	BCS ALTCOPY
818	.$d40	JMP CHECKMEM
819	.$d43	CHECKXT1 LDA TMP_ZP
820	.$d45	CMP HIGHP
821	.$d48	BCS ALTCOPY
822	.$d4a	CHECKMEM
823	.$d4a	MEMOK  LDY #0
824	.$d4c	LDA STRBUFP  
825	.$d4f	STA (TMP2_ZP),Y 
826	.$d51	STA TMP3_ZP
827	.$d53	LDA STRBUFP+1
828	.$d56	INY
829	.$d57	STA (TMP2_ZP),Y
830	.$d59	STA TMP3_ZP+1
831	.$d5b	TXA
832	.$d5c	CLC
833	.$d5d	ADC STRBUFP
834	.$d60	PHP
835	.$d61	CLC
836	.$d62	ADC #3
837	.$d64	STA STRBUFP
838	.$d67	BCC NOCS1
839	.$d69	INC STRBUFP+1
840	.$d6c	NOCS1  PLP
841	.$d6d	BCC STRFITS
842	.$d6f	INC STRBUFP+1
843	.$d72	STRFITS  LDY TMP_FLAG 
844	.$d75	BEQ NOHPUPDATE 
845	.$d77	LDA HIGHP+1
846	.$d7a	CMP STRBUFP+1
847	.$d7d	BCC UPDATEHIGHP
848	.$d7f	BEQ CHECKNEXTHP
849	.$d81	JMP NOHPUPDATE
850	.$d84	CHECKNEXTHP LDA HIGHP
851	.$d87	CMP STRBUFP
852	.$d8a	BCC UPDATEHIGHP
853	.$d8c	JMP NOHPUPDATE
854	.$d8f	UPDATEHIGHP LDA STRBUFP
855	.$d92	STA HIGHP
856	.$d95	LDA STRBUFP+1
857	.$d98	STA HIGHP+1  
858	.$d9b	JSR REMEMBERLASTVAR
859	.$d9e	JSR STOREVARREF
860	.$da1	NOHPUPDATE LDY #0
861	.$da3	LDA (TMP_ZP),Y 
862	.$da5	STA (TMP3_ZP),Y
863	.$da7	TAY    
864	.$da8	BEQ EXITCOPY 
865	.$daa	LOOP  LDA (TMP_ZP),Y 
866	.$dac	STA (TMP3_ZP),Y
867	.$dae	DEY
868	.$daf	BNE LOOP
869	.$db1	EXITCOPY RTS
874	.$db2	COPYSTRING2 LDY #0
875	.$db4	LDA (TMP_ZP),Y
876	.$db6	STA TMP_REG
877	.$db8	TAX
878	.$db9	LDA HIGHP
879	.$dbc	STA TMP3_ZP
880	.$dbe	STA (TMP2_ZP),Y
881	.$dc0	LDA HIGHP+1
882	.$dc3	STA TMP3_ZP+1
883	.$dc5	INY
884	.$dc6	STA (TMP2_ZP),Y
885	.$dc8	JSR REMEMBERLASTVAR
888	.$dcb	LDA TMP_ZP
889	.$dcd	CMP TMP3_ZP
890	.$dcf	BNE DOLOOP
891	.$dd1	LDA TMP_ZP+1
892	.$dd3	CMP TMP3_ZP+1
893	.$dd5	BEQ SKIPCP2
894	.$dd7	DOLOOP  DEY
895	.$dd8	TXA
896	.$dd9	STA (TMP3_ZP),Y
897	.$ddb	INY
898	.$ddc	ASLOOP  LDA (TMP_ZP),Y
899	.$dde	STA (TMP3_ZP),Y
900	.$de0	INY
901	.$de1	DEX
902	.$de2	BNE ASLOOP
903	.$de4	SKIPCP2  LDA HIGHP
904	.$de7	CLC
905	.$de8	ADC TMP_REG
906	.$dea	PHP
907	.$deb	CLC
908	.$dec	ADC #3
909	.$dee	STA HIGHP
910	.$df1	STA STRBUFP
911	.$df4	BCC SKIPLOWAS1
912	.$df6	INC HIGHP+1
913	.$df9	SKIPLOWAS1 PLP
914	.$dfa	BCC SKIPLOWAS2
915	.$dfc	INC HIGHP+1
916	.$dff	SKIPLOWAS2 LDA HIGHP+1
917	.$e02	STA STRBUFP+1
918	.$e05	JSR STOREVARREF
919	.$e08	RTS
923	.$e09	CHECKLASTVAR
924	.$e09	LDA TMP2_ZP
925	.$e0b	CMP LASTVAR
926	.$e0e	BNE NOTSAMEVAR
927	.$e10	LDA TMP2_ZP+1
928	.$e12	CMP LASTVAR+1
929	.$e15	BNE NOTSAMEVAR
930	.$e17	LDA LASTVARP   
931	.$e1a	STA HIGHP
932	.$e1d	STA STRBUFP
933	.$e20	LDA LASTVARP+1
934	.$e23	STA HIGHP+1
935	.$e26	STA STRBUFP+1
936	.$e29	NOTSAMEVAR RTS
940	.$e2a	REMEMBERLASTVAR
941	.$e2a	LDA TMP2_ZP
942	.$e2c	STA LASTVAR
943	.$e2f	LDA TMP2_ZP+1
944	.$e31	STA LASTVAR+1
945	.$e34	LDA TMP3_ZP
946	.$e36	STA LASTVARP
947	.$e39	LDA TMP3_ZP+1
948	.$e3b	STA LASTVARP+1 
949	.$e3e	RTS
954	.$e3f	STOREVARREF
955	.$e3f	TYA
956	.$e40	PHA    
957	.$e41	LDA TMP_ZP
958	.$e43	PHA
959	.$e44	LDA TMP_ZP+1
960	.$e46	PHA
961	.$e47	LDA HIGHP+1
962	.$e4a	STA TMP_ZP+1
963	.$e4c	LDA HIGHP
964	.$e4f	SEC
965	.$e50	SBC #2
966	.$e52	STA TMP_ZP
967	.$e54	BCS RLVNOOV
968	.$e56	DEC TMP_ZP+1
969	.$e58	RLVNOOV  LDA TMP2_ZP
970	.$e5a	LDY #0
971	.$e5c	STA (TMP_ZP),Y
972	.$e5e	LDA TMP2_ZP+1
973	.$e60	INY
974	.$e61	STA (TMP_ZP),Y 
975	.$e63	PLA
976	.$e64	STA TMP_ZP+1
977	.$e66	PLA
978	.$e67	STA TMP_ZP  
979	.$e69	PLA
980	.$e6a	TAY    
981	.$e6b	RTS
984	.$e6c	REROUTE  LDA CMD_NUM  
985	.$e6f	BEQ REROUTECMD
986	.$e71	TAX
987	.$e72	STA CHANNEL
988	.$e75	JMP CHKOUT
989	.$e78	REROUTECMD RTS
992	.$e79	RESETROUTE LDA CMD_NUM  
993	.$e7c	BEQ RESETROUTECMD
994	.$e7e	JMP CLRCHNEW
995	.$e81	RESETROUTECMD
996	.$e81	RTS
999	.$e82	STROUTWL STA A_REG
1000	.$e85	STY A_REG+1
1001	.$e88	STROUT  JSR REROUTE
1002	.$e8b	LDA A_REG
1003	.$e8e	STA INDEX1
1004	.$e90	LDA A_REG+1
1005	.$e93	STA INDEX1+1
1006	.$e95	LDY #0
1007	.$e97	LDA (INDEX1),Y
1008	.$e99	TAX
1009	.$e9a	INC INDEX1
1010	.$e9c	BNE PRINTSTR
1011	.$e9e	INC INDEX1+1
1012	.$ea0	PRINTSTR JSR PRINTSTRS
1013	.$ea3	LDA HIGHP   
1014	.$ea6	STA STRBUFP
1015	.$ea9	LDA HIGHP+1
1016	.$eac	STA STRBUFP+1
1017	.$eaf	JSR RESETROUTE
1018	.$eb2	RTS
1021	.$eb3	POS   SEC
1022	.$eb4	JSR CRSRPOS
1023	.$eb7	JSR BYTEFAC
1024	.$eba	JMP FACXREG
1027	.$ebd	REALFACPUSH STA TMP_ZP
1028	.$ebf	STY TMP_ZP+1
1029	.$ec1	LDX FPSTACKP
1030	.$ec4	LDY FPSTACKP+1
1031	.$ec7	STX TMP2_ZP
1032	.$ec9	STY TMP2_ZP+1
1033	.$ecb	LDY #0
1034	.$ecd	LDA (TMP_ZP),Y
1035	.$ecf	STA (TMP2_ZP),Y
1036	.$ed1	INY
1037	.$ed2	LDA (TMP_ZP),Y
1038	.$ed4	STA (TMP2_ZP),Y
1039	.$ed6	INY
1040	.$ed7	LDA (TMP_ZP),Y
1041	.$ed9	STA (TMP2_ZP),Y
1042	.$edb	INY
1043	.$edc	LDA (TMP_ZP),Y
1044	.$ede	STA (TMP2_ZP),Y
1045	.$ee0	INY
1046	.$ee1	LDA (TMP_ZP),Y
1047	.$ee3	STA (TMP2_ZP),Y
1048	.$ee5	TXA    
1049	.$ee6	CLC
1050	.$ee7	ADC #5
1051	.$ee9	STA FPSTACKP
1052	.$eec	BCC NOPVRFPXX
1053	.$eee	INC FPSTACKP+1
1054	.$ef1	NOPVRFPXX RTS
1057	.$ef2	PUSHREAL LDX FPSTACKP
1058	.$ef5	LDY FPSTACKP+1
1059	.$ef8	JSR FACMEM
1060	.$efb	LDA FPSTACKP
1061	.$efe	CLC
1062	.$eff	ADC #5
1063	.$f01	STA FPSTACKP
1064	.$f04	BCC NOPVPUR
1065	.$f06	INC FPSTACKP+1
1066	.$f09	NOPVPUR  RTS
1069	.$f0a	POPREAL  LDA FPSTACKP
1070	.$f0d	SEC
1071	.$f0e	SBC #5
1072	.$f10	STA FPSTACKP
1073	.$f13	BCS NOPVPR
1074	.$f15	DEC FPSTACKP+1
1075	.$f18	NOPVPR  LDA FPSTACKP
1076	.$f1b	LDY FPSTACKP+1
1077	.$f1e	JMP REALFAC
1080	.$f21	SHL   LDA FACEXP
1081	.$f23	BEQ SHLOK
1082	.$f25	CLC
1083	.$f26	ADC A_REG
1084	.$f29	BCC SHLOK
1085	.$f2b	LDA #0
1086	.$f2d	STA FACSGN
1087	.$f2f	STA FACLO
1088	.$f31	STA FACMO
1089	.$f33	STA FACMOH
1090	.$f35	STA FACHO
1091	.$f37	LDA #$FF
1092	.$f39	SHLOK  STA FACEXP
1093	.$f3b	RTS
1097	.$f3c	FACWORD
1098	.$f3c	LDA FACEXP   
1099	.$f3e	BNE DOFACWORD
1100	.$f40	STA FACSGN   
1101	.$f42	DOFACWORD:
1102	.$f42	JMP XFACWORD
1106	.$f45	ONETOFAC    LDX #129
1107	.$f47	STX FAC
1108	.$f49	DEX
1109	.$f4a	STX FAC+1
1110	.$f4c	LDX #0
1111	.$f4e	STX FAC+2
1112	.$f50	STX FAC+3
1113	.$f52	STX FAC+4
1114	.$f54	STX FAC+5
1115	.$f56	STX FAC+15
1116	.$f58	RTS
1119	.$f59	FASTOR  LDA FACEXP   
1120	.$f5b	BNE CHECKFACOR
1121	.$f5d	LDA ARGEXP   
1122	.$f5f	BNE CHECKARGOR 
1123	.$f61	LDA #0
1124	.$f63	STA FACSGN   
1125	.$f65	RTS    
1126	.$f66	CHECKFACOR LDA FACEXP   
1127	.$f68	CMP #$81
1128	.$f6a	BNE NORMALOR
1129	.$f6c	LDA FACHO
1130	.$f6e	CMP #$80
1131	.$f70	BNE NORMALOR
1132	.$f72	LDA FACMOH
1133	.$f74	BNE NORMALOR
1134	.$f76	LDA FACMO
1135	.$f78	BNE NORMALOR
1136	.$f7a	LDA FACLO
1137	.$f7c	BNE NORMALOR
1138	.$f7e	LDA FACSGN
1139	.$f80	ROL
1140	.$f81	BCC NORMALOR
1141	.$f83	CHECKARGOR LDA ARGEXP   
1142	.$f85	BNE CHECKARGOR2
1143	.$f87	RTS    
1144	.$f88	CHECKARGOR2 CMP #$81
1145	.$f8a	BNE NORMALOR
1146	.$f8c	LDA ARGHO
1147	.$f8e	CMP #$80
1148	.$f90	BNE NORMALOR
1149	.$f92	LDA ARGMOH
1150	.$f94	BNE NORMALOR
1151	.$f96	LDA ARGMO
1152	.$f98	BNE NORMALOR
1153	.$f9a	LDA ARGLO
1154	.$f9c	BNE NORMALOR
1155	.$f9e	LDA ARGSGN
1156	.$fa0	AND #$80
1157	.$fa2	CMP #$80
1158	.$fa4	BNE NORMALOR
1159	.$fa6	JMP ARGFAC  
1160	.$fa9	NORMALOR JMP FACOR
1163	.$fac	CLRCHNEW
1164	.$fac	LDA CHLOCKFLAG
1165	.$faf	BNE SKIPCLRCH
1166	.$fb1	JMP CLRCH
1167	.$fb4	SKIPCLRCH
1168	.$fb4	RTS
1171	.$fb5	OUTOFMEMORY
1175	.$fb5	LDX #$10
1176	.$fb7	JMP ERRALL
1179	.$fba	ILLEGALQUANTITY
1183	.$fba	JMP ERRIQ
1186	.$fbd	FACXREG  LDA FACLO
1187	.$fbf	STA X_REG+4
1188	.$fc1	LDA FACMO
1189	.$fc3	STA X_REG+3
1190	.$fc5	LDA FACMOH
1191	.$fc7	STA X_REG+2
1192	.$fc9	LDA FACSGN
1193	.$fcb	ORA #$7F
1194	.$fcd	AND FACHO
1195	.$fcf	STA X_REG+1
1196	.$fd1	LDA FACEXP
1197	.$fd3	STA X_REG
1198	.$fd5	LDA #0   
1199	.$fd7	STA FACOV
1200	.$fd9	RTS
1314	.$fda	FASTFADDMEM
1315	.$fda	JSR MEMARG
1316	.$fdd	FASTFADDARG
1317	.$fdd	BNE FADDRET2     
1318	.$fdf	JMP ARGFAC
1319	.$fe2	FADDRET2 LDA ARGEXP
1320	.$fe4	BNE FADDRET1     
1321	.$fe6	RTS
1322	.$fe7	FADDRET1 SEC
1323	.$fe8	SBC FACEXP
1324	.$fea	BEQ FFADD_EXPEQ     
1325	.$fec	BCC FFADD_SHFARG1   
1329	.$fee	LDY ARGEXP
1330	.$ff0	STY FACEXP
1331	.$ff2	LDY ARGSGN
1332	.$ff4	STY FACSGN
1333	.$ff6	LDX #0
1334	.$ff8	STX OLDOV        
1335	.$ffa	LDX #FAC         
1337	.$ffc	SEC
1338	.$ffd	SBC #$08
1339	.$fff	BMI FFADD_SHFFAC2
1341	.$1001	FFADD_SHFFAC1
1342	.$1001	LDY FACLO        
1343	.$1003	STY FACOV
1344	.$1005	LDY FACMO        
1345	.$1007	STY FACMO+1
1346	.$1009	LDY FACMOH       
1347	.$100b	STY FACMOH+1
1348	.$100d	LDY FACHO        
1349	.$100f	STY FACHO+1
1350	.$1011	LDY #0
1351	.$1013	STY FACHO        
1352	.$1015	SBC #$08         
1353	.$1017	BPL FFADD_SHFFAC1   
1354	.$1019	FFADD_SHFFAC2
1355	.$1019	ADC #$08         
1356	.$101b	BEQ FFADD_SHFFAC4   
1357	.$101d	TAY
1358	.$101e	LDA FACOV
1359	.$1020	FFADD_SHFFAC3
1360	.$1020	LSR FACHO        
1361	.$1022	ROR FACMOH       
1362	.$1024	ROR FACMO        
1363	.$1026	ROR FACLO        
1364	.$1028	ROR              
1365	.$1029	DEY
1366	.$102a	BNE FFADD_SHFFAC3
1367	.$102c	JMP FFADD_MANADD2   
1368	.$102f	FFADD_SHFFAC4
1369	.$102f	LDA FACOV        
1370	.$1031	JMP FFADD_MANADD2
1371	.$1034	FFADD_EXPEQ
1372	.$1034	LDX FACOV
1373	.$1036	STX OLDOV
1376	.$1038	JMP FFADD_MANADD1
1377	.$103b	FFADD_SHFARG2
1378	.$103b	LDA FACOV        
1379	.$103d	JMP FFADD_MANADD1
1380	.$1040	FFADD_SHFARG1
1381	.$1040	LDX FACOV
1382	.$1042	STX OLDOV        
1383	.$1044	LDX #$00         
1386	.$1046	ADC #$08
1387	.$1048	BPL FFADD_SHFARG6   
1388	.$104a	FFADD_SHFARG3
1389	.$104a	LDX ARGLO        
1390	.$104c	LDY ARGMO        
1391	.$104e	STY ARGMO+1
1392	.$1050	LDY ARGMOH       
1393	.$1052	STY ARGMOH+1
1394	.$1054	LDY ARGHO        
1395	.$1056	STY ARGHO+1
1396	.$1058	LDY #0
1397	.$105a	STY ARGHO        
1398	.$105c	FFADD_SHFARG4
1399	.$105c	ADC #$08
1400	.$105e	BMI FFADD_SHFARG3
1401	.$1060	BEQ FFADD_SHFARG3
1402	.$1062	FFADD_SHFARG6
1403	.$1062	SBC #$08
1404	.$1064	BEQ FFADD_SHFARG2   
1405	.$1066	TAY
1406	.$1067	TXA              
1407	.$1068	FFADD_SHFARG5
1408	.$1068	LSR ARGHO
1409	.$106a	ROR ARGMOH
1410	.$106c	ROR ARGMO
1411	.$106e	ROR ARGLO
1412	.$1070	ROR           
1413	.$1071	INY
1414	.$1072	BNE FFADD_SHFARG5
1415	.$1074	FFADD_MANADD1
1416	.$1074	LDX #ARGEXP      
1417	.$1076	FFADD_MANADD2
1418	.$1076	BIT ARISGN
1419	.$1078	BMI FFADD_MANSUB1   
1420	.$107a	CLC
1421	.$107b	ADC OLDOV
1422	.$107d	STA FACOV
1423	.$107f	LDA FACLO
1424	.$1081	ADC ARGLO
1425	.$1083	STA FACLO
1426	.$1085	LDA FACMO
1427	.$1087	ADC ARGMO
1428	.$1089	STA FACMO
1429	.$108b	LDA FACMOH
1430	.$108d	ADC ARGMOH
1431	.$108f	STA FACMOH
1432	.$1091	LDA FACHO
1433	.$1093	ADC ARGHO
1434	.$1095	STA FACHO
1435	.$1097	BCC FFADD_RNDRTS
1436	.$1099	INC FACEXP
1437	.$109b	BEQ FFADD_OVERR
1439	.$109d	ROR FACHO
1440	.$109f	ROR FACMOH
1441	.$10a1	ROR FACMO
1442	.$10a3	ROR FACLO
1443	.$10a5	ROR FACOV
1444	.$10a7	FFADD_RNDRTS
1445	.$10a7	RTS
1446	.$10a8	FFADD_OVERR
1447	.$10a8	JMP ILLEGALQUANTITY
1448	.$10ab	FFADD_MANSUB1
1449	.$10ab	LDY #FACEXP
1450	.$10ad	CPX #ARGEXP
1451	.$10af	BEQ FFADD_MANSUB2
1452	.$10b1	LDY #ARGEXP
1453	.$10b3	FFADD_MANSUB2
1454	.$10b3	SEC              
1455	.$10b4	EOR #$FF
1456	.$10b6	ADC OLDOV
1457	.$10b8	STA FACOV
1458	.$10ba	LDA 4,Y
1459	.$10bd	SBC 4,X
1460	.$10bf	STA FACLO
1461	.$10c1	LDA 3,Y
1462	.$10c4	SBC 3,X
1463	.$10c6	STA FACMO
1464	.$10c8	LDA 2,Y
1465	.$10cb	SBC 2,X
1466	.$10cd	STA FACMOH
1467	.$10cf	LDA 1,Y
1468	.$10d2	SBC 1,X
1469	.$10d4	STA FACHO
1470	.$10d6	BCS FCNORMAL
1471	.$10d8	LDA FACSGN
1472	.$10da	EOR #$FF
1473	.$10dc	STA FACSGN
1474	.$10de	LDA FACHO
1475	.$10e0	EOR #$FF
1476	.$10e2	STA FACHO
1477	.$10e4	LDA FACMOH
1478	.$10e6	EOR #$FF
1479	.$10e8	STA FACMOH
1480	.$10ea	LDA FACMO
1481	.$10ec	EOR #$FF
1482	.$10ee	STA FACMO
1483	.$10f0	LDA FACLO
1484	.$10f2	EOR #$FF
1485	.$10f4	STA FACLO
1486	.$10f6	LDA FACOV
1487	.$10f8	EOR #$FF
1488	.$10fa	CLC
1489	.$10fb	ADC #1
1490	.$10fd	STA FACOV
1491	.$10ff	BNE FCNORMAL
1492	.$1101	INC FACLO
1493	.$1103	BNE FCNORMAL
1494	.$1105	INC FACMO
1495	.$1107	BNE FCNORMAL
1496	.$1109	INC FACMOH
1497	.$110b	BNE FCNORMAL
1498	.$110d	INC FACHO
1499	.$110f	FCNORMAL   BIT FACHO
1500	.$1111	BMI FFADD_RET       
1501	.$1113	LDA #0           
1502	.$1115	CLC
1503	.$1116	FFADD_NORM3
1504	.$1116	LDX FACHO
1505	.$1118	BNE FFADD_NORM1
1506	.$111a	LDX FACHO+1
1507	.$111c	STX FACHO
1508	.$111e	LDX FACMOH+1
1509	.$1120	STX FACMOH
1510	.$1122	LDX FACMO+1
1511	.$1124	STX FACMO
1512	.$1126	LDX FACOV
1513	.$1128	STX FACLO
1514	.$112a	LDX #0
1515	.$112c	STX FACOV
1516	.$112e	ADC #$08
1517	.$1130	CMP #$20
1518	.$1132	BNE FFADD_NORM3
1519	.$1134	JMP FFADD_ZEROFAC
1520	.$1137	FFADD_NORM2
1521	.$1137	CLC
1522	.$1138	ADC #1
1523	.$113a	ASL FACOV
1524	.$113c	ROL FACLO
1525	.$113e	ROL FACMO
1526	.$1140	ROL FACMOH
1527	.$1142	ROL FACHO
1528	.$1144	FFADD_NORM1
1529	.$1144	BPL FFADD_NORM2     
1530	.$1146	SEC
1531	.$1147	SBC FACEXP
1532	.$1149	BCS FFADD_ZEROFAC
1533	.$114b	EOR #$FF
1534	.$114d	CLC
1535	.$114e	ADC #1
1536	.$1150	STA FACEXP
1537	.$1152	FFADD_RET   RTS
1538	.$1153	FFADD_ZEROFAC
1539	.$1153	LDX #0
1540	.$1155	STX FACEXP
1541	.$1157	STX FACSGN
1542	.$1159	RTS
1545	.$115a	FASTFMULMEM
1546	.$115a	JSR MEMARG
1547	.$115d	FASTFMULARG
1548	.$115d	BEQ FFMUL_MULTRT    
1549	.$115f	LDA ARGEXP
1550	.$1161	BEQ FFMUL_ZEREMV    
1551	.$1163	CLC
1552	.$1164	ADC FACEXP
1553	.$1166	BCC FFMUL_TRYOFF
1554	.$1168	CLC
1555	.$1169	BPL FFMUL_ADJUST
1556	.$116b	JMP ILLEGALQUANTITY
1557	.$116e	FFMUL_ZEREMV
1558	.$116e	LDY #0
1559	.$1170	STY FACEXP       
1560	.$1172	STY FACSGN
1561	.$1174	FFMUL_MULTRT
1562	.$1174	RTS
1563	.$1175	FFMUL_TRYOFF
1564	.$1175	BPL FFMUL_ZEREMV    
1565	.$1177	FFMUL_ADJUST
1566	.$1177	ADC #$80         
1567	.$1179	BEQ FFMUL_ZEREMV    
1568	.$117b	STA FACEXP
1569	.$117d	LDA ARISGN
1570	.$117f	STA FACSGN
1571	.$1181	LDY #0
1572	.$1183	STY RESHOP
1573	.$1185	STY RESHO
1574	.$1187	STY RESMOH
1575	.$1189	STY RESMO
1576	.$118b	STY RESLO
1577	.$118d	STY RESOV
1578	.$118f	STY FACHOP
1579	.$1191	FFMUL_B0
1580	.$1191	LSR ARGLO        
1581	.$1193	BCC FFMUL_B1
1582	.$1195	LDA RESOV
1583	.$1197	CLC
1584	.$1198	ADC FACMOH       
1585	.$119a	STA RESOV
1586	.$119c	LDA RESLO
1587	.$119e	ADC FACHO        
1588	.$11a0	STA RESLO
1589	.$11a2	LDA RESMO
1590	.$11a4	ADC FACHOP       
1591	.$11a6	STA RESMO
1592	.$11a8	BCC FFMUL_B1
1593	.$11aa	INC RESMOH
1594	.$11ac	BNE FFMUL_B1
1595	.$11ae	INC RESHO
1596	.$11b0	BNE FFMUL_B1
1597	.$11b2	INC RESHOP
1598	.$11b4	FFMUL_B1
1599	.$11b4	LSR ARGMO        
1600	.$11b6	BCC FFMUL_B2
1601	.$11b8	LDA RESOV
1602	.$11ba	CLC
1603	.$11bb	ADC FACMO        
1604	.$11bd	STA RESOV
1605	.$11bf	LDA RESLO
1606	.$11c1	ADC FACMOH       
1607	.$11c3	STA RESLO
1608	.$11c5	LDA RESMO
1609	.$11c7	ADC FACHO        
1610	.$11c9	STA RESMO
1611	.$11cb	LDA RESMOH
1612	.$11cd	ADC FACHOP       
1613	.$11cf	STA RESMOH
1614	.$11d1	BCC FFMUL_B2
1615	.$11d3	INC RESHO
1616	.$11d5	BNE FFMUL_B2
1617	.$11d7	INC RESHOP
1618	.$11d9	FFMUL_B2
1619	.$11d9	LSR ARGMOH       
1620	.$11db	BCC FFMUL_B3
1621	.$11dd	LDA RESOV
1622	.$11df	CLC
1623	.$11e0	ADC FACLO        
1624	.$11e2	STA RESOV
1625	.$11e4	LDA RESLO
1626	.$11e6	ADC FACMO        
1627	.$11e8	STA RESLO
1628	.$11ea	LDA RESMO
1629	.$11ec	ADC FACMOH       
1630	.$11ee	STA RESMO
1631	.$11f0	LDA RESMOH
1632	.$11f2	ADC FACHO        
1633	.$11f4	STA RESMOH
1634	.$11f6	LDA RESHO
1635	.$11f8	ADC FACHOP       
1636	.$11fa	STA RESHO
1637	.$11fc	BCC FFMUL_B3
1638	.$11fe	INC RESHOP
1639	.$1200	FFMUL_B3
1640	.$1200	LSR ARGHO        
1641	.$1202	BCC FFMUL_ROTA
1642	.$1204	LDA RESOV
1643	.$1206	CLC
1644	.$1207	ADC FACOV        
1645	.$1209	STA RESOV
1646	.$120b	LDA RESLO
1647	.$120d	ADC FACLO        
1648	.$120f	STA RESLO
1649	.$1211	LDA RESMO
1650	.$1213	ADC FACMO        
1651	.$1215	STA RESMO
1652	.$1217	LDA RESMOH
1653	.$1219	ADC FACMOH       
1654	.$121b	STA RESMOH
1655	.$121d	LDA RESHO
1656	.$121f	ADC FACHO        
1657	.$1221	STA RESHO
1658	.$1223	LDA RESHOP
1659	.$1225	ADC FACHOP       
1660	.$1227	STA RESHOP
1661	.$1229	FFMUL_ROTA
1662	.$1229	ASL FACOV
1663	.$122b	ROL FACLO
1664	.$122d	ROL FACMO
1665	.$122f	ROL FACMOH
1666	.$1231	ROL FACHO
1667	.$1233	ROL FACHOP
1668	.$1235	BMI FFMUL_FIN
1669	.$1237	JMP FFMUL_B0
1670	.$123a	FFMUL_FIN
1671	.$123a	LDA RESHOP
1672	.$123c	STA FACHO
1673	.$123e	LDA RESHO
1674	.$1240	STA FACMOH
1675	.$1242	LDA RESMOH
1676	.$1244	STA FACMO
1677	.$1246	LDA RESMO
1678	.$1248	STA FACLO
1679	.$124a	LDA RESLO
1680	.$124c	STA FACOV
1681	.$124e	JMP FCNORMAL      
1682	.$1251	MUL10
1683	.$1251	JSR ARGFAC       
1684	.$1254	TAX              
1685	.$1255	BEQ FFMUL_MUL101    
1686	.$1257	CLC
1687	.$1258	ADC #2
1688	.$125a	BCS FFMUL_MUL102    
1689	.$125c	STA FACEXP       
1690	.$125e	LDY #0
1691	.$1260	STY ARISGN
1692	.$1262	JSR FASTFADDARG      
1693	.$1265	INC FACEXP
1694	.$1267	BEQ FFMUL_MUL102     
1695	.$1269	FFMUL_MUL101
1696	.$1269	RTS
1697	.$126a	FFMUL_MUL102
1698	.$126a	JMP ILLEGALQUANTITY
1699	.$126d	MUL6
1700	.$126d	JSR ARGFAC       
1701	.$1270	TAX              
1702	.$1271	BEQ FFMUL_MUL61     
1703	.$1273	INC FACEXP
1704	.$1275	BEQ FFMUL_MUL62     
1705	.$1277	LDY #0
1706	.$1279	STY ARISGN
1707	.$127b	JSR FASTFADDARG      
1708	.$127e	INC FACEXP
1709	.$1280	BEQ FFMUL_MUL62     
1710	.$1282	FFMUL_MUL61
1711	.$1282	RTS
1712	.$1283	FFMUL_MUL62
1713	.$1283	JMP ILLEGALQUANTITY
1716	.$1286	INITVARS
1717	.$1286	JSR INITSTRVARS
1718	.$1289	LDA #0
1719	.$128b	RTS
1723	.$128c	CONSTANTS
1729	.$128c	CONST_1R .REAL 41.0
1732	.$1291	CONST_2R .REAL 40.0
1735	.$1296	CONST_3R .REAL 1.0
1738	.$129b	CONST_4R .REAL 2.0
1740	.$12a0	CONST_5 .BYTE 20
1741	.$12a1	.STRG "{151}{169}{155}{127}"
1744	.$12a5	DATAS
1745	.$12a5	.BYTE $FF
1747	.$12a6	CONSTANTS_END
1750	.$12a6	VARIABLES
1751	.$12a6	STRINGVARS_START
1753	.$12a6	VAR_TI$ .WORD EMPTYSTR
1754	.$12a8	STRINGVARS_END
1755	.$12a8	STRINGARRAYS_START
1756	.$12a8	STRINGARRAYS_END
1757	.$12a8	VARIABLES_END
1759	.$12a8	Y_REG .REAL 0.0
1760	.$12ad	C_REG .REAL 0.0
1761	.$12b2	D_REG .REAL 0.0
1762	.$12b7	E_REG .REAL 0.0
1763	.$12bc	F_REG .REAL 0.0
1764	.$12c1	A_REG .WORD 0
1765	.$12c3	B_REG .WORD 0
1766	.$12c5	CMD_NUM .BYTE 0
1767	.$12c6	CHANNEL .BYTE 0
1768	.$12c7	SP_SAVE .BYTE 0
1769	.$12c8	TMP2_REG .WORD 0
1770	.$12ca	TMP3_REG .WORD 0
1771	.$12cc	TMP4_REG .WORD 0
1772	.$12ce	AS_TMP .WORD 0
1773	.$12d0	BPOINTER_TMP .WORD 0
1774	.$12d2	BASICTEXTP .BYTE 0
1775	.$12d3	STORE1 .WORD 0
1776	.$12d5	STORE2 .WORD 0
1777	.$12d7	STORE3 .WORD 0
1778	.$12d9	STORE4 .WORD 0
1779	.$12db	GCSTART .WORD 0
1780	.$12dd	GCLEN .WORD 0
1781	.$12df	GCWORK .WORD 0
1782	.$12e1	INPUTLENGTH .BYTE 0
1783	.$12e2	TMP_FREG .REAL 0
1784	.$12e7	TMP2_FREG .REAL 0
1785	.$12ec	TMP_FLAG .BYTE 0
1786	.$12ed	INT_FLAG .BYTE 0
1787	.$12ee	REAL_CONST_ONE .REAL 1.0
1788	.$12f3	REAL_CONST_ZERO .REAL 0.0
1789	.$12f8	REAL_CONST_MINUS_ONE .REAL -1.0
1790	.$12fd	CHLOCKFLAG .BYTE 0
1791	.$12fe	EMPTYSTR .BYTE 0
1792	.$12ff	FPSTACKP .WORD FPSTACK
1793	.$1301	FORSTACKP .WORD FORSTACK
1794	.$1303	DATASP .WORD DATAS
1795	.$1305	LASTVAR .WORD 0
1796	.$1307	LASTVARP .WORD 0
1797	.$1309	HIGHP .WORD STRBUF
1798	.$130b	STRBUFP .WORD STRBUF
1799	.$130d	ENDSTRBUF .WORD 0
1800	.$130f	INPUTQUEUEP .BYTE 0
1801	.$1310	PROGRAMEND
1802	.$1310	INPUTQUEUE .ARRAY $0F
1803	.$131f	FPSTACK .ARRAY 100
1804	.$1383	FORSTACK .ARRAY 340
1805	.$14d7	STRBUF .BYTE 0

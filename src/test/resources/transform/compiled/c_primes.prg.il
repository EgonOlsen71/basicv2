PROGRAMSTART:
JSR START
0:
10:
NOP
MOV B,#000000{STRING}
MOV TI${STRING},B
NOP
MOV Y,#2{INTEGER}
MOV CP{REAL},Y
20:
NOP
MOVB 53281,#0{INTEGER}
NOP
MOVB 646,#7{INTEGER}
30:
NOP
JSR COMPACTMAX
MOV Y,#147{INTEGER}
CHGCTX #1
JSR CHR
JSR STROUT
NOP
MOV A,#prime numbers up to 255:{down}{STRING}
JSR STROUT
JSR LINEBREAK
40:
NOP
MOV Y,#0{INTEGER}
MOV AM{REAL},Y
50:
NOP
JSR GOSUB
JSR 1000
60:
NOP
MOV Y,#0{INTEGER}
MOV X,PR{REAL}
EQ X,Y
CMP X,#0{REAL}
JNE NSKIP0
JMP SKIP0
NSKIP0:
JMP 100
NOP
SKIP0:
70:
NOP
MOV X,PR{REAL}
JSR REALOUT
JSR CRSRRIGHT
NOP
JSR COMPACTMAX
MOV Y,#44{INTEGER}
CHGCTX #1
JSR CHR
JSR STROUT
80:
NOP
MOV Y,#1{INTEGER}
MOV X,AM{REAL}
ADD X,Y
MOV AM{REAL},X
90:
NOP
JMP 50
100:
NOP
MOV A,#{down}number of primes (expected 54):{STRING}
JSR STROUT
NOP
MOV X,AM{REAL}
JSR REALOUT
JSR LINEBREAK
110:
NOP
MOV A,TI${STRING}
JSR STROUT
JSR LINEBREAK
NOP
JSR END
RTS
1000:
NOP
MOV X,CP{REAL}
MOV G,SV%[]{INTEGER}
CHGCTX #0
JSR ARRAYACCESS
MOV Y,#0{INTEGER}
EQ X,Y
CMP X,#0{REAL}
JNE NSKIP1
JMP SKIP1
NSKIP1:
JMP 1100
NOP
SKIP1:
1010:
NOP
MOV Y,#1{INTEGER}
MOV X,CP{REAL}
ADD X,Y
MOV CP{REAL},X
1020:
NOP
MOV Y,#256{INTEGER}
MOV X,CP{REAL}
EQ X,Y
CMP X,#0{REAL}
JNE NSKIP2
JMP SKIP2
NSKIP2:
NOP
MOV Y,#0{INTEGER}
MOV PR{REAL},Y
JMP RETURN
NOP
SKIP2:
1030:
NOP
JMP 1000
1100:
NOP
MOV Y,CP{REAL}
PUSH Y
NOP
POP X
MOV Y,#1{INTEGER}
MOV G,SV%[]{INTEGER}
JSR ARRAYSTORE
NOP
MOV Y,CP{REAL}
MOV ML{REAL},Y
1110:
NOP
MOV Y,#256{INTEGER}
MOV X,ML{REAL}
GTEQ X,Y
CMP X,#0{REAL}
JNE NSKIP3
JMP SKIP3
NSKIP3:
NOP
MOV Y,CP{REAL}
MOV PR{REAL},Y
JMP RETURN
NOP
SKIP3:
1120:
NOP
MOV Y,ML{REAL}
PUSH Y
NOP
POP X
MOV Y,#1{INTEGER}
MOV G,SV%[]{INTEGER}
JSR ARRAYSTORE
NOP
MOV Y,CP{REAL}
MOV X,ML{REAL}
ADD X,Y
MOV ML{REAL},X
1130:
NOP
JMP 1110
NOP
JSR END
RTS

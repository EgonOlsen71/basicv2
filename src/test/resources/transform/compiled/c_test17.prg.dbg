117	.$818	TSX
118	.$819	STX SP_SAVE
120	.$81c	PROGRAMSTART:
121	.$81c	JSR START
123	.$81f	LINE_0:
126	.$81f	LINE_10:
128	.$81f	LDA #<CONST_0R
129	.$821	LDY #>CONST_0R
130	.$823	JSR COPY2_XYA_YREG
135	.$826	JSR TAB
136	.$829	JSR END
137	.$82c	RTS
140	.$82d	END   LDX SP_SAVE
141	.$830	TXS
148	.$831	RTS
151	.$832	START  LDA ENDSTRBUF+1
152	.$835	BNE ENDGIVEN
153	.$837	LDA BASICEND
154	.$839	STA ENDSTRBUF
155	.$83c	LDA BASICEND+1
156	.$83e	STA ENDSTRBUF+1
157	.$841	ENDGIVEN LDA #<FPSTACK
158	.$843	LDY #>FPSTACK
159	.$845	STA FPSTACKP
160	.$848	STY FPSTACKP+1
161	.$84b	LDA #<FORSTACK
162	.$84d	LDY #>FORSTACK
163	.$84f	STA FORSTACKP
164	.$852	STY FORSTACKP+1
165	.$855	LDA #<STRBUF
166	.$857	LDY #>STRBUF
167	.$859	STA STRBUFP
168	.$85c	STY STRBUFP+1
169	.$85f	STA HIGHP
170	.$862	STY HIGHP+1
171	.$865	LDA #0
172	.$867	STA CHLOCKFLAG
173	.$86a	STA LASTVAR
174	.$86d	STA LASTVAR+1
175	.$870	JSR INITVARS
176	.$873	LDA #0
177	.$875	STA CMD_NUM
178	.$878	STA CHANNEL
179	.$87b	TAY
180	.$87c	TAX
184	.$87d	STA KEYNDX
190	.$87f	JSR RESTORE
191	.$882	CLC
195	.$883	RTS
198	.$884	INITNARRAY
199	.$884	STA TMP_ZP
200	.$886	STY TMP_ZP+1
201	.$888	LDY #0
202	.$88a	TYA
203	.$88b	NINITLOOP STA (TMP_ZP),Y
204	.$88d	INC TMP_ZP
205	.$88f	BNE NLOOPNOV
206	.$891	INC TMP_ZP+1
207	.$893	NLOOPNOV LDX TMP2_ZP
208	.$895	BNE NLOOPNOV2
209	.$897	DEC TMP2_ZP+1
210	.$899	NLOOPNOV2 DEC TMP2_ZP
211	.$89b	BNE NINITLOOP
212	.$89d	LDX TMP2_ZP+1
213	.$89f	BNE NINITLOOP
214	.$8a1	RTS
217	.$8a2	INITSTRARRAY
218	.$8a2	STA TMP_ZP
219	.$8a4	STY TMP_ZP+1
220	.$8a6	SINITLOOP LDY #0
221	.$8a8	LDA #<EMPTYSTR
222	.$8aa	STA (TMP_ZP),Y
223	.$8ac	LDA #>EMPTYSTR
224	.$8ae	INY
225	.$8af	STA (TMP_ZP),Y
226	.$8b1	CLC
227	.$8b2	LDA TMP_ZP
228	.$8b4	ADC #2
229	.$8b6	STA TMP_ZP
230	.$8b8	BCC SLOOPNOV1
231	.$8ba	INC TMP_ZP+1
232	.$8bc	SLOOPNOV1 SEC
233	.$8bd	LDA TMP2_ZP
234	.$8bf	SBC #2
235	.$8c1	STA TMP2_ZP
236	.$8c3	BCS SLOOPNOV2
237	.$8c5	DEC TMP2_ZP+1
238	.$8c7	SLOOPNOV2 LDA TMP2_ZP
239	.$8c9	BNE SINITLOOP
240	.$8cb	LDA TMP2_ZP+1
241	.$8cd	BNE SINITLOOP
242	.$8cf	RTS
245	.$8d0	INITSPARAMS STA TMP3_ZP
246	.$8d2	STY TMP3_ZP+1
247	.$8d4	SEC
248	.$8d5	SBC #2
249	.$8d7	STA TMP_ZP
250	.$8d9	TYA
251	.$8da	SBC #0
252	.$8dc	STA TMP_ZP+1
253	.$8de	LDY #0
254	.$8e0	LDA (TMP_ZP),Y
255	.$8e2	STA TMP2_ZP
256	.$8e4	INY
257	.$8e5	LDA (TMP_ZP),Y
258	.$8e7	STA TMP2_ZP+1
259	.$8e9	LDA TMP3_ZP
260	.$8eb	LDY TMP3_ZP+1
261	.$8ed	RTS
264	.$8ee	INITSTRVARS LDA #<STRINGVARS_START  
265	.$8f0	LDY #>STRINGVARS_START
266	.$8f2	CMP #<STRINGVARS_END
267	.$8f4	BNE INITIT1
268	.$8f6	CPY #>STRINGVARS_END
269	.$8f8	BNE INITIT1
270	.$8fa	JMP INITSA2     
271	.$8fd	INITIT1  STA TMP_ZP
272	.$8ff	STY TMP_ZP+1
273	.$901	LDY #0
274	.$903	INITSTRLOOP LDA #<EMPTYSTR
275	.$905	STA (TMP_ZP),Y
276	.$907	INY
277	.$908	LDA #>EMPTYSTR
278	.$90a	STA (TMP_ZP),Y
279	.$90c	DEY
280	.$90d	LDA TMP_ZP
281	.$90f	CLC
282	.$910	ADC #2
283	.$912	STA TMP_ZP
284	.$914	LDA TMP_ZP+1
285	.$916	ADC #0
286	.$918	STA TMP_ZP+1
287	.$91a	CMP #>STRINGVARS_END
288	.$91c	BNE INITSTRLOOP
289	.$91e	LDA TMP_ZP
290	.$920	CMP #<STRINGVARS_END
291	.$922	BNE INITSTRLOOP
292	.$924	INITSA2  LDA #<STRINGARRAYS_START 
293	.$926	LDY #>STRINGARRAYS_START
294	.$928	CMP #<STRINGARRAYS_END
295	.$92a	BNE ARRAYLOOP
296	.$92c	CPY #>STRINGARRAYS_END
297	.$92e	BNE ARRAYLOOP
298	.$930	RTS       
299	.$931	ARRAYLOOP CLC
300	.$932	ADC #3
301	.$934	BCC ARRAYSKIP1
302	.$936	INY
303	.$937	ARRAYSKIP1 CPY #>STRINGARRAYS_END
304	.$939	BEQ ARRAYSC
305	.$93b	BCC ARRAYSKIP2
306	.$93d	JMP ARRAYQUIT
307	.$940	ARRAYSC  CMP #<STRINGARRAYS_END
308	.$942	BCS ARRAYQUIT
309	.$944	ARRAYSKIP2 STA TMP_REG
310	.$946	STY TMP_REG+1
311	.$948	JSR INITSPARAMS
312	.$94b	LDA TMP_REG
313	.$94d	LDY TMP_REG+1
314	.$94f	JSR INITSTRARRAY
315	.$952	LDA TMP_ZP
316	.$954	LDY TMP_ZP+1
317	.$956	JMP ARRAYLOOP
318	.$959	ARRAYQUIT RTS
321	.$95a	RESTORE  LDA #<DATAS
322	.$95c	LDY #>DATAS
323	.$95e	STA DATASP
324	.$961	STY DATASP+1
325	.$964	RTS
328	.$965	TAB   JSR TABSPCINIT
329	.$968	JSR REROUTE
330	.$96b	LDA CMD_NUM
331	.$96e	BEQ NORMALTAB  
332	.$970	CMP #3
333	.$972	BEQ NORMALTAB2  
334	.$974	JMP TABCHANNEL2
335	.$977	NORMALTAB2 JSR CLRCHNEW
336	.$97a	NORMALTAB SEC
337	.$97b	JMP TABSPC
340	.$97e	TABSPCINIT SEC
341	.$97f	JSR CRSRPOS
342	.$982	STY $09
343	.$984	JSR YREGFAC
344	.$987	JSR FACWORD
345	.$98a	TYA
346	.$98b	TAX
347	.$98c	RTS
350	.$98d	TABSPC     BCC DOSPC
351	.$98f	TXA
352	.$990	SBC $09
353	.$992	BCC TABSPCQUIT
354	.$994	TAX
355	.$995	DOSPC  INX
356	.$996	TABSPCLOOP  DEX
357	.$997	BNE TABSPCRIGHT
358	.$999	TABSPCQUIT RTS
359	.$99a	TABSPCRIGHT JSR CRSRRIGHT
360	.$99d	JMP TABSPCLOOP
363	.$9a0	REROUTE  LDA CMD_NUM  
364	.$9a3	BEQ REROUTECMD
365	.$9a5	TAX
366	.$9a6	STA CHANNEL
367	.$9a9	JMP CHKOUT
368	.$9ac	REROUTECMD RTS
371	.$9ad	COPY2_XYA_YREG
372	.$9ad	STA TMP3_ZP
373	.$9af	STY TMP3_ZP+1
374	.$9b1	COPY2_XY_YREG
375	.$9b1	LDX #<Y_REG  
376	.$9b3	LDY #0
377	.$9b5	LDA (TMP3_ZP),Y
378	.$9b7	STA Y_REG
379	.$9ba	INY
380	.$9bb	LDA (TMP3_ZP),Y
381	.$9bd	STA Y_REG+1
382	.$9c0	INY
383	.$9c1	LDA (TMP3_ZP),Y
384	.$9c3	STA Y_REG+2
385	.$9c6	INY
386	.$9c7	LDA (TMP3_ZP),Y
387	.$9c9	STA Y_REG+3
388	.$9cc	INY
389	.$9cd	LDA (TMP3_ZP),Y
390	.$9cf	STA Y_REG+4
391	.$9d2	RTS
395	.$9d3	FACWORD
396	.$9d3	LDA FACEXP   
397	.$9d5	BNE DOFACWORD
398	.$9d7	STA FACSGN   
399	.$9d9	DOFACWORD:
400	.$9d9	JMP XFACWORD
404	.$9dc	INITOUTCHANNEL
405	.$9dc	LDA CHLOCKFLAG
406	.$9df	BEQ INITOUT2
407	.$9e1	CMP #$FF
408	.$9e3	BNE SKIPINITCH
409	.$9e5	INITOUT2
410	.$9e5	LDA #<C_REG
411	.$9e7	LDY #>C_REG
412	.$9e9	JSR REALFAC
413	.$9ec	JSR FACWORD
414	.$9ef	TYA
415	.$9f0	TAX
416	.$9f1	CPX CMD_NUM
417	.$9f4	BNE CMDNEQUAL
418	.$9f6	LDY #0
419	.$9f8	STY CMD_NUM   
420	.$9fb	CMDNEQUAL STA CHANNEL
421	.$9fe	STA CHLOCKFLAG
422	.$a01	JMP CHKOUT
423	.$a04	SKIPINITCH
424	.$a04	RTS
427	.$a05	CLRCHNEW
428	.$a05	LDA CHLOCKFLAG
429	.$a08	BNE SKIPCLRCH
430	.$a0a	JMP CLRCH
431	.$a0d	SKIPCLRCH
432	.$a0d	RTS
435	.$a0e	TABCHANNEL
436	.$a0e	JSR INITOUTCHANNEL
437	.$a11	TABCHANNELINT
438	.$a11	LDA CHANNEL
439	.$a14	CMP #3  
440	.$a16	BEQ TABSCREEN
441	.$a18	TABCHANNEL2 LDA IOCHANNEL
442	.$a1a	STA STORE1
443	.$a1d	LDA #1
444	.$a1f	STA IOCHANNEL  
445	.$a21	JSR YREGFAC
446	.$a24	JSR FACWORD
447	.$a27	TYA
448	.$a28	TAX
449	.$a29	JMP EXITCHANNEL
450	.$a2c	TABSCREEN
451	.$a2c	JSR CLRCHNEW
452	.$a2f	JMP TAB
455	.$a32	EXITCHANNEL CLC
456	.$a33	JSR TABSPC
457	.$a36	JSR CLRCHNEW
458	.$a39	LDA STORE1
459	.$a3c	STA IOCHANNEL
460	.$a3e	RTS
463	.$a3f	YREGFAC  LDA Y_REG+4
464	.$a42	STA FACLO
465	.$a44	LDA Y_REG+3
466	.$a47	STA FACMO
467	.$a49	LDA Y_REG+2
468	.$a4c	STA FACMOH
469	.$a4e	LDA Y_REG+1
470	.$a51	STA FACSGN
471	.$a53	ORA #$80
472	.$a55	STA FACHO
473	.$a57	LDA Y_REG
474	.$a5a	STA FACEXP
475	.$a5c	LDA #0
476	.$a5e	STA FACOV
477	.$a60	RTS
591	.$a61	INITVARS
592	.$a61	JSR INITSTRVARS
593	.$a64	LDA #0
594	.$a66	RTS
598	.$a67	CONSTANTS
601	.$a67	CONST_0R .REAL 3.0
604	.$a6c	DATAS
605	.$a6c	.BYTE $FF
607	.$a6d	CONSTANTS_END
610	.$a6d	VARIABLES
611	.$a6d	STRINGVARS_START
613	.$a6d	VAR_TI$ .WORD EMPTYSTR
614	.$a6f	STRINGVARS_END
615	.$a6f	STRINGARRAYS_START
616	.$a6f	STRINGARRAYS_END
617	.$a6f	VARIABLES_END
619	.$a6f	Y_REG .REAL 0.0
620	.$a74	C_REG .REAL 0.0
621	.$a79	D_REG .REAL 0.0
622	.$a7e	E_REG .REAL 0.0
623	.$a83	F_REG .REAL 0.0
624	.$a88	A_REG .WORD 0
625	.$a8a	B_REG .WORD 0
626	.$a8c	CMD_NUM .BYTE 0
627	.$a8d	CHANNEL .BYTE 0
628	.$a8e	SP_SAVE .BYTE 0
629	.$a8f	TMP2_REG .WORD 0
630	.$a91	TMP3_REG .WORD 0
631	.$a93	TMP4_REG .WORD 0
632	.$a95	AS_TMP .WORD 0
633	.$a97	BPOINTER_TMP .WORD 0
634	.$a99	BASICTEXTP .BYTE 0
635	.$a9a	STORE1 .WORD 0
636	.$a9c	STORE2 .WORD 0
637	.$a9e	STORE3 .WORD 0
638	.$aa0	STORE4 .WORD 0
639	.$aa2	GCSTART .WORD 0
640	.$aa4	GCLEN .WORD 0
641	.$aa6	GCWORK .WORD 0
642	.$aa8	INPUTLENGTH .BYTE 0
643	.$aa9	TMP_FREG .REAL 0
644	.$aae	TMP2_FREG .REAL 0
645	.$ab3	TMP_FLAG .BYTE 0
646	.$ab4	INT_FLAG .BYTE 0
647	.$ab5	REAL_CONST_ONE .REAL 1.0
648	.$aba	REAL_CONST_ZERO .REAL 0.0
649	.$abf	REAL_CONST_MINUS_ONE .REAL -1.0
650	.$ac4	CHLOCKFLAG .BYTE 0
651	.$ac5	EMPTYSTR .BYTE 0
652	.$ac6	FPSTACKP .WORD FPSTACK
653	.$ac8	FORSTACKP .WORD FORSTACK
654	.$aca	DATASP .WORD DATAS
655	.$acc	LASTVAR .WORD 0
656	.$ace	LASTVARP .WORD 0
657	.$ad0	HIGHP .WORD STRBUF
658	.$ad2	STRBUFP .WORD STRBUF
659	.$ad4	ENDSTRBUF .WORD 0
660	.$ad6	INPUTQUEUEP .BYTE 0
661	.$ad7	PROGRAMEND
662	.$ad7	INPUTQUEUE .ARRAY $0F
663	.$ae6	FPSTACK .ARRAY 100
664	.$b4a	FORSTACK .ARRAY 340
665	.$c9e	STRBUF .BYTE 0

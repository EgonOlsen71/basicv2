117	.$818	TSX
118	.$819	STX SP_SAVE
120	.$81c	PROGRAMSTART:
121	.$81c	JSR START
123	.$81f	LINE_0:
126	.$81f	LINE_10:
128	.$81f	LDA #<CONST_0
129	.$821	LDY #>CONST_0
130	.$823	STA TMP_ZP
131	.$825	STY TMP_ZP+1
133	.$827	JSR WRITETID
134	.$82a	LDA #0
135	.$82c	STA VAR_J
136	.$82f	STA VAR_J+1
137	.$832	STA VAR_J+2
138	.$835	STA VAR_J+3
139	.$838	STA VAR_J+4
141	.$83b	LDA #<CONST_2R
142	.$83d	LDY #>CONST_2R
143	.$83f	JSR REALFACPUSH
145	.$842	LDA #<CONST_3R
146	.$844	LDY #>CONST_3R
147	.$846	JSR REALFACPUSH
149	.$849	LDA #<VAR_J
150	.$84b	LDY #>VAR_J
151	.$84d	STA A_REG
152	.$850	STY A_REG+1
153	.$853	LDA #<FORLOOP0
154	.$855	STA JUMP_TARGET
155	.$857	LDA #>FORLOOP0
156	.$859	STA JUMP_TARGET+1
157	.$85b	JSR INITFOR
158	.$85e	FORLOOP0:
159	.$85e	LDA #0
160	.$860	STA VAR_I
161	.$863	STA VAR_I+1
162	.$866	STA VAR_I+2
163	.$869	STA VAR_I+3
164	.$86c	STA VAR_I+4
166	.$86f	LDA #<CONST_4R
167	.$871	LDY #>CONST_4R
168	.$873	JSR REALFACPUSH
170	.$876	LDA #<CONST_3R
171	.$878	LDY #>CONST_3R
172	.$87a	JSR REALFACPUSH
174	.$87d	LDA #<VAR_I
175	.$87f	LDY #>VAR_I
176	.$881	STA A_REG
177	.$884	STY A_REG+1
178	.$887	LDA #<FORLOOP1
179	.$889	STA JUMP_TARGET
180	.$88b	LDA #>FORLOOP1
181	.$88d	STA JUMP_TARGET+1
182	.$88f	JSR INITFOR
183	.$892	FORLOOP1:
185	.$892	LINE_20:
187	.$892	LDX #4
188	.$894	dceloop998_1:
189	.$894	LDA CONST_5R,X
190	.$897	CMP VAR_I,X
191	.$89a	BNE LINE_SKIP3
192	.$89c	DEX
193	.$89d	BPL dceloop998_1
195	.$89f	LINE_NSKIP3:
198	.$89f	LDY #0
199	.$8a1	STY 53280
202	.$8a4	LINE_SKIP3:
205	.$8a4	LINE_25:
207	.$8a4	LDA #<CONST_6R
208	.$8a6	LDY #>CONST_6R
209	.$8a8	JSR REALFAC
210	.$8ab	LDA #<VAR_J
211	.$8ad	LDY #>VAR_J
212	.$8af	JSR CMPFAC
214	.$8b2	BEQ EQ_EQ1
215	.$8b4	LDA #<REAL_CONST_ZERO
216	.$8b6	LDY #>REAL_CONST_ZERO
217	.$8b8	JMP EQ_SKIP1
218	.$8bb	EQ_EQ1:
219	.$8bb	LDA #<REAL_CONST_MINUS_ONE
220	.$8bd	LDY #>REAL_CONST_MINUS_ONE
221	.$8bf	EQ_SKIP1:
223	.$8bf	JSR REALFACPUSH
225	.$8c2	JSR ONETOFAC
227	.$8c5	LDA #<VAR_I
228	.$8c7	LDY #>VAR_I
229	.$8c9	JSR CMPFAC
231	.$8cc	BEQ EQ_EQ2
232	.$8ce	LDA #<REAL_CONST_ZERO
233	.$8d0	LDY #>REAL_CONST_ZERO
234	.$8d2	JMP EQ_SKIP2
235	.$8d5	EQ_EQ2:
236	.$8d5	LDA #<REAL_CONST_MINUS_ONE
237	.$8d7	LDY #>REAL_CONST_MINUS_ONE
238	.$8d9	EQ_SKIP2:
240	.$8d9	JSR REALFAC
241	.$8dc	JSR FACXREG
243	.$8df	JSR POPREAL2X
245	.$8e2	JSR FASTAND
248	.$8e5	JSR FACXREG
250	.$8e8	LDA X_REG
251	.$8ea	COMP_SKP1:
252	.$8ea	BEQ LINE_SKIP4
255	.$8ec	LINE_NSKIP4:
257	.$8ec	LDY #7
258	.$8ee	STY 53281
261	.$8f1	LINE_SKIP4:
264	.$8f1	LINE_30:
266	.$8f1	LDX #4
267	.$8f3	dcneloop999_1:
268	.$8f3	LDA CONST_4R,X
269	.$8f6	CMP VAR_I,X
270	.$8f9	BNE LINE_NSKIP5
271	.$8fb	DEX
272	.$8fc	BPL dcneloop999_1
273	.$8fe	JMP LINE_SKIP5
275	.$901	LINE_NSKIP5:
278	.$901	LDY #1
279	.$903	STY 53280
282	.$906	LINE_SKIP5:
285	.$906	LINE_40:
287	.$906	LDA #0
288	.$908	STA A_REG
289	.$90b	STA A_REG+1
290	.$90e	JSR NEXT
292	.$911	LDA A_REG
293	.$914	BNE RBEQ_0
294	.$916	JMP (JUMP_TARGET)
296	.$919	RBEQ_0:
297	.$919	LDA #0
298	.$91b	STA A_REG
299	.$91e	STA A_REG+1
300	.$921	JSR NEXT
302	.$924	LDA A_REG
303	.$927	BNE RBEQ_1
304	.$929	JMP (JUMP_TARGET)
306	.$92c	RBEQ_1:
307	.$92c	JSR LINEBREAK
308	.$92f	JSR READTID
309	.$932	LDA VAR_TI$
310	.$935	LDY VAR_TI$+1
311	.$938	JSR STROUTBRKWL
314	.$93b	JSR END
315	.$93e	RTS
318	.$93f	END   LDX SP_SAVE
319	.$942	TXS
326	.$943	RTS
329	.$944	START  LDA ENDSTRBUF+1
330	.$947	BNE ENDGIVEN
331	.$949	LDA BASICEND
332	.$94b	STA ENDSTRBUF
333	.$94e	LDA BASICEND+1
334	.$950	STA ENDSTRBUF+1
335	.$953	ENDGIVEN LDA #<FPSTACK
336	.$955	LDY #>FPSTACK
337	.$957	STA FPSTACKP
338	.$95a	STY FPSTACKP+1
339	.$95d	LDA #<FORSTACK
340	.$95f	LDY #>FORSTACK
341	.$961	STA FORSTACKP
342	.$964	STY FORSTACKP+1
343	.$967	LDA #<STRBUF
344	.$969	LDY #>STRBUF
345	.$96b	STA STRBUFP
346	.$96e	STY STRBUFP+1
347	.$971	STA HIGHP
348	.$974	STY HIGHP+1
349	.$977	LDA #0
350	.$979	STA CHLOCKFLAG
351	.$97c	STA LASTVAR
352	.$97f	STA LASTVAR+1
353	.$982	JSR INITVARS
354	.$985	LDA #0
355	.$987	STA CMD_NUM
356	.$98a	STA CHANNEL
357	.$98d	TAY
358	.$98e	TAX
362	.$98f	STA KEYNDX
368	.$991	JSR RESTORE
369	.$994	CLC
373	.$995	RTS
376	.$996	INITNARRAY
377	.$996	STA TMP_ZP
378	.$998	STY TMP_ZP+1
379	.$99a	LDY #0
380	.$99c	TYA
381	.$99d	NINITLOOP STA (TMP_ZP),Y
382	.$99f	INC TMP_ZP
383	.$9a1	BNE NLOOPNOV
384	.$9a3	INC TMP_ZP+1
385	.$9a5	NLOOPNOV LDX TMP2_ZP
386	.$9a7	BNE NLOOPNOV2
387	.$9a9	DEC TMP2_ZP+1
388	.$9ab	NLOOPNOV2 DEC TMP2_ZP
389	.$9ad	BNE NINITLOOP
390	.$9af	LDX TMP2_ZP+1
391	.$9b1	BNE NINITLOOP
392	.$9b3	RTS
395	.$9b4	INITSTRARRAY
396	.$9b4	STA TMP_ZP
397	.$9b6	STY TMP_ZP+1
398	.$9b8	SINITLOOP LDY #0
399	.$9ba	LDA #<EMPTYSTR
400	.$9bc	STA (TMP_ZP),Y
401	.$9be	LDA #>EMPTYSTR
402	.$9c0	INY
403	.$9c1	STA (TMP_ZP),Y
404	.$9c3	CLC
405	.$9c4	LDA TMP_ZP
406	.$9c6	ADC #2
407	.$9c8	STA TMP_ZP
408	.$9ca	BCC SLOOPNOV1
409	.$9cc	INC TMP_ZP+1
410	.$9ce	SLOOPNOV1 SEC
411	.$9cf	LDA TMP2_ZP
412	.$9d1	SBC #2
413	.$9d3	STA TMP2_ZP
414	.$9d5	BCS SLOOPNOV2
415	.$9d7	DEC TMP2_ZP+1
416	.$9d9	SLOOPNOV2 LDA TMP2_ZP
417	.$9db	BNE SINITLOOP
418	.$9dd	LDA TMP2_ZP+1
419	.$9df	BNE SINITLOOP
420	.$9e1	RTS
423	.$9e2	INITSPARAMS STA TMP3_ZP
424	.$9e4	STY TMP3_ZP+1
425	.$9e6	SEC
426	.$9e7	SBC #2
427	.$9e9	STA TMP_ZP
428	.$9eb	TYA
429	.$9ec	SBC #0
430	.$9ee	STA TMP_ZP+1
431	.$9f0	LDY #0
432	.$9f2	LDA (TMP_ZP),Y
433	.$9f4	STA TMP2_ZP
434	.$9f6	INY
435	.$9f7	LDA (TMP_ZP),Y
436	.$9f9	STA TMP2_ZP+1
437	.$9fb	LDA TMP3_ZP
438	.$9fd	LDY TMP3_ZP+1
439	.$9ff	RTS
442	.$a00	INITSTRVARS LDA #<STRINGVARS_START  
443	.$a02	LDY #>STRINGVARS_START
444	.$a04	CMP #<STRINGVARS_END
445	.$a06	BNE INITIT1
446	.$a08	CPY #>STRINGVARS_END
447	.$a0a	BNE INITIT1
448	.$a0c	JMP INITSA2     
449	.$a0f	INITIT1  STA TMP_ZP
450	.$a11	STY TMP_ZP+1
451	.$a13	LDY #0
452	.$a15	INITSTRLOOP LDA #<EMPTYSTR
453	.$a17	STA (TMP_ZP),Y
454	.$a19	INY
455	.$a1a	LDA #>EMPTYSTR
456	.$a1c	STA (TMP_ZP),Y
457	.$a1e	DEY
458	.$a1f	LDA TMP_ZP
459	.$a21	CLC
460	.$a22	ADC #2
461	.$a24	STA TMP_ZP
462	.$a26	LDA TMP_ZP+1
463	.$a28	ADC #0
464	.$a2a	STA TMP_ZP+1
465	.$a2c	CMP #>STRINGVARS_END
466	.$a2e	BNE INITSTRLOOP
467	.$a30	LDA TMP_ZP
468	.$a32	CMP #<STRINGVARS_END
469	.$a34	BNE INITSTRLOOP
470	.$a36	INITSA2  LDA #<STRINGARRAYS_START 
471	.$a38	LDY #>STRINGARRAYS_START
472	.$a3a	CMP #<STRINGARRAYS_END
473	.$a3c	BNE ARRAYLOOP
474	.$a3e	CPY #>STRINGARRAYS_END
475	.$a40	BNE ARRAYLOOP
476	.$a42	RTS       
477	.$a43	ARRAYLOOP CLC
478	.$a44	ADC #3
479	.$a46	BCC ARRAYSKIP1
480	.$a48	INY
481	.$a49	ARRAYSKIP1 CPY #>STRINGARRAYS_END
482	.$a4b	BEQ ARRAYSC
483	.$a4d	BCC ARRAYSKIP2
484	.$a4f	JMP ARRAYQUIT
485	.$a52	ARRAYSC  CMP #<STRINGARRAYS_END
486	.$a54	BCS ARRAYQUIT
487	.$a56	ARRAYSKIP2 STA TMP_REG
488	.$a58	STY TMP_REG+1
489	.$a5a	JSR INITSPARAMS
490	.$a5d	LDA TMP_REG
491	.$a5f	LDY TMP_REG+1
492	.$a61	JSR INITSTRARRAY
493	.$a64	LDA TMP_ZP
494	.$a66	LDY TMP_ZP+1
495	.$a68	JMP ARRAYLOOP
496	.$a6b	ARRAYQUIT RTS
499	.$a6c	RESTORE  LDA #<DATAS
500	.$a6e	LDY #>DATAS
501	.$a70	STA DATASP
502	.$a73	STY DATASP+1
503	.$a76	RTS
506	.$a77	WRITETID LDY #0
507	.$a79	LDA (TMP_ZP),Y
508	.$a7b	CMP #$6
509	.$a7d	BEQ FORMATOK
510	.$a7f	JMP ILLEGALQUANTITY
511	.$a82	FORMATOK INC TMP_ZP
512	.$a84	BNE WRITE2
513	.$a86	INC TMP_ZP+1
514	.$a88	WRITE2  LDA TMP_ZP
515	.$a8a	STA INDEX1
516	.$a8c	LDA TMP_ZP+1
517	.$a8e	STA INDEX1+1
519	.$a90	JMP WRITETIS
526	.$a93	READTID  LDA $FE
527	.$a95	PHA
529	.$a96	STA FACOV
530	.$a98	JSR TI2FAC
531	.$a9b	LDY #0
532	.$a9d	STY LOWDS+1
533	.$a9f	DEY
534	.$aa0	STY FACOV+1
535	.$aa2	LDY #$06
536	.$aa4	STY LOWDS
537	.$aa6	LDY #$24
538	.$aa8	JSR GETTI
543	.$aab	LDA #$FE
544	.$aad	STA TMP_ZP
545	.$aaf	LDA #0
546	.$ab1	STA TMP_ZP+1
547	.$ab3	LDA #$6
548	.$ab5	SEI    
549	.$ab6	STA $FE
550	.$ab8	LDA #<VAR_TI$
551	.$aba	LDY #>VAR_TI$
552	.$abc	JSR COPYSTRING
553	.$abf	PLA
554	.$ac0	STA $FE
555	.$ac2	CLI
556	.$ac3	RTS
559	.$ac4	SAVEPOINTERS
560	.$ac4	LDA TMP_ZP   
561	.$ac6	STA STORE1
562	.$ac9	LDA TMP_ZP+1
563	.$acb	STA STORE1+1
564	.$ace	LDA TMP2_ZP
565	.$ad0	STA STORE2
566	.$ad3	LDA TMP2_ZP+1
567	.$ad5	STA STORE2+1
568	.$ad8	LDA TMP3_ZP
569	.$ada	STA STORE3
570	.$add	LDA TMP3_ZP+1
571	.$adf	STA STORE3+1
572	.$ae2	RTS
575	.$ae3	RESTOREPOINTERS
576	.$ae3	LDA STORE3+1  
577	.$ae6	STA TMP3_ZP+1
578	.$ae8	LDA STORE3
579	.$aeb	STA TMP3_ZP
580	.$aed	LDA STORE2+1
581	.$af0	STA TMP2_ZP+1
582	.$af2	LDA STORE2
583	.$af5	STA TMP2_ZP
584	.$af7	LDA STORE1+1
585	.$afa	STA TMP_ZP+1
586	.$afc	LDA STORE1
587	.$aff	STA TMP_ZP
588	.$b01	RTS
591	.$b02	COMPACT
592	.$b02	LDY #0
593	.$b04	GCBUFNE  LDA (TMP_ZP),Y  
594	.$b06	COMPACTF STA TMP4_REG  
595	.$b09	LDY STRBUFP+1  
596	.$b0c	STY TMP4_REG+1  
597	.$b0f	INY     
598	.$b10	BEQ ENDMEM   
599	.$b12	CPY ENDSTRBUF+1  
600	.$b15	BCC RGCEXIT   
601	.$b17	ENDMEM  LDA STRBUFP
602	.$b1a	CLC
603	.$b1b	ADC TMP4_REG
604	.$b1e	STA TMP4_REG
605	.$b21	BCC RGCNOOV1
606	.$b23	INC TMP4_REG+1
607	.$b26	RGCNOOV1 CLC
608	.$b27	LDA TMP4_REG
609	.$b2a	ADC #3
610	.$b2c	STA TMP4_REG
611	.$b2f	BCC RGCNOOV2
612	.$b31	INC TMP4_REG+1
613	.$b34	RGCNOOV2 LDA TMP4_REG+1  
614	.$b37	CMP ENDSTRBUF+1
615	.$b3a	BEQ RGCLOW1
616	.$b3c	BCS GCEXECOMP  
617	.$b3e	JMP RGCEXIT
618	.$b41	RGCLOW1  LDA TMP4_REG
619	.$b44	CMP ENDSTRBUF
620	.$b47	BCS GCEXECOMP  
621	.$b49	RGCEXIT  RTS     
622	.$b4a	GCEXECOMP LDA STRBUFP
623	.$b4d	STA STORE4
624	.$b50	LDA STRBUFP+1
625	.$b53	STA STORE4+1
626	.$b56	JSR GCEXE
627	.$b59	JMP CHECKMEMORY
630	.$b5c	GCEXE  JSR SAVEPOINTERS
631	.$b5f	LDA #0
632	.$b61	STA LASTVAR
633	.$b64	STA LASTVAR+1  
634	.$b67	LDA #<STRBUF
635	.$b69	STA TMP_ZP
636	.$b6b	STA GCSTART
637	.$b6e	LDA #>STRBUF
638	.$b70	STA TMP_ZP+1  
639	.$b72	STA GCSTART+1
640	.$b75	GCLOOP  LDY #0
641	.$b77	LDA TMP_ZP
642	.$b79	STA GCWORK
643	.$b7c	LDA TMP_ZP+1
644	.$b7e	STA GCWORK+1  
645	.$b81	LDA (TMP_ZP),Y
646	.$b83	STA GCLEN   
647	.$b86	INC TMP_ZP
648	.$b88	BNE GCLOOPNOOV
649	.$b8a	INC TMP_ZP+1
650	.$b8c	GCLOOPNOOV LDA TMP_ZP
651	.$b8e	CLC
652	.$b8f	ADC GCLEN
653	.$b92	STA TMP_ZP
654	.$b94	BCC GCLOOPNOOV2
655	.$b96	INC TMP_ZP+1  
656	.$b98	GCLOOPNOOV2 LDY #0
657	.$b9a	LDA (TMP_ZP),Y
658	.$b9c	STA TMP2_ZP
659	.$b9e	INY
660	.$b9f	LDA (TMP_ZP),Y
661	.$ba1	STA TMP2_ZP+1  
662	.$ba3	LDA TMP_ZP
663	.$ba5	CLC
664	.$ba6	ADC #2
665	.$ba8	STA TMP_ZP
666	.$baa	BCC GCLOOPNOOV3
667	.$bac	INC TMP_ZP+1  
668	.$bae	GCLOOPNOOV3 LDY #0
669	.$bb0	LDA (TMP2_ZP),Y
670	.$bb2	CMP GCWORK
671	.$bb5	BNE GCKLOOP
672	.$bb7	INY
673	.$bb8	LDA (TMP2_ZP),Y
674	.$bba	CMP GCWORK+1
675	.$bbd	BEQ MEMFREE
676	.$bbf	GCKLOOP  LDA TMP_ZP+1  
677	.$bc1	CMP HIGHP+1
678	.$bc4	BEQ GCHECKLOW
679	.$bc6	BCC GCLOOP
680	.$bc8	JMP GCDONE
681	.$bcb	GCHECKLOW LDA TMP_ZP
682	.$bcd	CMP HIGHP
683	.$bd0	BCS GCDONE
684	.$bd2	JMP GCLOOP
685	.$bd5	MEMFREE  LDA GCSTART   
686	.$bd8	CMP GCWORK   
687	.$bdb	BNE COPYDOWN
688	.$bdd	LDA GCSTART+1
689	.$be0	CMP GCWORK+1
690	.$be3	BNE COPYDOWN
691	.$be5	LDA TMP_ZP   
692	.$be7	STA GCSTART
693	.$bea	LDA TMP_ZP+1
694	.$bec	STA GCSTART+1
695	.$bef	JMP GCKLOOP   
696	.$bf2	COPYDOWN LDA GCSTART   
697	.$bf5	STA TMP_REG
698	.$bf7	LDA GCSTART+1
699	.$bfa	STA TMP_REG+1  
700	.$bfc	LDA GCWORK
701	.$bff	STA TMP2_REG
702	.$c02	LDA GCWORK+1
703	.$c05	STA TMP2_REG+1  
704	.$c08	LDA TMP_ZP
705	.$c0a	SEC
706	.$c0b	SBC GCWORK
707	.$c0e	STA TMP3_REG
708	.$c11	LDA TMP_ZP+1
709	.$c13	SBC GCWORK+1
710	.$c16	STA TMP3_REG+1  
711	.$c19	LDA GCSTART
712	.$c1c	CLC
713	.$c1d	ADC TMP3_REG
714	.$c20	STA GCSTART
715	.$c23	LDA GCSTART+1
716	.$c26	ADC TMP3_REG+1
717	.$c29	STA GCSTART+1  
718	.$c2c	JSR QUICKCOPY  
719	.$c2f	LDY #0
720	.$c31	LDA TMP_REG
721	.$c33	STA (TMP2_ZP),Y
722	.$c35	INY
723	.$c36	LDA TMP_REG+1
724	.$c38	STA (TMP2_ZP),Y  
725	.$c3a	JMP GCKLOOP
726	.$c3d	GCDONE  LDA GCSTART
727	.$c40	STA HIGHP
728	.$c43	STA STRBUFP
729	.$c46	LDA GCSTART+1
730	.$c49	STA HIGHP+1
731	.$c4c	STA STRBUFP+1  
732	.$c4f	GCSKIP  JSR RESTOREPOINTERS
733	.$c52	RTS     
736	.$c53	CHECKMEMORY
737	.$c53	LDA STRBUFP+1  
738	.$c56	CMP STORE4+1  
739	.$c59	BCC STILLFITSCM  
743	.$c5b	BEQ CHECKMEMLOWCM
744	.$c5d	JMP OUTOFMEMORY  
745	.$c60	CHECKMEMLOWCM
746	.$c60	LDA STRBUFP   
747	.$c63	CMP STORE4
748	.$c66	BCC STILLFITSCM
749	.$c68	JMP OUTOFMEMORY  
750	.$c6b	STILLFITSCM RTS
753	.$c6c	QUICKCOPY LDA TMP_REG  
754	.$c6e	STA TMEM+1
755	.$c71	LDA TMP_REG+1
756	.$c73	STA TMEM+2
757	.$c76	LDA TMP2_REG
758	.$c79	STA SMEM+1
759	.$c7c	LDA TMP2_REG+1
760	.$c7f	STA SMEM+2
761	.$c82	LDY #$0
762	.$c84	LDX TMP3_REG
763	.$c87	BNE QCLOOP
764	.$c89	LDA TMP3_REG+1
765	.$c8c	BEQ QCEXIT  
766	.$c8e	QCLOOP
767	.$c8e	SMEM  LDA $0000,Y
768	.$c91	TMEM  STA $0000,Y
769	.$c94	INY
770	.$c95	BNE YNOOV
771	.$c97	INC TMEM+2
772	.$c9a	INC SMEM+2
773	.$c9d	YNOOV  DEX
774	.$c9e	BNE QCLOOP
775	.$ca0	LDA TMP3_REG+1
776	.$ca3	BEQ QCEXIT
777	.$ca5	DEC TMP3_REG+1
778	.$ca8	JMP QCLOOP
779	.$cab	QCEXIT  RTS
782	.$cac	COPYSTRING STA TMP2_ZP
783	.$cae	STY TMP2_ZP+1
784	.$cb0	CPY TMP_ZP+1
785	.$cb2	BNE CONTCOPY
786	.$cb4	LDA TMP2_ZP
787	.$cb6	CMP TMP_ZP
788	.$cb8	BNE CONTCOPY
789	.$cba	RTS     
790	.$cbb	CONTCOPY JSR COMPACT   
791	.$cbe	LDY #0
792	.$cc0	STY TMP_FLAG
793	.$cc3	LDA (TMP_ZP),Y
794	.$cc5	BNE NOTEMPTYSTR
795	.$cc7	LDA #<EMPTYSTR  
796	.$cc9	STA TMP_ZP
797	.$ccb	LDA #>EMPTYSTR
798	.$ccd	STA TMP_ZP+1
799	.$ccf	JMP ISCONST
800	.$cd2	NOTEMPTYSTR TAX     
801	.$cd3	LDA (TMP2_ZP),Y
802	.$cd5	STA TMP3_ZP
803	.$cd7	INY
804	.$cd8	LDA (TMP2_ZP),Y
805	.$cda	STA TMP3_ZP+1
806	.$cdc	DEY
807	.$cdd	LDA TMP_ZP+1  
808	.$cdf	CMP #>CONSTANTS_END
809	.$ce1	BEQ CHECKLOW1
810	.$ce3	BCS INVAR
811	.$ce5	JMP CHECKNEXT
812	.$ce8	CHECKLOW1 LDA TMP_ZP
813	.$cea	CMP #<CONSTANTS_END
814	.$cec	BCS INVAR
815	.$cee	CHECKNEXT LDA TMP_ZP+1  
816	.$cf0	CMP #>CONSTANTS
817	.$cf2	BEQ CHECKLOW3
818	.$cf4	BCC INVAR
819	.$cf6	JMP ISCONST
820	.$cf9	CHECKLOW3 LDA TMP_ZP
821	.$cfb	CMP #<CONSTANTS
822	.$cfd	BCC INVAR   
823	.$cff	ISCONST  JSR CHECKLASTVAR 
824	.$d02	LDA TMP_ZP
825	.$d04	STA (TMP2_ZP),Y  
826	.$d06	INY
827	.$d07	LDA TMP_ZP+1
828	.$d09	STA (TMP2_ZP),Y
829	.$d0b	LDA HIGHP   
830	.$d0e	STA STRBUFP
831	.$d11	LDA HIGHP+1
832	.$d14	STA STRBUFP+1
833	.$d17	RTS
834	.$d18	INVAR  INY
835	.$d19	LDA (TMP2_ZP),Y  
836	.$d1b	CMP #>CONSTANTS_END
837	.$d1d	BEQ CHECKLOW2
838	.$d1f	BCS INVAR2
839	.$d21	JMP PUPDATEPTR
840	.$d24	CHECKLOW2 DEY
841	.$d25	LDA (TMP2_ZP),Y
842	.$d27	CMP #<CONSTANTS_END
843	.$d29	BCS INVAR2
844	.$d2b	JMP PUPDATEPTR
845	.$d2e	INVAR2  LDY #0   
846	.$d30	LDA (TMP3_ZP),Y
847	.$d32	STA TMP_REG
848	.$d34	TXA
849	.$d35	CMP TMP_REG  
850	.$d37	BEQ UPDATEHP2 
853	.$d39	PUPDATEPTR JSR CHECKLASTVAR
854	.$d3c	LDY #1   
855	.$d3e	STY TMP_FLAG 
856	.$d41	JMP UPDATEPTR 
857	.$d44	UPDATEHP2 LDA HIGHP  
858	.$d47	STA STRBUFP
859	.$d4a	LDA HIGHP+1
860	.$d4d	STA STRBUFP+1
861	.$d50	JMP STRFITS
862	.$d53	COPYONLY LDY #0
863	.$d55	STY TMP_FLAG
864	.$d58	JMP CHECKMEM
865	.$d5b	ALTCOPY  JMP COPYSTRING2
866	.$d5e	UPDATEPTR LDA TMP_ZP+1 
867	.$d60	CMP HIGHP+1  
868	.$d63	BEQ CHECKXT1
869	.$d65	BCS ALTCOPY
870	.$d67	JMP CHECKMEM
871	.$d6a	CHECKXT1 LDA TMP_ZP
872	.$d6c	CMP HIGHP
873	.$d6f	BCS ALTCOPY
874	.$d71	CHECKMEM
875	.$d71	MEMOK  LDY #0
876	.$d73	LDA STRBUFP  
877	.$d76	STA (TMP2_ZP),Y 
878	.$d78	STA TMP3_ZP
879	.$d7a	LDA STRBUFP+1
880	.$d7d	INY
881	.$d7e	STA (TMP2_ZP),Y
882	.$d80	STA TMP3_ZP+1
883	.$d82	TXA
884	.$d83	CLC
885	.$d84	ADC STRBUFP
886	.$d87	PHP
887	.$d88	CLC
888	.$d89	ADC #3
889	.$d8b	STA STRBUFP
890	.$d8e	BCC NOCS1
891	.$d90	INC STRBUFP+1
892	.$d93	NOCS1  PLP
893	.$d94	BCC STRFITS
894	.$d96	INC STRBUFP+1
895	.$d99	STRFITS  LDY TMP_FLAG 
896	.$d9c	BEQ NOHPUPDATE 
897	.$d9e	LDA HIGHP+1
898	.$da1	CMP STRBUFP+1
899	.$da4	BCC UPDATEHIGHP
900	.$da6	BEQ CHECKNEXTHP
901	.$da8	JMP NOHPUPDATE
902	.$dab	CHECKNEXTHP LDA HIGHP
903	.$dae	CMP STRBUFP
904	.$db1	BCC UPDATEHIGHP
905	.$db3	JMP NOHPUPDATE
906	.$db6	UPDATEHIGHP LDA STRBUFP
907	.$db9	STA HIGHP
908	.$dbc	LDA STRBUFP+1
909	.$dbf	STA HIGHP+1  
910	.$dc2	JSR REMEMBERLASTVAR
911	.$dc5	JSR STOREVARREF
912	.$dc8	NOHPUPDATE LDY #0
913	.$dca	LDA (TMP_ZP),Y 
914	.$dcc	STA (TMP3_ZP),Y
915	.$dce	TAY    
916	.$dcf	BEQ EXITCOPY 
917	.$dd1	LOOP  LDA (TMP_ZP),Y 
918	.$dd3	STA (TMP3_ZP),Y
919	.$dd5	DEY
920	.$dd6	BNE LOOP
921	.$dd8	EXITCOPY RTS
926	.$dd9	COPYSTRING2 LDY #0
927	.$ddb	LDA (TMP_ZP),Y
928	.$ddd	STA TMP_REG
929	.$ddf	TAX
930	.$de0	LDA HIGHP
931	.$de3	STA TMP3_ZP
932	.$de5	STA (TMP2_ZP),Y
933	.$de7	LDA HIGHP+1
934	.$dea	STA TMP3_ZP+1
935	.$dec	INY
936	.$ded	STA (TMP2_ZP),Y
937	.$def	JSR REMEMBERLASTVAR
940	.$df2	LDA TMP_ZP
941	.$df4	CMP TMP3_ZP
942	.$df6	BNE DOLOOP
943	.$df8	LDA TMP_ZP+1
944	.$dfa	CMP TMP3_ZP+1
945	.$dfc	BEQ SKIPCP2
946	.$dfe	DOLOOP  DEY
947	.$dff	TXA
948	.$e00	STA (TMP3_ZP),Y
949	.$e02	INY
950	.$e03	ASLOOP  LDA (TMP_ZP),Y
951	.$e05	STA (TMP3_ZP),Y
952	.$e07	INY
953	.$e08	DEX
954	.$e09	BNE ASLOOP
955	.$e0b	SKIPCP2  LDA HIGHP
956	.$e0e	CLC
957	.$e0f	ADC TMP_REG
958	.$e11	PHP
959	.$e12	CLC
960	.$e13	ADC #3
961	.$e15	STA HIGHP
962	.$e18	STA STRBUFP
963	.$e1b	BCC SKIPLOWAS1
964	.$e1d	INC HIGHP+1
965	.$e20	SKIPLOWAS1 PLP
966	.$e21	BCC SKIPLOWAS2
967	.$e23	INC HIGHP+1
968	.$e26	SKIPLOWAS2 LDA HIGHP+1
969	.$e29	STA STRBUFP+1
970	.$e2c	JSR STOREVARREF
971	.$e2f	RTS
975	.$e30	CHECKLASTVAR
976	.$e30	LDA TMP2_ZP
977	.$e32	CMP LASTVAR
978	.$e35	BNE NOTSAMEVAR
979	.$e37	LDA TMP2_ZP+1
980	.$e39	CMP LASTVAR+1
981	.$e3c	BNE NOTSAMEVAR
982	.$e3e	LDA LASTVARP   
983	.$e41	STA HIGHP
984	.$e44	STA STRBUFP
985	.$e47	LDA LASTVARP+1
986	.$e4a	STA HIGHP+1
987	.$e4d	STA STRBUFP+1
988	.$e50	NOTSAMEVAR RTS
992	.$e51	REMEMBERLASTVAR
993	.$e51	LDA TMP2_ZP
994	.$e53	STA LASTVAR
995	.$e56	LDA TMP2_ZP+1
996	.$e58	STA LASTVAR+1
997	.$e5b	LDA TMP3_ZP
998	.$e5d	STA LASTVARP
999	.$e60	LDA TMP3_ZP+1
1000	.$e62	STA LASTVARP+1 
1001	.$e65	RTS
1006	.$e66	STOREVARREF
1007	.$e66	TYA
1008	.$e67	PHA    
1009	.$e68	LDA TMP_ZP
1010	.$e6a	PHA
1011	.$e6b	LDA TMP_ZP+1
1012	.$e6d	PHA
1013	.$e6e	LDA HIGHP+1
1014	.$e71	STA TMP_ZP+1
1015	.$e73	LDA HIGHP
1016	.$e76	SEC
1017	.$e77	SBC #2
1018	.$e79	STA TMP_ZP
1019	.$e7b	BCS RLVNOOV
1020	.$e7d	DEC TMP_ZP+1
1021	.$e7f	RLVNOOV  LDA TMP2_ZP
1022	.$e81	LDY #0
1023	.$e83	STA (TMP_ZP),Y
1024	.$e85	LDA TMP2_ZP+1
1025	.$e87	INY
1026	.$e88	STA (TMP_ZP),Y 
1027	.$e8a	PLA
1028	.$e8b	STA TMP_ZP+1
1029	.$e8d	PLA
1030	.$e8e	STA TMP_ZP  
1031	.$e90	PLA
1032	.$e91	TAY    
1033	.$e92	RTS
1036	.$e93	REROUTE  LDA CMD_NUM  
1037	.$e96	BEQ REROUTECMD
1038	.$e98	TAX
1039	.$e99	STA CHANNEL
1040	.$e9c	JMP CHKOUT
1041	.$e9f	REROUTECMD RTS
1044	.$ea0	RESETROUTE LDA CMD_NUM  
1045	.$ea3	BEQ RESETROUTECMD
1046	.$ea5	JMP CLRCHNEW
1047	.$ea8	RESETROUTECMD
1048	.$ea8	RTS
1051	.$ea9	LINEBREAK JSR REROUTE
1052	.$eac	LDA #$0D
1053	.$eae	JSR CHROUT
1054	.$eb1	JMP RESETROUTE
1057	.$eb4	STROUTBRKWL STA A_REG
1058	.$eb7	STY A_REG+1
1059	.$eba	STROUTBRK JSR REROUTE
1060	.$ebd	LDA A_REG
1061	.$ec0	STA INDEX1
1062	.$ec2	LDA A_REG+1
1063	.$ec5	STA INDEX1+1
1064	.$ec7	LDY #0
1065	.$ec9	LDA (INDEX1),Y
1066	.$ecb	TAX
1067	.$ecc	INC INDEX1
1068	.$ece	BNE PRINTSTR2
1069	.$ed0	INC INDEX1+1
1070	.$ed2	PRINTSTR2 JSR PRINTSTRS
1071	.$ed5	LDA HIGHP   
1072	.$ed8	STA STRBUFP
1073	.$edb	LDA HIGHP+1
1074	.$ede	STA STRBUFP+1
1075	.$ee1	LDA #$0D
1076	.$ee3	JSR CHROUT
1077	.$ee6	JMP RESETROUTE  
1080	.$ee9	ADJUSTSTACK LDA FORSTACKP 
1081	.$eec	STA TMP_ZP
1082	.$eee	LDA FORSTACKP+1
1083	.$ef1	STA TMP_ZP+1
1084	.$ef3	ADSEARCHFOR LDA TMP_ZP
1085	.$ef5	CMP #<FORSTACK
1086	.$ef7	BNE ADJUST2
1087	.$ef9	LDA TMP_ZP+1
1088	.$efb	CMP #>FORSTACK
1089	.$efd	BNE ADJUST2
1090	.$eff	RTS    
1091	.$f00	ADJUST2  LDA TMP_ZP
1092	.$f02	SEC
1093	.$f03	SBC #2
1094	.$f05	STA TMP_ZP
1095	.$f07	BCS ADNOPV1N1
1096	.$f09	DEC TMP_ZP+1
1097	.$f0b	ADNOPV1N1 LDY #0
1098	.$f0d	LDA (TMP_ZP),Y
1099	.$f0f	BNE ADNOGOSUB
1100	.$f11	RTS    
1101	.$f12	ADNOGOSUB
1102	.$f12	INY
1103	.$f13	LDA TMP_ZP
1104	.$f15	SEC
1105	.$f16	SBC (TMP_ZP),Y
1106	.$f18	STA TMP_ZP
1107	.$f1a	BCS ADNOPV1N2
1108	.$f1c	DEC TMP_ZP+1
1109	.$f1e	ADNOPV1N2 DEY
1110	.$f1f	LDA A_REG
1111	.$f22	ADCMPFOR CMP (TMP_ZP),Y
1112	.$f24	BNE ADSEARCHFOR
1113	.$f26	LDA A_REG+1
1114	.$f29	INY
1115	.$f2a	CMP (TMP_ZP),Y
1116	.$f2c	BEQ ADFOUNDFOR
1117	.$f2e	JMP ADSEARCHFOR
1118	.$f31	ADLOW0  LDX A_REG+1
1119	.$f34	BEQ ADFOUNDFOR
1120	.$f36	BNE ADCMPFOR
1121	.$f38	ADFOUNDFOR LDA TMP_ZP  
1122	.$f3a	STA FORSTACKP
1123	.$f3d	LDA TMP_ZP+1
1124	.$f3f	STA FORSTACKP+1
1125	.$f42	RTS
1128	.$f43	INITFOR  JSR ADJUSTSTACK
1129	.$f46	LDA FORSTACKP
1130	.$f49	STA TMP_ZP
1131	.$f4b	LDA FORSTACKP+1
1132	.$f4e	STA TMP_ZP+1
1133	.$f50	LDY #0
1134	.$f52	LDA A_REG
1135	.$f55	STA (TMP_ZP),Y
1136	.$f57	INY
1137	.$f58	LDA A_REG+1
1138	.$f5b	STA (TMP_ZP),Y
1139	.$f5d	INY
1140	.$f5e	LDA JUMP_TARGET
1141	.$f60	STA (TMP_ZP),Y
1142	.$f62	INY
1143	.$f63	LDA JUMP_TARGET+1
1144	.$f65	STA (TMP_ZP),Y
1145	.$f67	INY
1146	.$f68	STY TMP3_ZP
1147	.$f6a	JSR INCTMPZP
1148	.$f6d	JSR POPREAL
1149	.$f70	LDX TMP_ZP
1150	.$f72	LDY TMP_ZP+1
1152	.$f74	JSR FACMEM
1153	.$f77	JSR SGNFAC
1154	.$f7a	STA TMP_FLAG
1155	.$f7d	LDY #5
1156	.$f7f	STY TMP3_ZP
1157	.$f81	JSR INCTMPZP
1158	.$f84	JSR POPREAL
1159	.$f87	LDX TMP_ZP
1160	.$f89	LDY TMP_ZP+1
1162	.$f8b	JSR FACMEM
1163	.$f8e	LDY #5
1164	.$f90	STY TMP3_ZP
1165	.$f92	JSR INCTMPZP
1166	.$f95	LDY #0
1167	.$f97	LDA TMP_FLAG
1168	.$f9a	STA (TMP_ZP),Y
1169	.$f9c	INY
1170	.$f9d	LDA #1
1171	.$f9f	STA (TMP_ZP),Y
1172	.$fa1	INY
1173	.$fa2	LDA #15
1174	.$fa4	STA (TMP_ZP),Y
1175	.$fa6	LDY #3
1176	.$fa8	STY TMP3_ZP
1177	.$faa	JSR INCTMPZP
1178	.$fad	LDA TMP_ZP
1179	.$faf	STA FORSTACKP
1180	.$fb2	LDA TMP_ZP+1
1181	.$fb4	STA FORSTACKP+1
1182	.$fb7	RTS
1185	.$fb8	NEXT  LDA FORSTACKP
1186	.$fbb	STA TMP_ZP
1187	.$fbd	LDA FORSTACKP+1
1188	.$fc0	STA TMP_ZP+1
1189	.$fc2	SEARCHFOR LDA TMP_ZP+1
1190	.$fc4	STA TMP3_REG+1
1191	.$fc7	LDA TMP_ZP
1192	.$fc9	STA TMP3_REG
1193	.$fcc	SEC
1194	.$fcd	SBC #2
1195	.$fcf	STA TMP_ZP
1196	.$fd1	BCS NOPV1N1
1197	.$fd3	DEC TMP_ZP+1
1198	.$fd5	NOPV1N1  LDY #0
1199	.$fd7	LDA (TMP_ZP),Y
1200	.$fd9	BNE NOGOSUB
1201	.$fdb	JMP NEXTWOFOR
1202	.$fde	NOGOSUB
1203	.$fde	INY
1204	.$fdf	LDA TMP_ZP
1205	.$fe1	SEC
1206	.$fe2	SBC (TMP_ZP),Y
1207	.$fe4	STA TMP_ZP
1208	.$fe6	BCS NOPV1N2
1209	.$fe8	DEC TMP_ZP+1
1210	.$fea	NOPV1N2  DEY
1211	.$feb	LDA A_REG
1212	.$fee	BEQ LOW0
1213	.$ff0	CMPFOR  CMP (TMP_ZP),Y
1214	.$ff2	BNE SEARCHFOR
1215	.$ff4	LDA A_REG+1
1216	.$ff7	INY
1217	.$ff8	CMP (TMP_ZP),Y
1218	.$ffa	BEQ FOUNDFOR
1219	.$ffc	JMP SEARCHFOR
1220	.$fff	LOW0  LDX A_REG+1
1221	.$1002	BEQ FOUNDFOR
1222	.$1004	BNE CMPFOR
1223	.$1006	FOUNDFOR LDA TMP_ZP
1224	.$1008	STA TMP2_REG
1225	.$100b	LDA TMP_ZP+1
1226	.$100d	STA TMP2_REG+1
1227	.$1010	VARREAL
1228	.$1010	LDY #0
1229	.$1012	STY A_REG+1 
1230	.$1015	LDA (TMP_ZP),Y
1231	.$1017	TAX
1232	.$1018	INY
1233	.$1019	LDA (TMP_ZP),Y
1234	.$101b	TAY
1235	.$101c	TXA
1236	.$101d	JSR REALFAC
1237	.$1020	CALCNEXT LDA TMP_ZP
1238	.$1022	CLC
1239	.$1023	ADC #4
1240	.$1025	STA TMP_ZP
1241	.$1027	BCC NOPV2IN
1242	.$1029	INC TMP_ZP+1
1243	.$102b	NOPV2IN  STA TMP_REG
1244	.$102d	LDY TMP_ZP+1
1245	.$102f	STY TMP_REG+1
1246	.$1031	JSR FASTFADDMEM
1248	.$1034	LDA TMP2_REG
1249	.$1037	STA TMP_ZP
1250	.$1039	LDA TMP2_REG+1
1251	.$103c	STA TMP_ZP+1
1252	.$103e	STOREREAL
1253	.$103e	LDY #0
1254	.$1040	LDA (TMP_ZP),Y
1255	.$1042	TAX
1256	.$1043	INY
1257	.$1044	LDA (TMP_ZP),Y
1258	.$1046	TAY
1259	.$1047	JSR FACMEM 
1260	.$104a	CMPFORXX LDA #5
1261	.$104c	STA TMP3_ZP
1262	.$104e	LDA TMP_REG
1263	.$1050	CLC
1264	.$1051	ADC #5
1265	.$1053	STA TMP_REG
1266	.$1055	BCC NOPV3
1267	.$1057	INC TMP_REG+1
1268	.$1059	NOPV3  LDY TMP_REG+1
1269	.$105b	JSR CMPFAC  
1270	.$105e	BEQ LOOPING
1271	.$1060	PHA
1272	.$1061	LDY #14
1273	.$1063	LDA (TMP_ZP),Y
1274	.$1065	BEQ STEPZERO
1275	.$1067	ROL
1276	.$1068	BCC STEPPOS
1277	.$106a	STEPNEG  PLA
1278	.$106b	ROL
1279	.$106c	BCC LOOPING
1280	.$106e	BCS EXITLOOP
1281	.$1070	STEPPOS  PLA
1282	.$1071	ROL
1283	.$1072	BCC EXITLOOP
1284	.$1074	LOOPING  LDA TMP3_REG
1285	.$1077	STA FORSTACKP
1286	.$107a	LDA TMP3_REG+1
1287	.$107d	STA FORSTACKP+1
1288	.$1080	LDA TMP2_REG
1289	.$1083	CLC
1290	.$1084	ADC #2
1291	.$1086	STA TMP2_REG
1292	.$1089	BCC NOPV4IN
1293	.$108b	INC TMP2_REG+1
1294	.$108e	NOPV4IN  LDY #0
1295	.$1090	STY A_REG
1296	.$1093	STA TMP_ZP
1297	.$1095	LDA TMP2_REG+1
1298	.$1098	STA TMP_ZP+1
1299	.$109a	LDA (TMP_ZP),Y
1300	.$109c	STA JUMP_TARGET
1301	.$109e	INY
1302	.$109f	LDA (TMP_ZP),Y
1303	.$10a1	STA JUMP_TARGET+1
1304	.$10a3	RTS
1305	.$10a4	STEPZERO PLA
1306	.$10a5	JMP LOOPING
1307	.$10a8	EXITLOOP LDA TMP2_REG
1308	.$10ab	STA FORSTACKP
1309	.$10ae	LDA TMP2_REG+1
1310	.$10b1	STA FORSTACKP+1
1311	.$10b4	LDA #1
1312	.$10b6	STA A_REG
1313	.$10b9	RTS
1316	.$10ba	REALFACPUSH STA TMP_ZP
1317	.$10bc	STY TMP_ZP+1
1318	.$10be	LDX FPSTACKP
1319	.$10c1	LDY FPSTACKP+1
1320	.$10c4	STX TMP2_ZP
1321	.$10c6	STY TMP2_ZP+1
1322	.$10c8	LDY #0
1323	.$10ca	LDA (TMP_ZP),Y
1324	.$10cc	STA (TMP2_ZP),Y
1325	.$10ce	INY
1326	.$10cf	LDA (TMP_ZP),Y
1327	.$10d1	STA (TMP2_ZP),Y
1328	.$10d3	INY
1329	.$10d4	LDA (TMP_ZP),Y
1330	.$10d6	STA (TMP2_ZP),Y
1331	.$10d8	INY
1332	.$10d9	LDA (TMP_ZP),Y
1333	.$10db	STA (TMP2_ZP),Y
1334	.$10dd	INY
1335	.$10de	LDA (TMP_ZP),Y
1336	.$10e0	STA (TMP2_ZP),Y
1337	.$10e2	TXA    
1338	.$10e3	CLC
1339	.$10e4	ADC #5
1340	.$10e6	STA FPSTACKP
1341	.$10e9	BCC NOPVRFPXX
1342	.$10eb	INC FPSTACKP+1
1343	.$10ee	NOPVRFPXX RTS
1346	.$10ef	POPREAL2X LDA FPSTACKP
1347	.$10f2	SEC
1348	.$10f3	SBC #5
1349	.$10f5	STA FPSTACKP
1350	.$10f8	BCS NOPVPR2X
1351	.$10fa	DEC FPSTACKP+1
1352	.$10fd	NOPVPR2X LDA FPSTACKP
1353	.$1100	LDY FPSTACKP+1
1354	.$1103	JSR REALFAC
1355	.$1106	JSR XREGARG
1356	.$1109	RTS
1359	.$110a	POPREAL  LDA FPSTACKP
1360	.$110d	SEC
1361	.$110e	SBC #5
1362	.$1110	STA FPSTACKP
1363	.$1113	BCS NOPVPR
1364	.$1115	DEC FPSTACKP+1
1365	.$1118	NOPVPR  LDA FPSTACKP
1366	.$111b	LDY FPSTACKP+1
1367	.$111e	JMP REALFAC
1370	.$1121	INCTMPZP LDA TMP_ZP
1371	.$1123	CLC
1372	.$1124	ADC TMP3_ZP
1373	.$1126	STA TMP_ZP
1374	.$1128	BCC NOPV2
1375	.$112a	INC TMP_ZP+1
1376	.$112c	NOPV2  RTS
1379	.$112d	ONETOFAC    LDX #129
1380	.$112f	STX FAC
1381	.$1131	DEX
1382	.$1132	STX FAC+1
1383	.$1134	LDX #0
1384	.$1136	STX FAC+2
1385	.$1138	STX FAC+3
1386	.$113a	STX FAC+4
1387	.$113c	STX FAC+5
1388	.$113e	STX FAC+15
1389	.$1140	RTS
1392	.$1141	FASTAND  LDA ARGEXP   
1393	.$1143	BNE CHECKFAC
1394	.$1145	STA FACSGN   
1395	.$1147	STA FACLO
1396	.$1149	STA FACMO
1397	.$114b	STA FACMOH
1398	.$114d	STA FACHO
1399	.$114f	STA FACEXP
1400	.$1151	RTS
1401	.$1152	CHECKFAC LDA FACEXP   
1402	.$1154	BNE FACNOTNULL
1403	.$1156	STA FACSGN   
1404	.$1158	RTS    
1405	.$1159	FACNOTNULL CMP #$81
1406	.$115b	BNE NORMALAND
1407	.$115d	LDA FACHO
1408	.$115f	CMP #$80
1409	.$1161	BNE NORMALAND
1410	.$1163	LDA FACMOH
1411	.$1165	BNE NORMALAND
1412	.$1167	LDA FACMO
1413	.$1169	BNE NORMALAND
1414	.$116b	LDA FACLO
1415	.$116d	BNE NORMALAND
1416	.$116f	LDA FACSGN
1417	.$1171	ROL
1418	.$1172	BCC NORMALAND
1419	.$1174	LDA ARGEXP   
1420	.$1176	CMP #$81
1421	.$1178	BNE NORMALAND
1422	.$117a	LDA ARGHO
1423	.$117c	CMP #$80
1424	.$117e	BNE NORMALAND
1425	.$1180	LDA ARGMOH
1426	.$1182	BNE NORMALAND
1427	.$1184	LDA ARGMO
1428	.$1186	BNE NORMALAND
1429	.$1188	LDA ARGLO
1430	.$118a	BNE NORMALAND
1431	.$118c	LDA ARGSGN
1432	.$118e	ROL
1433	.$118f	BCC NORMALAND
1434	.$1191	RTS    
1435	.$1192	NORMALAND JMP ARGAND
1438	.$1195	CLRCHNEW
1439	.$1195	LDA CHLOCKFLAG
1440	.$1198	BNE SKIPCLRCH
1441	.$119a	JMP CLRCH
1442	.$119d	SKIPCLRCH
1443	.$119d	RTS
1446	.$119e	NEXTWOFOR
1450	.$119e	LDX #$0A
1451	.$11a0	JMP ERRALL
1454	.$11a3	OUTOFMEMORY
1458	.$11a3	LDX #$10
1459	.$11a5	JMP ERRALL
1462	.$11a8	ILLEGALQUANTITY
1466	.$11a8	JMP ERRIQ
1469	.$11ab	FACXREG  LDA FACLO
1470	.$11ad	STA X_REG+4
1471	.$11af	LDA FACMO
1472	.$11b1	STA X_REG+3
1473	.$11b3	LDA FACMOH
1474	.$11b5	STA X_REG+2
1475	.$11b7	LDA FACSGN
1476	.$11b9	ORA #$7F
1477	.$11bb	AND FACHO
1478	.$11bd	STA X_REG+1
1479	.$11bf	LDA FACEXP
1480	.$11c1	STA X_REG
1481	.$11c3	LDA #0   
1482	.$11c5	STA FACOV
1483	.$11c7	RTS
1486	.$11c8	XREGARG  LDA X_REG+4
1487	.$11ca	STA ARGLO
1488	.$11cc	LDA X_REG+3
1489	.$11ce	STA ARGMO
1490	.$11d0	LDA X_REG+2
1491	.$11d2	STA ARGMOH
1492	.$11d4	LDA X_REG+1
1493	.$11d6	STA ARGSGN
1494	.$11d8	EOR FACSGN
1495	.$11da	STA ARISGN
1496	.$11dc	LDA ARGSGN
1497	.$11de	ORA #$80
1498	.$11e0	STA ARGHO
1499	.$11e2	LDA X_REG
1500	.$11e4	STA ARGEXP
1501	.$11e6	LDA FACEXP
1502	.$11e8	RTS
1616	.$11e9	FASTFADDMEM
1617	.$11e9	JSR MEMARG
1618	.$11ec	FASTFADDARG
1619	.$11ec	BNE FADDRET2     
1620	.$11ee	JMP ARGFAC
1621	.$11f1	FADDRET2 LDA ARGEXP
1622	.$11f3	BNE FADDRET1     
1623	.$11f5	RTS
1624	.$11f6	FADDRET1 SEC
1625	.$11f7	SBC FACEXP
1626	.$11f9	BEQ FFADD_EXPEQ     
1627	.$11fb	BCC FFADD_SHFARG1   
1631	.$11fd	LDY ARGEXP
1632	.$11ff	STY FACEXP
1633	.$1201	LDY ARGSGN
1634	.$1203	STY FACSGN
1635	.$1205	LDX #0
1636	.$1207	STX OLDOV        
1637	.$1209	LDX #FAC         
1639	.$120b	SEC
1640	.$120c	SBC #$08
1641	.$120e	BMI FFADD_SHFFAC2
1643	.$1210	FFADD_SHFFAC1
1644	.$1210	LDY FACLO        
1645	.$1212	STY FACOV
1646	.$1214	LDY FACMO        
1647	.$1216	STY FACMO+1
1648	.$1218	LDY FACMOH       
1649	.$121a	STY FACMOH+1
1650	.$121c	LDY FACHO        
1651	.$121e	STY FACHO+1
1652	.$1220	LDY #0
1653	.$1222	STY FACHO        
1654	.$1224	SBC #$08         
1655	.$1226	BPL FFADD_SHFFAC1   
1656	.$1228	FFADD_SHFFAC2
1657	.$1228	ADC #$08         
1658	.$122a	BEQ FFADD_SHFFAC4   
1659	.$122c	TAY
1660	.$122d	LDA FACOV
1661	.$122f	FFADD_SHFFAC3
1662	.$122f	LSR FACHO        
1663	.$1231	ROR FACMOH       
1664	.$1233	ROR FACMO        
1665	.$1235	ROR FACLO        
1666	.$1237	ROR              
1667	.$1238	DEY
1668	.$1239	BNE FFADD_SHFFAC3
1669	.$123b	JMP FFADD_MANADD2   
1670	.$123e	FFADD_SHFFAC4
1671	.$123e	LDA FACOV        
1672	.$1240	JMP FFADD_MANADD2
1673	.$1243	FFADD_EXPEQ
1674	.$1243	LDX FACOV
1675	.$1245	STX OLDOV
1678	.$1247	JMP FFADD_MANADD1
1679	.$124a	FFADD_SHFARG2
1680	.$124a	LDA FACOV        
1681	.$124c	JMP FFADD_MANADD1
1682	.$124f	FFADD_SHFARG1
1683	.$124f	LDX FACOV
1684	.$1251	STX OLDOV        
1685	.$1253	LDX #$00         
1688	.$1255	ADC #$08
1689	.$1257	BPL FFADD_SHFARG6   
1690	.$1259	FFADD_SHFARG3
1691	.$1259	LDX ARGLO        
1692	.$125b	LDY ARGMO        
1693	.$125d	STY ARGMO+1
1694	.$125f	LDY ARGMOH       
1695	.$1261	STY ARGMOH+1
1696	.$1263	LDY ARGHO        
1697	.$1265	STY ARGHO+1
1698	.$1267	LDY #0
1699	.$1269	STY ARGHO        
1700	.$126b	FFADD_SHFARG4
1701	.$126b	ADC #$08
1702	.$126d	BMI FFADD_SHFARG3
1703	.$126f	BEQ FFADD_SHFARG3
1704	.$1271	FFADD_SHFARG6
1705	.$1271	SBC #$08
1706	.$1273	BEQ FFADD_SHFARG2   
1707	.$1275	TAY
1708	.$1276	TXA              
1709	.$1277	FFADD_SHFARG5
1710	.$1277	LSR ARGHO
1711	.$1279	ROR ARGMOH
1712	.$127b	ROR ARGMO
1713	.$127d	ROR ARGLO
1714	.$127f	ROR           
1715	.$1280	INY
1716	.$1281	BNE FFADD_SHFARG5
1717	.$1283	FFADD_MANADD1
1718	.$1283	LDX #ARGEXP      
1719	.$1285	FFADD_MANADD2
1720	.$1285	BIT ARISGN
1721	.$1287	BMI FFADD_MANSUB1   
1722	.$1289	CLC
1723	.$128a	ADC OLDOV
1724	.$128c	STA FACOV
1725	.$128e	LDA FACLO
1726	.$1290	ADC ARGLO
1727	.$1292	STA FACLO
1728	.$1294	LDA FACMO
1729	.$1296	ADC ARGMO
1730	.$1298	STA FACMO
1731	.$129a	LDA FACMOH
1732	.$129c	ADC ARGMOH
1733	.$129e	STA FACMOH
1734	.$12a0	LDA FACHO
1735	.$12a2	ADC ARGHO
1736	.$12a4	STA FACHO
1737	.$12a6	BCC FFADD_RNDRTS
1738	.$12a8	INC FACEXP
1739	.$12aa	BEQ FFADD_OVERR
1741	.$12ac	ROR FACHO
1742	.$12ae	ROR FACMOH
1743	.$12b0	ROR FACMO
1744	.$12b2	ROR FACLO
1745	.$12b4	ROR FACOV
1746	.$12b6	FFADD_RNDRTS
1747	.$12b6	RTS
1748	.$12b7	FFADD_OVERR
1749	.$12b7	JMP ILLEGALQUANTITY
1750	.$12ba	FFADD_MANSUB1
1751	.$12ba	LDY #FACEXP
1752	.$12bc	CPX #ARGEXP
1753	.$12be	BEQ FFADD_MANSUB2
1754	.$12c0	LDY #ARGEXP
1755	.$12c2	FFADD_MANSUB2
1756	.$12c2	SEC              
1757	.$12c3	EOR #$FF
1758	.$12c5	ADC OLDOV
1759	.$12c7	STA FACOV
1760	.$12c9	LDA 4,Y
1761	.$12cc	SBC 4,X
1762	.$12ce	STA FACLO
1763	.$12d0	LDA 3,Y
1764	.$12d3	SBC 3,X
1765	.$12d5	STA FACMO
1766	.$12d7	LDA 2,Y
1767	.$12da	SBC 2,X
1768	.$12dc	STA FACMOH
1769	.$12de	LDA 1,Y
1770	.$12e1	SBC 1,X
1771	.$12e3	STA FACHO
1772	.$12e5	BCS FCNORMAL
1773	.$12e7	LDA FACSGN
1774	.$12e9	EOR #$FF
1775	.$12eb	STA FACSGN
1776	.$12ed	LDA FACHO
1777	.$12ef	EOR #$FF
1778	.$12f1	STA FACHO
1779	.$12f3	LDA FACMOH
1780	.$12f5	EOR #$FF
1781	.$12f7	STA FACMOH
1782	.$12f9	LDA FACMO
1783	.$12fb	EOR #$FF
1784	.$12fd	STA FACMO
1785	.$12ff	LDA FACLO
1786	.$1301	EOR #$FF
1787	.$1303	STA FACLO
1788	.$1305	LDA FACOV
1789	.$1307	EOR #$FF
1790	.$1309	CLC
1791	.$130a	ADC #1
1792	.$130c	STA FACOV
1793	.$130e	BNE FCNORMAL
1794	.$1310	INC FACLO
1795	.$1312	BNE FCNORMAL
1796	.$1314	INC FACMO
1797	.$1316	BNE FCNORMAL
1798	.$1318	INC FACMOH
1799	.$131a	BNE FCNORMAL
1800	.$131c	INC FACHO
1801	.$131e	FCNORMAL   BIT FACHO
1802	.$1320	BMI FFADD_RET       
1803	.$1322	LDA #0           
1804	.$1324	CLC
1805	.$1325	FFADD_NORM3
1806	.$1325	LDX FACHO
1807	.$1327	BNE FFADD_NORM1
1808	.$1329	LDX FACHO+1
1809	.$132b	STX FACHO
1810	.$132d	LDX FACMOH+1
1811	.$132f	STX FACMOH
1812	.$1331	LDX FACMO+1
1813	.$1333	STX FACMO
1814	.$1335	LDX FACOV
1815	.$1337	STX FACLO
1816	.$1339	LDX #0
1817	.$133b	STX FACOV
1818	.$133d	ADC #$08
1819	.$133f	CMP #$20
1820	.$1341	BNE FFADD_NORM3
1821	.$1343	JMP FFADD_ZEROFAC
1822	.$1346	FFADD_NORM2
1823	.$1346	CLC
1824	.$1347	ADC #1
1825	.$1349	ASL FACOV
1826	.$134b	ROL FACLO
1827	.$134d	ROL FACMO
1828	.$134f	ROL FACMOH
1829	.$1351	ROL FACHO
1830	.$1353	FFADD_NORM1
1831	.$1353	BPL FFADD_NORM2     
1832	.$1355	SEC
1833	.$1356	SBC FACEXP
1834	.$1358	BCS FFADD_ZEROFAC
1835	.$135a	EOR #$FF
1836	.$135c	CLC
1837	.$135d	ADC #1
1838	.$135f	STA FACEXP
1839	.$1361	FFADD_RET   RTS
1840	.$1362	FFADD_ZEROFAC
1841	.$1362	LDX #0
1842	.$1364	STX FACEXP
1843	.$1366	STX FACSGN
1844	.$1368	RTS
1847	.$1369	INITVARS
1848	.$1369	JSR INITSTRVARS
1849	.$136c	LDA #0
1850	.$136e	LDY #4
1851	.$1370	REALINITLOOP0:
1852	.$1370	STA VAR_J,Y
1853	.$1373	STA VAR_I,Y
1854	.$1376	DEY
1855	.$1377	BMI REALLOOPEXIT0
1856	.$1379	JMP REALINITLOOP0
1857	.$137c	REALLOOPEXIT0:
1858	.$137c	RTS
1862	.$137d	CONSTANTS
1864	.$137d	CONST_0 .BYTE 6
1865	.$137e	.STRG "000000"
1871	.$1384	CONST_2R .REAL 5000.0
1874	.$1389	CONST_3R .REAL 1.0
1877	.$138e	CONST_4R .REAL 3.0
1880	.$1393	CONST_5R .REAL 2.0
1883	.$1398	CONST_6R .REAL 100.0
1889	.$139d	DATAS
1890	.$139d	.BYTE $FF
1892	.$139e	CONSTANTS_END
1895	.$139e	VARIABLES
1897	.$139e	VAR_J .REAL 0.0
1899	.$13a3	VAR_I .REAL 0.0
1900	.$13a8	STRINGVARS_START
1902	.$13a8	VAR_TI$ .WORD EMPTYSTR
1903	.$13aa	STRINGVARS_END
1904	.$13aa	STRINGARRAYS_START
1905	.$13aa	STRINGARRAYS_END
1906	.$13aa	VARIABLES_END
1908	.$13aa	Y_REG .REAL 0.0
1909	.$13af	C_REG .REAL 0.0
1910	.$13b4	D_REG .REAL 0.0
1911	.$13b9	E_REG .REAL 0.0
1912	.$13be	F_REG .REAL 0.0
1913	.$13c3	A_REG .WORD 0
1914	.$13c5	B_REG .WORD 0
1915	.$13c7	CMD_NUM .BYTE 0
1916	.$13c8	CHANNEL .BYTE 0
1917	.$13c9	SP_SAVE .BYTE 0
1918	.$13ca	TMP2_REG .WORD 0
1919	.$13cc	TMP3_REG .WORD 0
1920	.$13ce	TMP4_REG .WORD 0
1921	.$13d0	AS_TMP .WORD 0
1922	.$13d2	BPOINTER_TMP .WORD 0
1923	.$13d4	BASICTEXTP .BYTE 0
1924	.$13d5	STORE1 .WORD 0
1925	.$13d7	STORE2 .WORD 0
1926	.$13d9	STORE3 .WORD 0
1927	.$13db	STORE4 .WORD 0
1928	.$13dd	GCSTART .WORD 0
1929	.$13df	GCLEN .WORD 0
1930	.$13e1	GCWORK .WORD 0
1931	.$13e3	INPUTLENGTH .BYTE 0
1932	.$13e4	TMP_FREG .REAL 0
1933	.$13e9	TMP2_FREG .REAL 0
1934	.$13ee	TMP_FLAG .BYTE 0
1935	.$13ef	INT_FLAG .BYTE 0
1936	.$13f0	REAL_CONST_ONE .REAL 1.0
1937	.$13f5	REAL_CONST_ZERO .REAL 0.0
1938	.$13fa	REAL_CONST_MINUS_ONE .REAL -1.0
1939	.$13ff	CHLOCKFLAG .BYTE 0
1940	.$1400	EMPTYSTR .BYTE 0
1941	.$1401	FPSTACKP .WORD FPSTACK
1942	.$1403	FORSTACKP .WORD FORSTACK
1943	.$1405	DATASP .WORD DATAS
1944	.$1407	LASTVAR .WORD 0
1945	.$1409	LASTVARP .WORD 0
1946	.$140b	HIGHP .WORD STRBUF
1947	.$140d	STRBUFP .WORD STRBUF
1948	.$140f	ENDSTRBUF .WORD 0
1949	.$1411	INPUTQUEUEP .BYTE 0
1950	.$1412	PROGRAMEND
1951	.$1412	INPUTQUEUE .ARRAY $0F
1952	.$1421	FPSTACK .ARRAY 100
1953	.$1485	FORSTACK .ARRAY 340
1954	.$15d9	STRBUF .BYTE 0

10 SCREEN 128
20 TI=0
30 FOR I=0 TO 500:XP=RND(1)*300+10:YP=RND(1)*180+10
35 CC=RND(1)*14+2:XR=RND(1)*120+2::YR=RND(1)*120+2
38 GOSUB 60000:NEXT
40 RECT 0,0,319,199,1:PRINT "TIME:";TI:END
59990 REM **********************************************
59991 REM * ELLIPSE ROUTINE         
59992 REM * XP,YP: 	CENTER         
59993 REM * XR,YR: 	RADIUS			
59994 REM * CC:		COLOR			
59995 REM * USES: 	XD,PC,SC,XT,YT,X1,Y1,X2,Y2
59996 REM *			X3,Y3,X4,Y4,X5,Y5,WC
59997 REM **********************************************
60000 IF XR=0 OR YR=0 THEN RETURN
60005 PC=6.2831853:XD=XR:IF YR>XR THEN XD=YR
60010 X1=XP:Y1=YR+YP:PC=PC/4:SC=PC/(16+(6*(XD>80))):XT=XP+XP:YT=YP+YP
60020 FOR WC=SC TO PC STEP SC:GOSUB 60100:NEXT
60070 IF PC=WC THEN 60090
60075 WC=PC:GOSUB 60100
60090 RETURN 
60100 X2=XR*SIN(WC)+XP:Y2=YR*COS(WC)+YP
60115 X5=X2:Y5=Y2
60120 GOSUB 60200:X1=XT-X1:X2=XT-X2
60130 GOSUB 60200:Y1=YT-Y1:Y2=YT-Y2
60140 GOSUB 60200:X1=XT-X1:X2=X5
60150 GOSUB 60200:X1=X5:Y1=Y5:RETURN
60200 IF X1<=0 THEN IF X2<=0 THEN RETURN
60202 IF Y1<=0 THEN IF Y2<=0 THEN RETURN
60204 IF X1>=319 THEN IF X2>=319 THEN RETURN
60206 IF Y1>=199 THEN IF Y2>=199 THEN RETURN
60210 X3=X1+.5:Y3=Y1+.5:X4=X2+.5:Y4=Y2+.5
60230 IF Y1<0 THEN X3=X1-Y1*(X2-X1)/(Y2-Y1):Y3=0:GOSUB 60600:GOTO 60250
60240 IF Y1>199 THEN X3=X1+(Y1-199)*(X2-X1)/(Y1-Y2):Y3=199:GOSUB 60600
60250 IF X2<0 THEN Y4=Y2-X2*(Y2-Y1)/(X2-X1):X4=0:GOSUB 60650:GOTO 60330
60260 IF X2>319 THEN Y4=Y2+(X2-319)*(Y2-Y1)/(X1-X2):X4=319:GOSUB 60650
60330 LINE X3,Y3,X4,Y4,CC
60500 RETURN
60600 IF X3<0 THEN X3=0
60620 IF X3>319 THEN X3=319
60635 RETURN
60650 IF Y4<0 THEN Y4=0
60670 IF Y4>199 THEN Y4=199
60680 RETURN


1000 PRINT CHR$(147):INPUT "divide...";NU$
1010 INPUT "by...";DI$
1020 IF LEN(DI$)>LEN(NU$)THEN1000
1030 GOSUB 10000:GOSUB 20000
1050 GOTO 1000
10000 EN=2:SA=1:NU$=" "+NU$:NN$="":NR$="":PRINT CHR$(147);NU$;":";DI$;"="
10010 OF$="":OK=0:DI=VAL(DI$)
10020 PA$=OF$+MID$(NU$,SA+1,EN-SA)
10030 VA=VAL(PA$)
10040 IF NOT(VA>0 AND VA<DI AND EN+1<=LEN(NU$)) THEN 10100
10050 IF LEN(NN$)>0 THEN NN$=NN$+"0":PR$=NN$:GOSUB30000:GOSUB20000
10060 EN=EN+1
10070 GOTO 10020
10100 WN=INT(VA/DI):WS=WN*DI
10110 RE=VA-WS:VA$=STR$(VA):VA$=RIGHT$(VA$,LEN(VA$)-1)
10112 PRINTSPC(EN-LEN(VA$));VA$:SP=EN-LEN(VA$)-1:IFSP<0THENSP=0
10115 WS$=STR$(WS):PRINTSPC(SP);LEFT$("--------------------",LEN(WS$)+1)
10116 GOSUB20000
10118 PRINTSPC(SP);"-";RIGHT$(WS$,LEN(WS$)-1)
10120 T$=STR$(WN):T$=RIGHT$(T$,LEN(T$)-1)
10130 NN$=NN$+T$:PR$=NN$:GOSUB30000:GOSUB20000
10140 T$=STR$(RE):T$=RIGHT$(T$,LEN(T$)-1)
10150 OF$=T$
10160 IF EN+1>LEN(NU$) THEN 10200
10170 SA=EN:EN=EN+1:GOTO 10020
10200 NR$=STR$(RE)
10210 PRINTSPC(EN-LEN(NR$));NR$
10220 PR$=NN$:IF LEN(NR$)>0 AND VAL(NR$)>0 THEN PR$=PR$+" r"+NR$
10230 GOSUB30000:RETURN
20000 REM
20010 GETA$:IFA$=""THEN20010
20020 RETURN
30000 PO=LEN(NU$)+LEN(DI$)+2:PO=PO*2
30010 FOR I=1TOLEN(PR$):AS=ASC(MID$(PR$,I,1))
30015 IF AS>58 THEN AS=AS-64
30020 VPOKE0,PO+I*2,AS
30030 NEXT:RETURN